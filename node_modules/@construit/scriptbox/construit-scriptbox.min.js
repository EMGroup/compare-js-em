!function t(e,s,i){function r(o,a){if(!s[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(n)return n(o,!0);var p=new Error("Cannot find module '"+o+"'");throw p.code="MODULE_NOT_FOUND",p}var c=s[o]={exports:{}};e[o][0].call(c.exports,function(t){var s=e[o][1][t];return r(s||t)},c,c.exports,t,e,s,i)}return s[o].exports}for(var n="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,s){"undefined"==typeof Construit&&(Construit={}),Construit.ScriptBox=t("./")},{"./":4}],2:[function(t,e,s){function i(t,e,s,i){this.options=i||{},this.translator=this.options.translator?this.options.translator:r,this.erroritems=[],this.outdiv=e,this.parent=t,this.gutter=document.createElement("div"),this.gutter.className="eden-gutter",this.parent.appendChild(this.gutter),this.rt=s,this.ast=null,this.selected=null;var n=this;this.gutter.addEventListener("click",function(t){if(console.log(t),"eden-gutter-item play"==t.target.className){var e=t.target.getAttribute("data-line");console.log("Play!",n.lines[e]),n.translator.eval(n.lines[e],n.rt,{})}}),this.lines={}}const r=t("@construit/translator");i.prototype.addError=function(t){var e=document.createElement("div"),s=this.outdiv.childNodes[t.line-1];s&&(e.style.top=s.offsetTop,e.className="eden-gutter-item error",e.title=t.messageText(),e.style.lineHeight=s.clientHeight+"px",e.innerHTML="&#xf06a;",this.gutter.appendChild(e),this.erroritems.push(e),this.selected=null)},i.prototype.clearErrors=function(){for(var t=0;t<this.erroritems.length;t++)this.erroritems[t].parentNode.removeChild(this.erroritems[t]);this.erroritems=[]},i.prototype.selectLine=function(t){var e=this.outdiv.childNodes[t-1];if(e&&(null!==this.selected&&(this.selected.parentNode.removeChild(this.selected),this.selected=null),this.ast.getStatementByLine(t-1))){var s=document.createElement("div");s.style.top=e.offsetTop,s.style.lineHeight=e.clientHeight+"px",s.className="eden-gutter-item play",s.setAttribute("data-line",t-1),this.gutter.appendChild(s),this.selected=s}},i.prototype.addStatement=function(t,e){console.log("Line",t,e),this.lines[t]=e},i.prototype.update=function(t){if(this.ast=t,this.lines={},this.clearErrors(),t.hasErrors())null!==this.selected&&(this.selected.parentNode.removeChild(this.selected),this.selected=null),this.addError(t.errors[0]);else for(var e=0,s=0;s<this.ast.statements.length;s++)"dummy"!=this.ast.statements[s].type&&this.addStatement(e,this.ast.statements[s]),e+=this.ast.statements[s].getNumberOfLines()},e.exports=i},{"@construit/translator":100}],3:[function(t,e,s){e.exports=function(t){function e(t){var e=t.key;return t.shiftKey&&(e="Shift-"+e),t.altKey&&(e="Alt-"+e),(t.ctrlKey||t.metaKey)&&(e="Ctrl-"+e),e}t.intextarea.addEventListener("input",function(e){t.dirty=!0,t.rebuild()}),t.intextarea.addEventListener("keydown",function(s){switch(e(s)){case"Tab":s.preventDefault(),t.insertTab();break;case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":case"Home":case"End":t.moveCaret();break;case"Ctrl-a":t.selectAll(),s.preventDefault();break;case"Ctrl-h":t.toggleHighlighting(),s.preventDefault();break;case"Ctrl-Shift-ArrowLeft":case"Ctrl-Shift-ArrowRight":case"Ctrl-Shift-ArrowUp":case"Ctrl-Shift-ArrowDown":case"Ctrl-Shift-Home":case"Ctrl-Shift-End":case"Shift-ArrowLeft":case"Shift-ArrowRight":case"Shift-ArrowUp":case"Shift-ArrowDown":case"Shift-Home":case"Shift-End":t.focusOutput();break;case"Backspace":t.refreshentire=10==t.intextarea.value.charCodeAt(t.intextarea.selectionStart-1);break;case"Enter":t.refreshentire=!0;break;case"Ctrl-Control":t.enableGotoMode()}}),t.intextarea.addEventListener("keyup",function(s){var i=e(s);switch(s.ctrlKey||t.disableGotoMode(),i){case"Ctrl-Control":t.disableGotoMode();break;case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":case"Home":case"End":t.updateLineCachedHighlight(),t.gutter&&t.gutter.selectLine(t.currentlineno),t.checkScroll()}}),t.intextarea.addEventListener("paste",function(e){t.refreshentire=!0}),t.outdiv.addEventListener("keydown",function(e){"INPUT"!=e.target.nodeName&&"textarea"!=e.target.nodeName&&(!e.shiftKey||37!=e.keyCode&&38!=e.keyCode&&39!=e.keyCode&&40!=e.keyCode&&35!=e.keyCode&&36!=e.keyCode)&&"Control"!=e.key&&"Shift"!=e.key&&"c"!=e.key&&t.focusText()}),t.outdiv.addEventListener("keyup",function(e){"INPUT"!=e.target.nodeName&&"textarea"!=e.target.nodeName&&(17!=e.keyCode&&91!=e.keyCode&&92!=e.keyCode||t.disableGotoMode())}),t.outdiv.addEventListener("paste",function(e){t.intextarea.focus(),setTimeout(function(){t.updateEntireHighlight()},0)}),t.intextarea.addEventListener("blur",function(e){var s=t.outdiv.getElementsByClassName("fake-caret");s&&s.length>0&&(console.log("Blur carets",s),s[0].parentNode.removeChild(s[0]))}),t.intextarea.addEventListener("focus",function(t){})}},{}],4:[function(t,e,s){e.exports=t("./scriptbox.js")},{"./scriptbox.js":6}],5:[function(t,e,s){function i(t){t.outdiv.addEventListener("mouseup",function(e){if("INPUT"!=e.target.nodeName&&"textarea"!=e.target.nodeName)if(t.hideInfoBox(),t.readonly||0==e.target.isContentEditable)t.readonly&&console.log("Is readonly");else if(t.gotomode){var s=e.target;if(""==s.className&&"SPAN"==s.parentNode.nodeName&&(s=s.parentNode),"eden-selector"==s.className||"eden-selector2"==s.className){t.disableGotoMode();var r=s.parentNode.textContent;Eden.Selectors.goto(r)}else if("eden-observable"==s.className){var n=s.getAttribute("data-observable");Eden.Selectors.goto(n+":active")}e.preventDefault()}else if(document.activeElement===t.outdiv){var o=i.getCaretCharacterOffsetWithin(t.outdiv);if(i.getStartCaretCharacterOffsetWithin(t.outdiv)!=o)t.refreshentire=!0;else{t.intextarea.focus(),t.intextarea.selectionEnd=o,t.intextarea.selectionStart=o,t.updateLineCachedHighlight();var a=t.currentlineno;t.gutter.selectLine(a)}}}),t.outdiv.addEventListener("mousedown",function(e){t.readonly})}i.getCaretCharacterOffsetWithin=function(t){var e,s=0,i=t.ownerDocument||t.document,r=i.defaultView||i.parentWindow;if(void 0!==r.getSelection){if((e=r.getSelection()).rangeCount>0){var n=r.getSelection().getRangeAt(0),o=n.cloneRange();o.selectNodeContents(t),o.setEnd(n.endContainer,n.endOffset),s=o.toString().length}}else if((e=i.selection)&&"Control"!=e.type){var a=e.createRange(),h=i.body.createTextRange();h.moveToElementText(t),h.setEndPoint("EndToEnd",a),s=h.text.length}return s},i.getStartCaretCharacterOffsetWithin=function(t){var e,s=0,i=t.ownerDocument||t.document,r=i.defaultView||i.parentWindow;if(void 0!==r.getSelection){if((e=r.getSelection()).rangeCount>0){var n=r.getSelection().getRangeAt(0),o=n.cloneRange();o.selectNodeContents(t),o.setEnd(n.startContainer,n.startOffset),s=o.toString().length}}else if((e=i.selection)&&"Control"!=e.type){var a=e.createRange(),h=i.body.createTextRange();h.moveToElementText(t),h.setEndPoint("EndToEnd",a),s=h.text.length}return s},e.exports=i},{}],6:[function(t,e,s){function i(t,e,s){var i=t.split(" "),r=i.indexOf(e);if(-1==r){if(s)return i.push(e),i.join(" ")}else if(!s)return i.splice(r,1),i.join(" ");return t}function r(t,e,s){if(t){var r=i(t.className,e,s);r!=t.className&&(t.className=r)}}function n(t,e,s){this.rt=e,this.contents=t||document.createElement("div"),this.options=s||{},this.parser=this.options.parser?this.options.parser:h,this.highlight=this.options.highlight?this.options.highlight:a,this.intextarea=document.createElement("textarea"),this.intextarea.autofocus=!0,this.intextarea.tabIndex=1,this.intextarea.className="hidden-textarea2",this.intextarea.value=t.textContent,t.textContent="",this.contents.appendChild(this.intextarea),this.codearea=document.createElement("div"),this.codearea.className="inputCodeArea",this.contents.appendChild(this.codearea),this.outdiv=document.createElement("div"),this.outdiv.contentEditable=!0,this.outdiv.className="outputcontent",this.outdiv.spellcheck=!1,this.outdiv.tabIndex=2,this.codearea.appendChild(this.outdiv),this.fragment=void 0,this.readonly=!1,this.alwaysreadonly=!1,this.currentlineno=-1,this.currentcharno=-1,this.gotomode=!1,this.highlighter=new this.highlight(this.outdiv),this.gutter=new o(this.codearea,this.outdiv,e,s),this.cachedhlopt=void 0,this.disablehl=!1,this.ast=this.parser.parse(this.intextarea.value),this.gutter.update(this.ast),this.highlighter.setScrollTop(0);new p(this),new c(this);this.rebuildinterval=400,this.highlightContent()}const o=t("./gutter.js"),a=t("@construit/highlighter").Highlighter,h=t("@construit/parser"),p=t("./keyboard.js"),c=t("./mouse.js"),l=c.getCaretCharacterOffsetWithin,u=c.getStartCaretCharacterOffsetWithin;n.prototype.setReadonly=function(t){this.alwaysreadonly=t,!0===t?(this.readonly=!0,this.outdiv.contentEditable=!1):(this.readonly=!!this.fragment&&this.fragment.locked,this.outdiv.contentEditable=!this.readonly,"comment"==t&&this.updateEntireHighlight())},n.prototype.setFragment=function(t){if(this.fragment&&this.fragment!==t&&(this.fragment.unlock(),this.currentlineno=-1),this.fragment=t,void 0===t)return this.gutter.clear(),r(this.outdiv,"browser",!0),this.outdiv.contentEditable=!1,void(this.readonly=!0);var e=this;t.reset(function(){r(e.outdiv,"browser",!1),e.intextarea.value=t.getSource(),t.ast&&(e.highlightContent(-1,0),e.intextarea.focus(),e.checkScroll(),e.gutter.setBaseAST(t.ast.script)),t.locked?(e.readonly=!0,e.outdiv.contentEditable=!1):(e.readonly=!0===e.alwaysreadonly,e.outdiv.contentEditable=!e.readonly)})},n.prototype.refresh=function(){this.intextarea.value=this.fragment.getSource(),this.fragment.ast&&this.highlightContent(-1,0)},n.prototype.updateSource=function(t,e){this.ast=this.parser.parse(t),this.gutter.update(this.ast)},n.prototype.updateLineHighlight=function(){var t=-1,e=-1;document.activeElement===this.intextarea&&(e=this.intextarea.selectionEnd,t=this.getLineNumber(this.intextarea)),this.updateSource(this.intextarea.value,t),this.runScript(t),this.highlightContent(t,e)},n.prototype.runScript=function(t){},n.prototype.hideInfoBox=function(){},n.prototype.updateLineCachedHighlight=function(){var t=-1,e=-1;document.activeElement===this.intextarea&&(e=this.intextarea.selectionEnd,t=this.getLineNumber(this.intextarea)),this.highlightContent(t,e)},n.prototype.updateEntireHighlight=function(t,e){this.cachedhlopt=e,this.updateSource(this.intextarea.value,-1);var s=-1;document.activeElement===this.intextarea&&(s=this.intextarea.selectionEnd),t&&runScript(0),this.highlightContent(-1,s,e)},n.prototype.updateCachedHighlight=function(t){var e=-1;document.activeElement===this.intextarea&&(e=this.intextarea.selectionEnd),this.highlightContent(-1,e,t||this.cachedhlopt)},n.prototype.findElementLineNumber=function(t){for(var e=t;e.parentNode!==this.outdiv;)e=e.parentNode;return parseInt(e.getAttribute("data-line"))},n.prototype.replaceLine=function(t,e){var s=this.intextarea.value.split("\n");s[t]=e,this.intextarea.value=s.join("\n")},n.prototype.focusOutput=function(){this.setCaretToFakeCaret(),this.outdiv.focus()},n.prototype.focusText=function(){if(!this.readonly){var t=l(this.outdiv),e=u(this.outdiv);this.intextarea.focus(),this.intextarea.selectionEnd=t,this.intextarea.selectionStart=e,e!=t&&(this.refreshentire=!0)}},n.prototype.toggleHighlighting=function(){this.disablehl=!this.disablehl,this.updateEntireHighlight(),this.gutter.clear()},n.prototype.highlightContent=function(t,e,s){if(console.log("HL Pos:",e),void 0===s&&this.disablehl&&(s={}),this.disablehl&&(s.disabled=!0),new a(this.outdiv,this.intextarea.value,this.options).highlight(-1,e),document.activeElement!==this.intextarea){var i=this.outdiv.getElementsByClassName("fake-caret");i&&i.length>0&&(i[0].className="fake-caret fake-blur-caret")}if("comment"==this.alwaysreadonly)for(var r=[],n=0;n<r.length;n++)r[n].contentEditable=!1;this.delayRebuild()},n.prototype.moveCaret=function(){this.updateLineCachedHighlight(),this.checkScroll()},n.prototype.selectAll=function(){this.outdiv.focus();var t=document.createRange();t.selectNodeContents(this.outdiv);var e=window.getSelection();e.removeAllRanges(),e.addRange(t)},n.prototype.makeNumbersDrag=function(){var t=this;this.readonly||$(this.outdiv).find(".eden-number").draggable({helper:function(t){return $("<div class='eden-drag-helper'></div>")},axis:"x",distance:5,drag:function(e,s){if(!t.readonly){var i;if((i=t.dragint?Math.round(t.dragvalue+(s.position.left-t.dragstart)/2):(i=t.dragvalue+.005*(s.position.left-t.dragstart)).toFixed(4))!=t.draglast){t.draglast=i,e.target.innerHTML=""+i;var r=e.target.parentNode.textContent;"\n"==r.charAt(r.length-1)&&(r=r.slice(0,-1)),t.replaceLine(t.dragline,r),t.updateSource(t.intextarea.value,t.dragline),t.runScript(t.dragline+1),t.highlightContent(t.dragline,-1)}}},start:function(e,s){if(!t.readonly){t.edited=!0,t.dragline=t.findElementLineNumber(e.target),t.dragstart=s.position.left;var i=e.target.textContent;-1==i.indexOf(".")?(t.dragvalue=parseInt(i),t.dragint=!0):(t.dragvalue=parseFloat(i),t.dragint=!1),t.draglast=t.dragvalue,$(e.target).addClass("eden-select"),$(t.outdiv).css("cursor","ew-resize")}},stop:function(e,s){t.readonly||($(e.target).removeClass("eden-select"),$(t.outdiv).css("cursor","text"),t.dragline=-1)},cursor:"move",cursorAt:{top:-5,left:-5}}).click(function(){$(this).draggable({disabled:!0})}).blur(function(){$(this).draggable({disabled:!1})})},n.prototype.getLineNumber=function(){var t=this.intextarea.value.substr(0,this.intextarea.selectionStart).split("\n");return this.currentlineno=t.length,this.currentcharno=t[t.length-1].length,this.currentlineno},n.prototype.gotoLine=function(t){var e=this.intextarea.value.split("\n");e.length=t+1;var s=e.join("\n").length;this.intextarea.focus(),this.intextarea.selectionEnd=s,this.intextarea.selectionStart=s,this.updateLineCachedHighlight()},n.prototype.checkScroll=function(){return},n.prototype.setCaretToFakeCaret=function(){var t=this.outdiv.getElementsByClassName("fake-caret"),e=t?t[0]:null;if(e){var s=document.createRange(),i=window.getSelection();e.nextSibling&&(e=e.nextSibling),s.setStart(e,0),s.collapse(!0),i.removeAllRanges(),i.addRange(s),e.parentNode.removeChild(e)}},n.prototype.makeDiff=function(){var t={},e=this.fragment.diff();for(var s in e.remove)if(!e.remove[s].consecutive){var i=parseInt(s),r=0,n=20;do{n+=20,r++}while(e.remove[i+r]&&e.remove[i+r].consecutive);t[e.remove[s].nline+0]=n}this.gutter.setDiffs(e),this.cachedhlopt={spacing:t},this.updateCachedHighlight()},n.prototype.doRebuild=function(){},n.prototype.delayRebuild=function(){var t=this;clearTimeout(this.rebuildtimer),this.rebuildtimer=setTimeout(function(){t.doRebuild()},this.rebuildinterval)},n.prototype.rebuild=function(){this.gutter.edits?(this.updateSource(this.intextarea.value,-1),this.gutter.ast=this.ast,this.makeDiff()):(this.edited=!0,this.refreshentire?(this.updateEntireHighlight(),this.refreshentire=!1):this.updateLineHighlight(),this.checkScroll(),this.dirty=!1)},n.prototype.enableGotoMode=function(){this.gotomode||(this.outdiv.contentEditable=!1,r(this.outdiv,"goto",!0),this.gotomode=!0)},n.prototype.disableGotoMode=function(){this.gotomode&&(this.outdiv.contentEditable=!0,r(this.outdiv,"goto",!1),this.gotomode=!1)},n.prototype.insertTab=function(){var t=this.intextarea.selectionStart,e=this.intextarea.selectionEnd;this.intextarea.value=this.intextarea.value.substring(0,t)+"\t"+this.intextarea.value.substring(e),this.intextarea.selectionStart=this.intextarea.selectionEnd=t+1,this.rebuild()},e.exports=n},{"./gutter.js":2,"./keyboard.js":3,"./mouse.js":5,"@construit/highlighter":54,"@construit/parser":70}],7:[function(t,e,s){function i(t,e,s){r.call(this),this.errors=s?s.errors:[],s&&s.warning&&(this.warning=s.warning),this.expression=s,this.lvalue=void 0,this.compiled=void 0,this.dirty=!1,this.value=void 0,this.compiled=void 0,this.source=t,e&&this.setLValue(e)}const r=t("./basecontext.js");r.extend(i),i.prototype.left=function(t){this.lvalue=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setLValue=i.prototype.left,i.prototype.setExpression=function(t){this.expression=t,t.warning&&(this.warning=t.warning),t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.validate=function(){return!this.hasErrors()&&this.lvalue&&this.lvalue.validate()&&this.expression&&this.expression.isExpression()&&this.expression.validate()},e.exports=i},{"./basecontext.js":8}],8:[function(t,e,s){function i(){r.call(this),this.scopes=[],this.backtickCount=0,this.locals=void 0,this.params=void 0,this.dependencies={}}const r=t("./basescript.js");r.extend(i),i.extend=function(t){t.prototype=Object.create(i.prototype),t.prototype.constructor=t},e.exports=i},{"./basescript.js":11}],9:[function(t,e,s){function i(){this.type=this.constructor.name.toLowerCase(),this.errors=[],this.warning=null}i.prototype.isExpression=function(){return!0},i.prototype.isStatement=function(){return!1},i.prototype.left=function(t){this.l=t,t.errors&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors),t&&t.warning&&(this.warning=t.warning)},i.prototype.setLeft=i.prototype.left,i.prototype.hasErrors=function(){return this.errors.length>0},i.prototype.error=function(t){this.errors.unshift(t),t.setStatement(this)},i.prototype.getError=function(){return this.errors.length>0?this.errors[0]:null},i.extend=function(t){t.prototype=Object.create(i.prototype),t.prototype.constructor=t},e.exports=i},{}],10:[function(t,e,s){function i(){this.type=this.constructor.name.toLowerCase(),this.errors=[],this.warning=null}i.prototype.isExpression=function(){return!1},i.prototype.isStatement=function(){return!1},i.prototype.hasErrors=function(){return this.errors.length>0},i.prototype.error=function(t){this.errors.unshift(t),t.setStatement(this)},i.extend=function(t){t.prototype=Object.create(i.prototype),t.prototype.constructor=t},e.exports=i},{}],11:[function(t,e,s){function i(){r.call(this),this.statements=[],this.parameters=void 0,this.locals=void 0,this.indexed=!1,this.name=null,this.active=!1,this.root=null,this.prefix="",this.postfix=""}const r=t("./basestatement.js"),n=t("./indexer.js");r.extend(i),i.extend=function(t){t.prototype=Object.create(i.prototype),t.prototype.constructor=t},i.prototype.getSource=function(){return this.prefix+this.getInnerSource()+this.postfix},i.prototype.getInnerSource=function(){for(var t="",e=0;e<this.statements.length;e++)t+=this.statements[e].getSource();return t},i.prototype.patchInner=function(t){for(var e=this;e.parent;)e=e.parent;for(var s={},i=0;i<this.statements.length;i++)void 0===s[(r=this.statements[i]).id]&&(s[r.id]=[]),s[r.id].push(r);for(i=0;i<t.statements.length;i++){var r=t.statements[i];r.buildID(),s[r.id]&&s[r.id].length>0?(t.replaceChild(i,s[r.id][0]),s[r.id].shift(),0==s[r.id].length&&delete s[r.id]):"dummy"!=r.type&&this.indexed&&r.addIndex()}for(var n in s)for(var o=s[n],i=0;i<o.length;i++)"when"==o[i].type&&o[i].enabled&&eden.project.removeAgent(o[i]),this.indexed&&0==o[i].executed?o[i].removeIndex():o[i].destroy();if(void 0===this.parent)for(i=0;i<t.statements.length;i++)"script"==t.statements[i].type&&"ACTIVE"==t.statements[i].name?(t.statements[i]=eden.root,Eden.Index.remove(t.statements[i])):t.statements[i].parent=this;else for(i=0;i<t.statements.length;i++)t.statements[i].parent=this;this.statements=t.statements},i.prototype.patchOuter=function(t){},i.prototype.getLine=function(){return this.line},i.prototype.isRemote=function(){for(var t=this;t.parent;)t=t.parent;return t.base.origin.remote},i.prototype.setLocals=function(t){this.locals=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.subscribeDynamic=function(t,e){return eden.root.lookup(e)},i.prototype.getParameterByNumber=function(t){if(this.parameters)return this.parameters[t-1]},i.prototype.setName=function(t,e){this.name=e,this.shortName=e},i.prototype.setSource=function(t,e,s){if(this.start=t,this.end=e,s){0==this.statements.length||(this.prefix=s.substring(0,this.statements[0].start-t),this.postfix=s.substring(this.statements[this.statements.length-1].end-t)),this.numlines=0;for(i=0;i<this.prefix.length;i++)"\n"==this.prefix.charAt(i)&&this.numlines++;for(var i=0;i<this.postfix.length;i++)"\n"==this.postfix.charAt(i)&&this.numlines++}},i.prototype.appendChild=function(t){this.statements.push(t),this.statements.length>1&&(t.previousSibling=this.statements[this.statements.length-2],this.statements[this.statements.length-2].nextSibling=t),t.parent=this,this.indexed&&0!=this.id&&console.log("INVALIDATE ID",this),"dummy"!=t.type&&this.indexed&&t.addIndex(),t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.append=i.appendChild,i.prototype.insertAfter=function(t,e){var s;for(s=0;s<this.statements.length&&this.statements[s]!==t;s++);if(s+1<this.statements.length)e.previousSibling=this.statements[s],e.nextSibling=this.statements[s+1],this.statements[s].nextSibling=e,this.statements[s+1].previousSibling=e,this.statements.splice(s+1,0,e);else{if(!(s<this.statements.length))return;e.previousSibling=this.statements[s],e.nextSibling=void 0,this.statements[s].nextSibling=e,this.statements.push(e)}e.parent=this,"dummy"!=e.type&&this.indexed&&e.addIndex(),e.errors.length>0&&this.errors.push.apply(this.errors,e.errors),this.indexed&&0!=this.id&&console.log("INVALIDATE ID",this)},i.prototype.insertBefore=function(t,e){var s;for(s=0;s<this.statements.length&&this.statements[s]!==t;s++);s<this.statements.length?(this.statements.splice(s,0,e),e.parent=this,"dummy"!=e.type&&this.indexed&&e.addIndex(),e.errors.length>0&&this.errors.push.apply(this.errors,e.errors),this.indexed&&0!=this.id&&console.log("INVALIDATE ID",this)):eden.emit("error",[new Eden.RuntimeError(void 0,Eden.RuntimeError.NOCHILD,this,"Statement is not a child when using insertBefore")])},i.prototype.removeChild=function(t){var e;for(e=0;e<this.statements.length&&this.statements[e]!==t;e++);e<this.statements.length?(this.statements.splice(e,1),t.nextSibling&&(t.nextSibling.previousSibling=t.previousSibling),t.previousSibling&&(t.previousSibling.nextSibling=t.nextSibling),t.destroy(),this.indexed&&0!=this.id&&console.log("INVALIDATE ID",this)):eden.emit("error",[new Eden.RuntimeError(void 0,Eden.RuntimeError.NOCHILD,this,"Statement is not a child when using removeChild")])},i.prototype.replaceChild=function(t,e){var s;if("number"==typeof t)s=t;else{var i;for(i=0;i<this.statements.length&&this.statements[i]!==t;i++);if(i>=this.statements.length)return void eden.emit("error",[new Eden.RuntimeError(void 0,Eden.RuntimeError.NOCHILD,this,"Statement is not a child when using replaceChild")]);s=i}e.nextSibling=this.statements[s].nextSibling,e.nextSibling&&(e.nextSibling.previousSibling=e),e.previousSibling=this.statements[s].previousSibling,e.previousSibling&&(e.previousSibling.nextSibling=e),this.statements[s].destroy(),this.statements[s]=e,e.parent=this,"dummy"!=e.type&&this.indexed&&e.addIndex(),this.indexed&&0!=this.id&&console.log("INVALIDATE ID",this)},i.prototype.destroy=function(){this.executed<1&&Eden.Index.remove(this);for(var t=0;t<this.statements.length;t++)this.statements[t].destroy();this.executed=-1,this.statements=void 0,this.base=void 0,this.parent=void 0,this.nextSibling=void 0,this.previousSibling=void 0},i.prototype.addIndex=function(){if(!this.indexed){0==this.id&&this.buildID();for(var t=0;t<this.statements.length;t++)"dummy"!=this.statements[t].type&&this.statements[t].addIndex();this.indexed=!0,n.update(this)}},i.prototype.removeIndex=function(){if(this.indexed){for(var t=0;t<this.statements.length;t++)"dummy"!=this.statements[t].type&&this.statements[t].removeIndex();this.indexed=!1,n.remove(this)}},i.prototype.buildID=function(){for(var t=0,e=this.getSource(),s=e.length,i=0;i<s;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;this.id=this.type+"@"+t},i.prototype.getStatementByLine=function(t,e){var s=0;if(e&&this.parent&&(s=this.parent.getRelativeLine(this,e)),!(s>t)&&void 0!==this.statements)for(var i=0;i<this.statements.length;i++){var r=this.statements[i].getNumberOfLines();if(t>=s&&t<=s+r&&"dummy"!=this.statements[i].type)return this.statements[i];s+=r}},i.prototype.getRelativeLine=function(t,e){var s=0;e&&e!==this&&this.parent&&(s=this.parent.getRelativeLine(this,e));for(var i=0;i<this.statements.length;i++){if(this.statements[i]===t)return s;s+=this.statements[i].getNumberOfLines()}return-1},i.prototype.getNumberOfLines=function(){void 0===this.statements&&console.error("No Statements",this);for(var t=this.numlines,e=0;e<this.statements.length;e++)t+=this.statements[e].getNumberOfLines();return t},e.exports=i},{"./basestatement.js":12,"./indexer.js":31}],12:[function(t,e,s){"use strict";function i(){this.type=this.constructor.name.toLowerCase(),this.start=0,this.end=0,this.parent=null,this.errors=[],this.warning=null,this.executed=0,this.numlines=-1,this.doxyComment=null,this.lock=0,this.source=null,this.id=0,this.stamp=0,this.nextSibling=null,this.previousSibling=null,this.tags=null}const r=t("./indexer.js");i.prototype.setDoxyComment=function(t){this.doxyComment=t,t&&(null===this.tags?this.tags=t.getHashTags():this.tags=this.tags.concat(t.getHashTags()),t.hasTag("#library")&&("function"==this.type||"action"==this.type?r.addLibrarySymbol(this.name):"definition"==this.type&&r.addLibrarySymbol(this.lvalue.name)))},i.prototype.buildID=function(){var t=0,e=this.source;this.doxyComment&&(e=this.doxyComment.content+e);for(var s=e.length,i=0;i<s;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;this.name&&"do"!=this.type?this.id=this.name+"@"+t:this.lvalue?this.id=this.lvalue.name+"@"+t:this.id=this.type+"@"+t},i.prototype.addIndex=function(){if("dummy"==this.type&&console.trace("ADDING DUMMY INDEX"),this.buildID(),this.statements)for(var t=0;t<this.statements.length;t++)"dummy"!=this.statements[t].type&&this.statements[t].addIndex();r.update(this)},i.prototype.removeIndex=function(){if(this.statements)for(var t=0;t<this.statements.length;t++)"dummy"!=this.statements[t].type&&this.statements[t].removeIndex();r.remove(this)},i.prototype.destroy=function(){if(this.executed<1&&r.remove(this),this.parent=void 0,this.nextSibling=void 0,this.previousSibling=void 0,this.statements)for(var t=0;t<this.statements.length;t++)"dummy"!=this.statements[t].type&&this.statements[t].destroy();this.executed=-1},i.prototype.hasErrors=function(){return this.errors.length>0},i.prototype.error=function(t){this.errors.unshift(t),t.setStatement(this)},i.prototype.getError=function(){return this.errors.length>0?this.errors[0]:null},i.prototype.getNumberOfLines=function(){return this.numlines},i.prototype.getStartLine=function(t){return this.parent?this.parent.getRelativeLine(this,t):-1},i.prototype.getEndLine=function(t){return this.getStartLine(t)+this.getNumberOfLines()},i.prototype.getRange=function(t){var e=this.getStartLine(t);return[e,e+this.getNumberOfLines()]},i.prototype.setSource=function(t,e,s){this.start=t,this.end=e,this.source=s},i.prototype.getSource=function(){return this.source},i.prototype.getOuterSource=function(){var t=this.getSource();void 0===this.parent&&(t="action "+this.name+"{"+t+"}"),this.doxyComment&&(t="/** "+this.doxyComment.content+" */\n"+t);for(var e=this.parent;e;)"script"==e.type?(t=e.name?"action "+e.name+" {\n"+t+"\n}":"{\n"+t+"\n}",e.doxyComment&&(t="/** "+e.doxyComment.content+" */\n"+t),e=e.parent):e=void 0;return t},i.prototype.getOrigin=function(){for(var t=this;t.parent;)t=t.parent;return t.base?t.base.origin:void 0},i.prototype.isExpression=function(){return!1},i.prototype.isStatement=function(){return!0},i.extend=function(t){t.prototype=Object.create(i.prototype),t.prototype.constructor=t},e.exports=i},{"./indexer.js":31}],13:[function(t,e,s){"use strict";function i(t,e,s){r.call(this),this.op=t,this.l=null,this.r=null,e&&this.setLeft(e),s&&this.setRight(s),"&"==this.op||"and"==this.op?this.op="&&":"|"!=this.op&&"or"!=this.op||(this.op="||")}const r=t("./baseexpression.js");r.extend(i),i.operators={"+":!0,"-":!0,"/":!0,"*":!0,"&&":!0,"||":!0,"==":!0,"!=":!0,">=":!0,"<=":!0,">":!0,"<":!0,"//":!0,"%":!0,"^":!0},i.prototype.setOp=function(t){this.op=t,"&"==this.op||"and"==this.op?this.op="&&":"|"!=this.op&&"or"!=this.op||(this.op="||")},i.prototype.setRight=function(t){this.r=t,this.errors.push.apply(this.errors,t.errors),this.warning=t.warning},i.prototype.validate=function(){var t=!!(this.l&&this.l.isExpression&&this.l.isExpression()&&this.l.validate()),e=!!(this.r&&this.r.isExpression&&this.r.isExpression()&&this.r.validate()),s=i.operators.hasOwnProperty(this.op);return t&&e&&s},i.prototype.staticType=function(){switch(this.op){case"-":case"/":case"*":case"%":case"^":return"number";case"&&":case"||":case">":case"<":case"<=":case">=":case"==":case"!=":return"boolean"}var t=this.l.staticType(),e=this.r.staticType();return"unknown"==t?"unknown"==e?"unknown":e:t},i.prototype.dependencies=function(t){return t||(t={}),this.l.dependencies(t),this.r.dependencies(t),t},i.prototype.isConstant=function(){return this.l.isConstant()&&this.r.isConstant()},e.exports=i},{"./baseexpression.js":9}],14:[function(t,e,s){function i(){r.call(this)}const r=t("./basescript.js");r.extend(i),e.exports=i},{"./basescript.js":11}],15:[function(t,e,s){"use strict";function i(){r.call(this)}const r=t("./basestatement.js");r.extend(i),i.prototype.validate=function(){return!0},e.exports=i},{"./basestatement.js":12}],16:[function(t,e,s){function i(){r.call(this),this.datatype="unknown",this.literal=null}const r=t("./basestatement.js");r.extend(i),i.prototype.setLiteral=function(t,e){this.datatype=t,this.literal=e},i.prototype.validate=function(){return this.literal&&this.literal.validate()},e.exports=i},{"./basestatement.js":12}],17:[function(t,e,s){function i(){r.call(this)}const r=t("./basestatement.js");r.extend(i),i.prototype.validate=function(){return!0},e.exports=i},{"./basestatement.js":12}],18:[function(t,e,s){function i(){r.call(this),this.list=[],this.kind="local"}const r=t("./basestatement.js");r.extend(i),i.prototype.validate=function(){for(var t=0;t<this.list.length;t++)if(!this.list[t].validate())return!1;return!0},e.exports=i},{"./basestatement.js":12}],19:[function(t,e,s){function i(){r.call(this)}const r=t("./basestatement.js");r.extend(i),i.prototype.validate=function(){return!0},e.exports=i},{"./basestatement.js":12}],20:[function(t,e,s){function i(){r.call(this),this.expression=null,this.lvalue=null}const r=t("./basecontext.js");r.extend(i),i.prototype.getParameterByNumber=function(t){if(this.parent&&this.parent.getParameterByNumber)return this.parent.getParameterByNumber(t)},i.prototype.setExpression=function(t){this.warning=t.warning,this.expression=t,this.errors=t.errors},i.prototype.left=function(t){this.lvalue=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setLValue=i.prototype.left,i.prototype.validate=function(){return this.lvalue&&this.lvalue.validate()&&this.expression&&this.expression.isExpression()&&this.expression.validate()},e.exports=i},{"./basecontext.js":8}],21:[function(t,e,s){function i(){r.call(this),this.observable=null}const r=t("./basestatement.js");r.extend(i),i.prototype.setObservable=function(t){this.observable=t},e.exports=i},{"./basestatement.js":12}],22:[function(t,e,s){function i(){r.call(this),this.condition=null,this.statement=null}const r=t("./basestatement.js");r.extend(i),i.prototype.setCondition=function(t){this.condition=t,this.errors.push.apply(this.errors,t.errors)},i.prototype.setStatement=function(t){this.statement=t,t&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":12}],23:[function(t,e,s){function i(t,e,s){r.call(this),this.content=t,this.startline=e,this.endline=s,this.tags=void 0,this.controls=void 0,this.parent=void 0}const r=t("./basenode.js");r.extend(i),i.prototype.getHashTags=function(){return this.tags?Object.keys(this.tags):(this.stripped(),this.tags?Object.keys(this.tags):(this.tags={},[]))},i.prototype.hasTag=function(t){return void 0===this.tags&&this.getHashTags(),!!this.tags[t]},i.prototype.getControls=function(){return this.controls?this.controls:(this.stripped(),this.controls)},i.prototype.getProperty=function(t){var e=this.getControls();return e?e["@"+t]:void 0},i.prototype.stripped=function(){if(void 0===this.content)return"";for(var t={},e={},s=this.content.split("\n"),i="",r=0;r<s.length;r++)if("#"==s[r].charAt(0)?(s[r]=s[r].slice(1)," "==s[r].charAt(0)&&(s[r]=s[r].slice(1))):"*"==s[r].trim().charAt(0)&&(s[r]=s[r].trim().slice(1)," "==s[r].charAt(0)&&(s[r]=s[r].slice(1))),""!=s[r]){var n=s[r].trim();if("@"!=n.charAt(0)){for(var o=s[r].split(/[ \t]+/),a=0;a<o.length;a++)""!=o[a]&&"@"!=o[a].charAt(0)?(i+=o[a]+" ","#"==o[a].charAt(0)&&(e[o[a]]=!0)):i+=" ";i+="\n"}else{var h=n.indexOf(" ");if(-1==h)t[n]=!0;else{var p=n.substring(0,h),c=n.substring(h+1,n.length);void 0===t[p]&&(t[p]=[]),t[p].push(c)}s[r]=""}}else i+="\n";return this.controls=t,this.tags=e,i.trim()},i.prototype.brief=function(){var t=this.stripped();if(t)return t.split(".")[0]},i.prototype.pretty=function(){var t=this.stripped(),e=this.controls["@param"],s=EdenUI.Markdown.html(t);if(e&&e.length>0){s+='<div class="doxy-parameters">Parameters:';for(var i=0;i<e.length;i++)s+='<div class="doxy-parameter"><div class="doxy-parameter-name">'+(t=e[i].split(/[ \t]+/))[0]+'</div><div class="doxy-parameter-details">'+t.slice(1).join(" ")+"</div></div>";s+="</div>"}return s},i.prototype.getParamString=function(){var t=this.getControls()["@param"];if(t&&t.length>0){for(var e="(",s=0;s<t.length;s++)e+=t[s].split(/[ \t]+/)[0],s<t.length-1&&(e+=", ");return e+=")"}return"()"},e.exports=i},{"./basenode.js":10}],24:[function(t,e,s){function i(){r.call(this),this.type="dummy"}const r=t("./basestatement.js");r.extend(i),e.exports=i},{"./basestatement.js":12}],25:[function(t,e,s){function i(){r.call(this),this.range=!1,this.overrides={},this.expression=null}const r=t("./baseexpression.js"),n=t("./primary.js");r.extend(i),i.prototype.prepend=function(t){this.primary.prepend(t)},i.prototype.setExpression=function(t){this.expression=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setObservable=function(t){this.expression=new n,this.expression.setObservable(t)},i.prototype.addOverride=function(t,e,s,i,r){this.errors.push.apply(this.errors,t.errors),"in"==r&&(this.range=!0),i?(this.range=!0,this.overrides[t.observable]={expr:e,endexpr:i,increment:s,components:t.components,kind:r},this.errors.push.apply(this.errors,e.errors),this.errors.push.apply(this.errors,s.errors),this.errors.push.apply(this.errors,i.errors)):s?(this.range=!0,this.overrides[t.observable]={expr:e,endexpr:s,components:t.components,kind:r},this.errors.push.apply(this.errors,e.errors),this.errors.push.apply(this.errors,s.errors)):e&&(this.overrides[t.observable]={expr:e,endexpr:void 0,components:t.components,kind:r},this.errors.push.apply(this.errors,e.errors))},e.exports=i},{"./baseexpression.js":9,"./primary.js":37}],26:[function(t,e,s){function i(){r.call(this),this.sstart=void 0,this.condition=void 0,this.inc=void 0,this.statement=void 0,this.compiled=void 0,this.started=!1,this.list=void 0,this.index=0,this.dirty=!1}const r=t("./basestatement.js");r.extend(i),i.prototype.setStart=function(t){this.sstart=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setCondition=function(t){this.condition=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setIncrement=function(t){this.inc=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setStatement=function(t){this.statement=t,t&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":12}],27:[function(t,e,s){"use strict";function i(){r.call(this)}const r=t("./basescript.js");r.extend(i),i.prototype.isExpression=function(){return!0},e.exports=i},{"./basescript.js":11}],28:[function(t,e,s){function i(){r.call(this),this.condition="",this.statement=void 0,this.elsestatement=void 0,this.statements=[]}const r=t("./basestatement.js");r.extend(i),i.prototype.setCondition=function(t){this.condition=t,this.errors.push.apply(this.errors,t.errors)},i.prototype.setStatement=function(t){this.statement=t,t&&(this.statements.push(t),t.parent=this,this.errors.push.apply(this.errors,t.errors))},i.prototype.setElse=function(t){this.elsestatement=t,t&&(this.statements.push(t),t.parent=this,this.errors.push.apply(this.errors,t.errors))},e.exports=i},{"./basestatement.js":12}],29:[function(t,e,s){function i(){r.call(this),this.expression=void 0}const r=t("./basenode.js");r.extend(i),i.prototype.setExpression=function(t){this.expression=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basenode.js":10}],30:[function(t,e,s){function i(){r.call(this),this.indexes=[],this.expression=null}const r=t("./baseexpression.js");r.extend(i),i.prototype.setExpression=function(t){this.expression=t,t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.addIndex=function(t){this.indexes.push(t),t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./baseexpression.js":9}],31:[function(t,e,s){"use strict";let i={},r={},n={},o={},a={};s.addLibrarySymbol=function(t){a[t]=!0},s.isLibrary=function(t){return a.hasOwnProperty(t)},s.idExists=function(t){return i.hasOwnProperty(t)},s.getByID=function(t){var e=i[t];return e||[]},s.getAll=function(){var t=[];return Object.values?t.concat.apply(t,Object.values(i)):t.concat.apply(t,Object.keys(i).map(function(t){return i[t]}))},s.getAllWithName=function(){var t=[];for(var e in r)t.push.apply(t,r[e].map(function(t){return i[t]}));return t},s.getByName=function(t){var e=[];return r[t]?e.concat.apply(e,r[t].map(function(t){return i[t]})):e},s.getByNameRegex=function(t){var e=[];for(var s in r)t.test(s)&&(e=e.concat.apply(e,r[s].map(function(t){return i[t]})));return e},s.getByType=function(t){var e=[];return o[t]?e.concat.apply(e,Object.keys(o[t]).map(function(t){return i[t]})):e},s.getByTag=function(t){var e=[];return n[t]?e.concat.apply(e,n[t].map(function(t){return i[t]})):e},s.getByTagRegex=function(t){var e=[];for(var s in n)t.test(s)&&(e=e.concat.apply(e,n[s].map(function(t){return i[t]})));return e},s.remove=function(t){var e=i[t.id];if(e){for(h=0;h<e.length;h++)e[h]===t&&e.splice(h,1);if(0==e.length){if(delete i[t.id],delete o[t.type][t.id],t.name&&"do"!=t.type||t.lvalue){var s=t.name?t.name:t.lvalue.name;if(void 0===r[s])return;(p=r[s].indexOf(t.id))>=0&&r[s].splice(p,1)}if(t.tags)for(var a=t.tags,h=0;h<a.length;h++)if(void 0!==n[a[h]]){var p=n[a[h]].indexOf(t.id);p>=0&&n[a[h]].splice(p,1)}}}},s.update=function(t){if(void 0===i[t.id]&&(i[t.id]=[]),i[t.id].push(t),1==i[t.id].length){if(void 0===o[t.type]&&(o[t.type]={}),o[t.type][t.id]=!0,t.name&&"do"!=t.type||t.lvalue){var e=t.name?t.name:t.lvalue.name;void 0===r[e]&&(r[e]=[]),-1==r[e].indexOf(t.id)&&r[e].push(t.id)}if(t.tags)for(var s=t.tags,a=0;a<s.length;a++)void 0===n[s[a]]&&(n[s[a]]=[]),-1==n[s[a]].indexOf(t.id)&&n[s[a]].push(t.id)}},s.reset=function(){i={},r={},n={},o={},a={}}},{}],32:[function(t,e,s){function i(){r.call(this),this.errors=[],this.l=void 0}const r=t("./baseexpression.js");r.extend(i),e.exports=i},{"./baseexpression.js":9}],33:[function(t,e,s){function i(t,e){r.call(this),this.datatype=t,this.value=e}const r=t("./baseexpression.js");r.extend(i),e.exports=i},{"./baseexpression.js":9}],34:[function(t,e,s){function i(){n.call(this),this.name=void 0,this.express=void 0,this.primary=void 0,this.lvaluep=void 0,this.islocal=!1}function r(t){this.type="lvaluecomponent",this.errors=[],this.kind=t,this.indexexp=void 0,this.observable=void 0}const n=t("./basenode.js");n.extend(i),i.prototype.setExtras=function(t){if(this.lvaluep=t,t)for(var e=0;e<t.length;e++)this.errors.push.apply(this.errors,t[e].errors)},i.prototype.setObservable=function(t){this.name=t},i.prototype.setPrimary=function(t){this.primary=t,t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setExpression=function(t){this.express=t,t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.hasListIndices=function(){return this.lvaluep&&this.lvaluep.length>0&&"index"==this.lvaluep[0].kind},r.prototype.index=function(t){this.indexexp=t,this.errors.push.apply(this.errors,t.errors)},r.prototype.property=function(t){this.observable=t},r.prototype.generate=function(t,e){if("index"==this.kind)return"[rt.index("+this.indexexp.generate(t,e,{bound:!1})+")]"},e.exports=i},{"./basenode.js":10}],35:[function(t,e,s){function i(t){var e="<b>"+t.constructor.name+"</b> {\n\t";t.hasErrors&&t.hasErrors()&&t.errors[0].statement===t&&(e+=t.errors[0].prettyHTML());for(var s in t)if(!r.hasOwnProperty(s)){var n=t[s];if(null===n)continue;if(void 0===n)continue;var o=typeof n;if("function"==o)continue;switch(o){case"object":if(Array.isArray(n)){if(0==n.length)continue;for(var a="[\n\t",h=0;h<n.length;h++)a+="\n\t\t"+i(n[h]).replace(/\n/g,"\n\t\t"),h<n.length-1&&(a+=",\n\t");n=a+"\n\t]"}else if("overrides"==s){a="{\n\t";for(var p in n)a+="\n\t\t"+p+": "+i(n[p]).replace(/\n/g,"\n\t\t"),h<n.length-1&&(a+=",\n\t");n=a+"\n\t}"}else n=(n=i(n)).replace(/\n/g,"\n\t")+"\n";break;case"string":n='<span style="color: red;">"'+n+'"</span>';break;case"number":n='<span style="color: blue;">'+n+"</span>"}e+=s+" = "+n+"\n\t"}return e.trim()+"\n}"}let r={type:!0,errors:!0,nextSibling:!0,previousSibling:!0,parent:!0,start:!0,end:!0,prefix:!0,postfix:!0,source:!0,root:!0,base:!0,warning:!0,numlines:!0,lock:!0,executed:!0,active:!0,indexed:!0,id:!0,backtickCount:!0};s.htmlify=i,s.Assignment=t("./assignment.js"),s.DoxyComment=t("./doxycomments.js"),s.BinaryOp=t("./binaryop.js"),s.Break=t("./break.js"),s.Block=t("./block.js"),s.Case=t("./case.js"),s.Continue=t("./continue.js"),s.Declarations=t("./declarations.js"),s.Default=t("./default.js"),s.Definition=t("./definition.js"),s.Delete=t("./delete.js"),s.Do=t("./do.js"),s.DummyStatement=t("./dummy.js"),s.For=t("./for.js"),s.Function=t("./function.js"),s.If=t("./if.js"),s.Use=t("./use.js"),s.Index=t("./index.js"),s.Indexer=t("./indexer.js"),s.Indexed=t("./indexed.js"),s.Length=t("./length.js"),s.Literal=t("./literal.js"),s.LValue=t("./lvalue.js"),s.Modify=t("./modify.js"),s.Primary=t("./primary.js"),s.Query=t("./querystat.js"),s.Range=t("./range.js"),s.Return=t("./return.js"),s.ExpressionScope=t("./exprscope.js"),s.ScopePattern=t("./scopepattern.js"),s.Section=t("./section.js"),s.Structure=t("./structure.js"),s.Switch=t("./switch.js"),s.TernaryOp=t("./ternaryop.js"),s.UnaryOp=t("./unaryop.js"),s.Wait=t("./wait.js"),s.When=t("./when.js"),s.While=t("./while.js")},{"./assignment.js":7,"./binaryop.js":13,"./block.js":14,"./break.js":15,"./case.js":16,"./continue.js":17,"./declarations.js":18,"./default.js":19,"./definition.js":20,"./delete.js":21,"./do.js":22,"./doxycomments.js":23,"./dummy.js":24,"./exprscope.js":25,"./for.js":26,"./function.js":27,"./if.js":28,"./index.js":29,"./indexed.js":30,"./indexer.js":31,"./length.js":32,"./literal.js":33,"./lvalue.js":34,"./modify.js":36,"./primary.js":37,"./querystat.js":38,"./range.js":39,"./return.js":40,"./scopepattern.js":41,"./section.js":42,"./structure.js":43,"./switch.js":44,"./ternaryop.js":45,"./unaryop.js":46,"./use.js":47,"./wait.js":48,"./when.js":49,"./while.js":50}],36:[function(t,e,s){function i(t,e){r.call(this),this.errors=e?e.errors:[],this.kind=t,this.expression=e,this.lvalue=void 0}const r=t("./basecontext.js");r.extend(i),i.prototype.left=function(t){this.lvalue=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basecontext.js":8}],37:[function(t,e,s){function i(){r.call(this),this.observable="",this.extras=[],this.backtick=void 0}const r=t("./baseexpression.js");r.extend(i),i.prototype.setBackticks=function(t){this.backtick=t,this.errors.push.apply(this.errors,t.errors)},i.prototype.setObservable=function(t){this.observable=t},i.prototype.getObservable=function(){return this.observable},i.prototype.prepend=function(t){this.extras.unshift(t),t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./baseexpression.js":9}],38:[function(t,e,s){function i(){r.call(this),this.selector=void 0,this.restypes=[],this.modexpr=void 0,this.kind="="}const r=t("./basestatement.js");r.extend(i),i.prototype.setSelector=function(t){this.selector=t,t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setResultTypes=function(t){this.restypes=t},i.prototype.setModify=function(t,e){this.modexpr=t,this.kind=e,t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":12}],39:[function(t,e,s){function i(t){this.type="range",this.parent=void 0,this.errors=t?t.errors:[],this.expression=t,this.lvalue=void 0,this.start=0,this.end=0}i.prototype.setSource=function(t,e){this.start=t,this.end=e},i.prototype.setSecond=function(t){this.second=t,t&&t.errors&&this.errors.push.apply(this.errors,t.errors)},i.prototype.left=function(t){this.lvalue=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{}],40:[function(t,e,s){function i(){r.call(this),this.expression=null}const r=t("./basestatement.js");r.extend(i),i.prototype.setExpression=function(t){this.expression=t,this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":12}],41:[function(t,e,s){function i(){this.type="scopepattern",this.observable="NONAME",this.components=[],this.errors=[]}i.prototype.setObservable=function(t){this.observable=t},i.prototype.addListIndex=function(t){this.components.push(t),t&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{}],42:[function(t,e,s){function i(){r.call(this),this.name=void 0,this.depth=1}const r=t("./basestatement.js");r.extend(i),i.prototype.setName=function(t){this.name=t;var e=t.match(/#[\w]+/g);null!==e&&(null===this.tags?this.tags=e:this.tags=this.tags.concat(e))},i.prototype.getRange=function(t){for(var e=this.getStartLine(t),s=this.nextSibling;s&&s.nextSibling&&("section"!=s.nextSibling.type||s.nextSibling.depth>this.depth);)s=s.nextSibling;return s&&"dummy"==s.type&&(s=s.previousSibling),[e,s?s.getEndLine(t):e+this.getNumberOfLines()]},e.exports=i},{"./basestatement.js":12}],43:[function(t,e,s){function i(){r.call(this),this.elements=null}const r=t("./baseexpression.js");r.extend(i),i.prototype.addElement=function(t,e){null===this.elements&&(this.elements={}),e.errors.length>0&&this.errors.push.apply(this.errors,e.errors),this.elements[t]=e},e.exports=i},{"./baseexpression.js":9}],44:[function(t,e,s){function i(){r.call(this),this.expression="",this.statement=void 0,this.compiled=void 0}const r=t("./basestatement.js");r.extend(i),i.prototype.setExpression=function(t){this.expression=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setStatement=function(t){this.statement=t,this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":12}],45:[function(t,e,s){function i(t){r.call(this),this.op=t,this.first=void 0,this.second=void 0,this.condition=void 0,this.warning=void 0}const r=t("./baseexpression.js");r.extend(i),i.prototype.setFirst=function(t){this.first=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors),t&&t.warning&&(this.warning=t.warning)},i.prototype.setSecond=function(t){this.second=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors),t&&t.warning&&(this.warning=t.warning)},i.prototype.setCondition=function(t){this.condition=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors),t&&t.warning&&(this.warning=t.warning)},i.prototype.left=function(t){void 0===this.condition?this.condition=t:this.first=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors),t&&t.warning&&(this.warning=t.warning)},e.exports=i},{"./baseexpression.js":9}],46:[function(t,e,s){function i(t,e){r.call(this),this.op=t,this.errors=e?e.errors:[],this.r=e}const r=t("./baseexpression.js");r.extend(i),e.exports=i},{"./baseexpression.js":9}],47:[function(t,e,s){function i(){r.call(this),this.selector=null}const r=t("./basestatement.js");r.extend(i),i.prototype.setSelector=function(t){this.selector=t,t.hasErrors()&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":12}],48:[function(t,e,s){function i(){r.call(this),this.delay=void 0,this.compiled_delay=void 0}const r=t("./basestatement.js");r.extend(i),i.prototype.setDelay=function(t){this.delay=t,t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":12}],49:[function(t,e,s){function i(){r.call(this),this.name="*When",this.id=0,this.expression=void 0,this.active=!1,this.compiled=void 0,this.scope=void 0,this.compScope=void 0,this.local=!1,this.dirty=!1,this.statement=void 0,this.enabled=!1,this.statements=[],this.retrigger=!1}const r=t("./basecontext.js");r.extend(i),i.prototype.getSource=function(){return this.statement?this.prefix+this.statement.getSource()+this.postfix:this.prefix+this.postfix},i.prototype.setSource=function(t,e,s){if(this.start=t,this.end=e,s){this.statement?(this.prefix=s.substring(0,this.statement.start-t),this.postfix=s.substring(this.statement.end-t)):(this.prefix=s.substring(0,e),this.postfix=""),this.numlines=0;for(i=0;i<this.prefix.length;i++)"\n"==this.prefix.charAt(i)&&this.numlines++;for(var i=0;i<this.postfix.length;i++)"\n"==this.postfix.charAt(i)&&this.numlines++}},i.prototype.getLine=function(){return this.line},i.prototype.doDebug=function(){return this.doxyComment&&this.doxyComment.getControls()["@debug"]},i.prototype.setScope=function(t){this.scope=t},i.prototype.subscribeDynamic=function(t,e,s){return console.log("Subscribe Dyn: ",e,s),eden.project.addTrigger(this,e,s),eden.root.lookup(e)},i.prototype.setExpression=function(t){this.expression=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setStatement=function(t){this.statement=t,t&&(this.statements.push(t),this.errors.push.apply(this.errors,t.errors))},e.exports=i},{"./basecontext.js":8}],50:[function(t,e,s){function i(){r.call(this),this.condition=void 0,this.statement=void 0,this.compiled=void 0}const r=t("./basestatement.js");r.extend(i),i.prototype.setCondition=function(t){this.condition=t,this.errors.push.apply(this.errors,t.errors)},i.prototype.setStatement=function(t){this.statement=t,t&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":12}],51:[function(t,e,s){s.functions={apply:!0,array:!0,canvasURL:!0,centroid:!0,char:!0,charCode:!0,choose:!0,compose:!0,concat:!0,curry:!0,decodeHTML:!0,definitionOf:!0,definitionRHS:!0,doDefault:!0,edenCode:!0,escapeRE:!0,foldl:!0,foldr:!0,hasProperty:!0,hslColour:!0,htmlBulletList:!0,htmlNumberedList:!0,positionInList:!0,positionOfRE:!0,substringPosition:!0,int:!0,isBoolean:!0,isCallable:!0,isChar:!0,isDefined:!0,isDependency:!0,isDependent:!0,isFunc:!0,isInt:!0,isList:!0,isNaN:!0,isNumber:!0,isObject:!0,isPoint:!0,isPointer:!0,isProc:!0,isString:!0,isValue:!0,distanceMoved:!0,angleTurned:!0,List:!0,listcat:!0,lookup:!0,lowercase:!0,map:!0,mapPartial:!0,max:!0,Menu:!0,MenuItem:!0,min:!0,mod:!0,nameof:!0,partApply:!0,Point:!0,pow:!0,properties:!0,randomBoolean:!0,randomFloat:!0,randomInteger:!0,RE:!0,replaceFirst:!0,reverse:!0,rgbColour:!0,rotatePoint:!0,round:!0,roundMultiple:!0,scalePoint:!0,search:!0,sequenceItoJ:!0,sequenceN:!0,sequenceArithmeticN:!0,sequenceList:!0,sequencePrevious:!0,sort:!0,str:!0,sqrt:!0,strcat:!0,sublist:!0,substitute:!0,substr:!0,sum:!0,tail:!0,trim:!0,type:!0,uppercase:!0,include_css:!0,html:!0,time:!0,execute:!0,Text:!0,textWidth:!0,textHeight:!0,Arc:!0,Curve:!0,FillPattern:!0,Ellipse:!0,Line:!0,LinearGradient:!0,LineSequence:!0,PixelList:!0,GreyPixelList:!0,Rectangle:!0,RotateAboutCentre:!0,RotateAboutPoint:!0,CombinedRotation:!0,Scale:!0,Translate:!0,RoundedRectangle:!0,Polygon:!0,RegularPolygon:!0,Sector:!0,Shadow:!0,Circle:!0,Button:!0,Checkbox:!0,Div:!0,Image:!0,imageWithZones:!0,HTMLImage:!0,RadioButtons:!0,Slider:!0,Textbox:!0,DropDownList:!0,Combobox:!0,BulletSlide:!0,Video:!0,Audio:!0,Slide:!0,TitledSlide:!0,TitleSlide:!0,cos:!0,sin:!0,tan:!0,abs:!0,acos:!0,asin:!0,atan:!0,ceil:!0,roundUp:!0,exp:!0,floor:!0,roundDown:!0,log:!0,random:!0,forget:!0,forgetAll:!0,shapeOnTopAt:!0,zoneOnTopAt:!0,observableOnTopAt:!0,shapeOnBottomAt:!0,zoneOnBottomAt:!0,observableOnBottomAt:!0,shapesAt:!0,zonesAt:!0,observablesAt:!0,observableForShape:!0,alias:!0,arrangeWindows:!0,attemptMouseCapture:!0,bindCSSNumericProperty:!0,bindCSSProperty:!0,bindCSSRule:!0,createCanvas:!0,createHTMLView:!0,createProjectList:!0,createView:!0,destroyView:!0,eager:!0,error:!0,hideView:!0,highlightView:!0,moveView:!0,patch:!0,removeedenclock:!0,resizeView:!0,setedenclock:!0,showObservables:!0,showView:!0,stopHighlightingView:!0,todo:!0,touch:!0,unbind:!0,withAppendedItem:!0,writeln:!0},s.specials={autocalc:!0,mouseX:!0,mouseY:!0,mousePosition:!0,screenHeight:!0,screenWidth:!0,PI:!0},s.values={true:!0,false:!0,green:!0},s.storage={local:"local",auto:"auto",var:"var",para:"para"}},{}],52:[function(t,e,s){const i=t("../js/highlighter.js");i.prototype.SECTION_TITLE=function(){"#"==this.token?(this.classes.push("hidden-comment"),this.applyClasses(this.lineelement,["comment-line","comment-h2"]),this.mode="COMMENT",32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)):"##"==this.token?(this.classes.push("hidden-comment"),this.mode="SECTION_TITLE3",32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)):(this.applyClasses(this.lineelement,["comment-line","comment-h1"]),this.mode="COMMENT",this.COMMENT())},i.prototype.SECTION_TITLE2=function(){"#"==this.token?(this.classes.push("hidden-comment"),this.mode="SECTION_TITLE3",32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)):(this.classes.push("comment-h2"),this.mode="SECTION_TITLE_H2")},i.prototype.SECTION_TITLE3=function(){"#"==this.token?(this.classes.push("hidden-comment"),this.applyClasses(this.lineelement,["comment-line","comment-h4"]),this.mode="COMMENT",32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)):(this.applyClasses(this.lineelement,["comment-line","comment-h3"]),this.mode="COMMENT",this.COMMENT())},i.prototype.SECTION_TITLE4=function(){this.classes.push("comment-h4"),this.mode="SECTION_TITLE_H4"},i.prototype.SECTION_TITLE_H1=function(){this.classes.push("comment-h1")},i.prototype.SECTION_TITLE_H2=function(){this.classes.push("comment-h2")},i.prototype.SECTION_TITLE_H3=function(){this.classes.push("comment-h3")},i.prototype.SECTION_TITLE_H4=function(){this.classes.push("comment-h4")},i.prototype.BLOCK_COMMENT=function(){switch(this.token){case"*/":this.mode=this.startmode,this.classes.push("block-comment");break;default:this.classes.push("block-comment")}},i.prototype.COMMENT=function(){switch(this.token){case"@":case"#":this.mode="COMMENT_TAG",this.pushLine();t=document.createElement("span");this.applyClasses(t,["doxytag"]),this.lineelement.appendChild(t),this.lineelement=t;break;case"-":case"*":if("##"!=this.prevtoken&&"#"!=this.prevtoken&&"INVALID"!=this.prevtoken||32!=this.stream.peek()&&9!=this.stream.peek())"-"!=this.token?(this.pushMode(),this.mode="COMMENT_EMPH",this.classes.push("hidden-comment")):this.classes.push("comment");else{this.pushLine();t=document.createElement("div");this.applyClasses(t,["comment-ul"]),this.lineelement.appendChild(t),this.lineelement=t,this.classes.push("hidden-comment")}break;case"--":if(45==this.stream.peek()){for(this.outerline="eden-line eden-section-line";45==this.stream.peek();)this.tokentext+="-",this.stream.position++;this.classes.push("hidden-comment")}else this.classes.push("comment");break;case"[":if(32!=this.stream.peek()){this.pushMode(),this.mode="COMMENT_LINK",this.pushLine();var t=document.createElement("span");this.lineelement.appendChild(t),this.lineelement=t,this.classes.push("hidden-comment")}else this.classes.push("comment");break;case"!":91==this.stream.peek()?(this.mode="COMMENT_IMAGE",this.tokentext+="[",this.stream.position++,this.classes.push("hidden-comment")):this.classes.push("comment");break;case"$":91==this.stream.peek()?(this.pushMode(),this.mode="COMMENT_BUTTON",this.tokentext+="[",this.stream.position++,this.classes.push("hidden-comment")):this.classes.push("comment");break;case">":"##"!=this.prevtoken&&"#"!=this.prevtoken&&"INVALID"!=this.prevtoken||32!=this.stream.peek()&&9!=this.stream.peek()?this.classes.push("comment"):(this.outerline+=" "+this.styles["comment-blockquote"],this.classes.push("hidden-comment"));break;case"`":this.pushMode(),this.mode="COMMENT_CODE",this.classes.push("hidden-comment");break;case":":32!=this.stream.peek()?(this.pushMode(),this.mode="COMMENT_ICON",this.classes.push("hidden-comment")):this.classes.push("comment");break;case"<":32!=this.stream.peek()?(this.mode="COMMENT_HTML",this.classes.push("hidden-comment")):this.classes.push("comment");break;case'"':this.pushMode(),this.mode="COMMENT_ESCAPE",this.classes.push("hidden-comment");break;case"?":this.pushMode(),this.mode="COMMENT_QUERY",this.cacheddata=void 0,void 0==this.metrics[this.line]&&(this.metrics[this.line]={}),this.metrics[this.line].query=!0,void 0===this.metrics[this.line].qelements&&(this.metrics[this.line].qelements=[]),this.classes.push("hidden-comment");break;case"{":this.pushMode(),this.mode="COMMENT_ATTRS",this.classes.push("hidden-comment");break;default:this.classes.push("comment")}};var r={aliceblue:!0,antiquewhite:!0,aqua:!0,aquamarine:!0,azure:!0,beige:!0,bisque:!0,black:!0,blanchedalmond:!0,blue:!0,blueviolet:!0,brown:!0,burlywood:!0,cadetblue:!0,chartreuse:!0,chocolate:!0,coral:!0,cornflowerblue:!0,cornsilk:!0,crimson:!0,cyan:!0,darkblue:!0,darkcyan:!0,darkgoldenrod:!0,darkgray:!0,darkgrey:!0,darkgreen:!0,darkkhaki:!0,darkmagenta:!0,darkolivegreen:!0,darkorange:!0,darkorchid:!0,darkred:!0,darksalmon:!0,darkseagreen:!0,darkslateblue:!0,darkslategray:!0,darkslategrey:!0,darkturquoise:!0,darkviolet:!0,deeppink:!0,deepskyblue:!0,dimgray:!0,dimgrey:!0,dodgerblue:!0,firebrick:!0,floralwhite:!0,forestgreen:!0,fuchsia:!0,gainsboro:!0,ghostwhite:!0,gold:!0,goldenrod:!0,gray:!0,grey:!0,green:!0,greenyellow:!0,honeydew:!0,hotpink:!0,indianred:!0,indigo:!0,ivory:!0,khaki:!0,lavender:!0,lavenderblush:!0,lawngreen:!0,lemonchiffon:!0,lightblue:!0,lightcoral:!0,lightcyan:!0,lightgoldenrodyellow:!0,lightgray:!0,lightgrey:!0,lightgreen:!0,lightpink:!0,lightsalmon:!0,lightseagreen:!0,lightskyblue:!0,lightslategray:!0,lightslategrey:!0,lightsteelblue:!0,lightyellow:!0,lime:!0,limegreen:!0,linen:!0,magenta:!0,maroon:!0,mediumaquamarine:!0,mediumblue:!0,mediumorchid:!0,mediumpurple:!0,mediumseagreen:!0,mediumslateblue:!0,mediumspringgreen:!0,mediumturquoise:!0,mediumvioletred:!0,midnightblue:!0,mintcream:!0,mistyrose:!0,moccasin:!0,navajowhite:!0,navy:!0,oldlace:!0,olive:!0,olivedrab:!0,orange:!0,orangered:!0,orchid:!0,palegoldenrod:!0,palegreen:!0,paleturquoise:!0,palevioletred:!0,papayawhip:!0,peachpuff:!0,peru:!0,pink:!0,plum:!0,powderblue:!0,purple:!0,red:!0,rosybrown:!0,royalblue:!0,saddlebrown:!0,salmon:!0,sandybrown:!0,seagreen:!0,seashell:!0,sienna:!0,silver:!0,skyblue:!0,slateblue:!0,slategray:!0,slategrey:!0,snow:!0,springgreen:!0,steelblue:!0,tan:!0,teal:!0,thistle:!0,tomato:!0,turquoise:!0,violet:!0,wheat:!0,white:!0,whitesmoke:!0,yellow:!0,yellowgreen:!0};i.prototype.applyAttribute=function(t,e,s){if(t.style)switch(e){case"color":case"font-size":case"font-family":case"font-weight":case"font-style":case"text-decoration":case"margin-left":case"margin-right":t.style[e]=s;break;case"editable":"true"!=s&&"false"!=s||(t.contentEditable=s);break;case"script":t.setAttribute("data-jseden",s),t.contentEditable=!1,t.style.cursor="pointer",changeClass(t,"executable",!0);break;case"width":case"height":t.setAttribute(e,s);break;case"background":t.style.background=s;break;case"title":t.title=s;break;case"cursor":t.style.cursor=s;break;case"class":this.applyClasses(t,s.split(" "));break;default:t.style[e]=s}},i.prototype.parseAttrs=function(t,e){e||(e=this.lineelement.lastChild),(e=e?e.previousSibling:this.lineelement)||(e=this.lineelement);var s;if("."==(t=t.trim()).charAt(0)){var i=t.substring(1).match(/[a-z0-9\-]+/);if(null===i)return;s=i[0],t=t.substring(s.length+1).trim(),void 0===this.styleExtensions[s]&&(this.styleExtensions[s]={})}for(;t&&t.length>0;){var n,o=t.indexOf("=");-1==o?(n=t,t=""):(n=t.substring(0,o),t=t.substring(o+1));var a="";if("?"==t.charAt(0));else if('"'==t.charAt(0)||"'"==t.charAt(0)){o=-1;for(var h=t.charAt(0),p=1;p<t.length;p++){if(t.charAt(p)==h){o=p;break}"\\"==t.charAt(p)&&p++}if(-1==o)break;a=t.substring(1,o),t=t.substring(o+1)}else if(t.length>0){o=-1;for(p=0;p<t.length;p++)if(" "==t.charAt(p)){o=p;break}-1==o?(a=t,t=""):(a=t.substring(0,o),t=t.substring(o+1))}switch(t=t.trim(),n){case"colour":n="color";break;case"size":n="font-size";break;case"font":case"family":n="font-family";break;case"decoration":n="text-decoration";break;case"left":n="margin-left";break;case"right":n="margin-right";break;case"underline":n="text-decoration",a="underline";break;case"highlight":n="background",a="yellow";break;case"bold":n="font-weight",a="bold";break;case"italic":n="font-style",a="italic"}r[n]||"#"==n.charAt(0)?(a=n,n="color"):""==n&&(n="class"),s?this.styleExtensions[s][n]=a:this.applyAttribute(e,n,a)}return e},i.prototype.COMMENT_ATTRS=function(){for(var t=this.stream.peekLine(),e=0,s=-1,i=0;i<t.length;i++)if("{"==t.charAt(i))e++;else if("}"==t.charAt(i)&&--e<0){s=i;break}if(-1==s)this.classes.push("hidden-comment"),this.popMode();else{var r=t.substring(0,s),n=this.tokentext+r;if(this.tokentext+=r+"}",this.stream.position+=s+1,this.classes.push("hidden-comment"),"?"==n.charAt(0)){void 0==this.metrics[this.line]&&(this.metrics[this.line]={}),this.metrics[this.line].squery=!0;var o=this.parseQuery(n);o&&(o=o.join(" "),this.parseAttrs(o))}else this.parseAttrs(n);this.popMode()}},i.prototype.parseQuery=function(t){for(var e=t.substring(2),s=0,i=-1,r=0;r<e.length;r++)if("("==e.charAt(r))s++;else if(")"==e.charAt(r)&&--s<0){i=r;break}if(-1!=i){var n=e.substring(0,i);return Eden.Selectors.query(n,"value")}},i.prototype.COMMENT_QUERY=function(){if("["==this.token){for(var t=this.stream.peekLine(),e=-1,s=0;s<t.length;s++)if("]"==t.charAt(s)){e=s;break}if(-1==e)return void this.classes.push("hidden-comment");this.classes.push("hidden-comment"),this.cacheddata=t.substring(0,e),console.log("Q RES TYPE",this.cacheddata),this.stream.position+=e+1,this.tokentext+=this.cacheddata+"]"}else if("("==this.token){for(var t=this.stream.peekLine(),i=0,e=-1,s=0;s<t.length;s++)if("("==t.charAt(s))i++;else if(")"==t.charAt(s)&&--i<0){e=s;break}if(-1==e)this.popMode(),this.classes.push("hidden-comment");else{var r=t.substring(0,e);this.tokentext+=r+")",this.stream.position+=r.length+1,this.popMode(),this.classes.push("hidden-comment");var n=document.createElement("span");this.applyClasses(n,["comment-query"]),this.lineelement.appendChild(n);var o=Eden.Selectors.query(r,this.cacheddata?this.cacheddata:"value");o=1==o.length?o[0]:o.length>1?o.join(", "):"",n.setAttribute("data-result",o),this.cacheddata&&n.setAttribute("data-attribs",this.cacheddata),n.setAttribute("data-query",r),this.metrics[this.line].qelements.push(n)}}else this.popMode(),this.classes.push("hidden-comment")},i.prototype.COMMENT_LINK=function(){if("]"!=this.token)this.COMMENT();else if(this.classes.push("hidden-comment"),40==this.stream.peek()){var t=this.lineelement,e=t.parentNode,s=document.createElement("a");s.setAttribute("target","_blank"),s.contentEditable=!1,e&&(e.removeChild(t),s.appendChild(t),e.appendChild(s),this.lineelement=s),this.mode="COMMENT_LINK_END"}else this.popMode(),this.popLine()},i.prototype.COMMENT_LINK_END=function(){console.log("LINKEND",this.token);var t=this.stream.peekLine();if("("==this.token){var e=t.indexOf(")");if(-1==e)this.classes.push("hidden-comment"),this.popMode(),this.popLine();else{var s=t.substring(0,e);this.tokentext+=s+")",this.stream.position+=e+1,this.classes.push("hidden-comment"),this.popMode(),s.startsWith("http://")?this.lineelement.setAttribute("href",s):this.lineelement.setAttribute("href","javascript: Eden.Selectors.goto('"+s+"');"),this.popLine()}}},i.prototype.COMMENT_IMAGE=function(){var t=this.stream.peekLine(),e=t.indexOf("]");if(-1==e)this.classes.push("comment"),this.mode="COMMENT";else{var s=t.substring(0,e);console.log("IMG",this.tokentext),this.classes.push("comment"),this.mode="COMMENT_IMAGE_END",this.pushLine();var i=document.createElement("img");i.title=s,i.style.verticalAlign="top",this.lineelement.appendChild(i),this.lineelement=i}},i.prototype.COMMENT_BUTTON=function(){this.pushLine();var t=document.createElement("button");this.lineelement.appendChild(t),this.lineelement=t,t.contentEditable=!1,this.mode="COMMENT_BUTTON_CONTENT"},i.prototype.COMMENT_BUTTON_CONTENT=function(){"]"==this.token?(this.classes.push("hidden-comment"),this.popLine(),this.popMode()):this.COMMENT()},i.prototype.COMMENT_IMAGE_END=function(){var t=this.stream.peekLine(),e=t.indexOf(")");if(-1==e)this.classes.push("hidden-comment"),this.mode="COMMENT",this.popLine();else{var s=t.substring(0,e);this.tokentext+=s+")",this.stream.position+=e+1,this.classes.push("hidden-comment"),this.mode="COMMENT",this.lineelement.setAttribute("src",s.substring(1)),this.popLine()}},i.prototype.COMMENT_ESCAPE=function(){this.popMode(),this.classes.push("comment")},i.prototype.validHTMLTags={button:!0,span:!0,a:!0,img:!0,input:!0,table:!0,textarea:!0},i.prototype.COMMENT_HTML=function(){var t=this.tokentext;if(!i.prototype.validHTMLTags[t])return this.mode="COMMENT",void this.COMMENT();for(var e=this.stream.peekLine(),s=-1,r=!1,n=0,o=0;o<e.length;o++)if(e.charCodeAt(o)==n)r=!r,n=0;else if(0!=n||34!=e.charCodeAt(o)&&39!=e.charCodeAt(o)){if(r&&"\\"==e.charAt(o))o++;else if(!r&&">"==e.charAt(o)){s=o;break}}else r=!r,n=e.charCodeAt(o);if(s>=0){var a="<"+t+e.substring(0,s+1);this.tokentext=a.substring(1),this.cacheddata={opentag:a,tagname:t},this.classes.push("hidden-comment"),this.mode="COMMENT_HTML_START",this.stream.position+=s+1}else this.classes.push("hidden-comment"),this.tokentext+=e.substring(0,e.length-1),this.stream.position+=e.length-1,this.mode="COMMENT"},i.prototype.COMMENT_HTML_CONTENT=function(){if("<"!=this.token)this.COMMENT();else if(this.cacheddata){var t=this.stream.peekLine(),e="/"+this.cacheddata.tagname+">",s=t.indexOf(e);-1==s?this.classes.push("hidden-comment"):(this.cacheddata&&this.popLine(),this.tokentext+=e,this.stream.position+=s+e.length,this.classes.push("hidden-comment")),this.mode="COMMENT"}else this.mode="COMMENT"},i.prototype.COMMENT_HTML_START=function(){if("<"!=this.token){var t=this.cacheddata.opentag+i;this.mode="COMMENT_HTML_CONTENT",this.pushLine();var e=$(t).get(0);"button"!=this.cacheddata.tagname&&"a"!=this.cacheddata.tagname||(e.contentEditable=!1),this.lineelement.appendChild(e),this.lineelement=e,this.COMMENT()}else{var s=this.stream.peekLine(),i="/"+this.cacheddata.tagname+">",r=s.indexOf(i);-1==r?this.classes.push("hidden-comment"):(this.cacheddata&&this.popLine(),this.tokentext+=i,this.stream.position+=r+i.length,this.classes.push("hidden-comment")),this.mode="COMMENT"}},i.prototype.COMMENT_CODE=function(){"`"==this.token?(this.classes.push("hidden-comment"),this.popMode()):(this.classes.push("script"),this.START())},i.prototype.COMMENT_ICON=function(){if("OBSERVABLE"==this.token){if("-"==this.stream.code.charAt(this.stream.position)){var t=this.stream.peekLine(),e=t.indexOf(":");if(-1==e)return this.classes.push("comment"),void this.popMode();var s=t.substring(0,e);this.tokentext+=s,this.stream.position+=s.length}var i=document.createElement("span");i.className="eden-comment-icon fa fa-"+this.tokentext,this.lineelement.appendChild(i),this.classes.push("hidden-comment")}else":"==this.token&&(this.classes.push("hidden-comment"),this.popMode())},i.prototype.COMMENT_EMPH=function(){if("*"==this.token)this.mode="COMMENT_BOLD",this.classes.push("hidden-comment");else{var t=document.createElement("span");this.applyClasses(t,["comment-emph"]),this.lineelement.appendChild(t),this.pushLine(),this.lineelement=t,this.mode="COMMENT_ITALIC",this.COMMENT()}},i.prototype.COMMENT_ITALIC=function(){"*"==this.token?(this.classes.push("hidden-comment"),this.popLine(),this.popMode()):this.COMMENT()},i.prototype.COMMENT_BOLD=function(){if("*"==this.token)this.classes.push("hidden-comment"),this.popLine(),this.mode="COMMENT_BOLD_END";else{var t=document.createElement("span");this.applyClasses(t,["comment-bold"]),this.lineelement.appendChild(t),this.pushLine(),this.lineelement=t,this.mode="COMMENT_BOLD_END",this.COMMENT()}},i.prototype.COMMENT_BOLD_END=function(){"*"==this.token?("*"==this.stream.code.charAt(this.stream.position)&&(this.classes.push("hidden-comment"),this.stream.position++,this.tokentext+="*"),this.popLine(),this.popMode()):this.COMMENT()},i.prototype.COMMENT_TAG=function(){this.mode="END_COMMENT_TAG"},i.prototype.END_COMMENT_TAG=function(){this.popLine(),this.mode="COMMENT",this.COMMENT()},i.prototype.DOXY_COMMENT=function(){this.BLOCK_COMMENT()}},{"../js/highlighter.js":53}],53:[function(t,e,s){function i(t,e,s,i){function r(){n.insertBefore(e,o)}var n=e.parentNode,o=e.nextSibling;n?(n.removeChild(e),"boolean"!=typeof s&&(i=s,s=!1),i&&s?i.call(t,e,r):i&&(i.call(t,e),r())):i.call(t,e)}function r(t,e,s){this.ast=s?s.ast:null,this.stream=new lexer.Stream(e,s),this.outelement=t,this.line=1,this.currentline=-1,this.mode_at_line={},this.heredocend=void 0,this.scrolltop=-1,this.token=void 0,this.prevtoken=void 0,this.modestack=[],this.linestack=void 0,this.outerline=void 0,this.lineelement=void 0,this.startmode=s&&s.start?s.start:"START",this.styles=s&&s.styles?s.styles:r.defaultStyles,this.clearmodes=s&&s.clearmodes?s.clearmodes:r.lineclearmode,this.mode=this.startmode,this.incomment=!1,this.brline=s&&s.brline,this.options=s||{},this.storageNames=this.options.storageNames?this.options.storageNames:builtins.storage,this.valueNames=this.options.valueNames?this.options.valueNames:builtins.values,this.specialNames=this.options.specialNames?this.options.specialNames:builtins.specials,this.functionNames=this.options.functionNames?this.options.functionNames:builtins.functions,this.styleExtensions={},this.metrics={}}lexer=t("@construit/lexer"),builtins=t("./builtins.js"),r.defaultStyles={comment:"eden-comment","hidden-comment":"eden-comment-hidden",operator:"eden-operator",observable:"eden-observable",storage:"eden-storage",number:"eden-number",string:"eden-string",constant:"eden-constant",parameter:"eden-parameter",keyword:"eden-keyword",javascript:"eden-javascript",selector:"eden-selector",selector2:"eden-selector2",selector3:"eden-selector3",function:"eden-function",type:"eden-type",special:"eden-special",backticks:"eden-backticks",doxycomment:"eden-doxycomment",pathblock:"eden-pathblock","comment-h1":"eden-comment-h1","comment-h2":"eden-comment-h2","comment-h3":"eden-comment-h3","comment-h4":"eden-comment-h4","horizontal-line":"eden-section-line","comment-line":"eden-comment-line","comment-emph":"eden-comment-emph","comment-bold":"eden-comment-bold","script-line":"eden-line-script",doxytag:"eden-doxytag","comment-query":"eden-comment-query","block-comment":"eden-blockcomment","comment-ul":"eden-comment-ul","comment-blockquote":"eden-comment-blockquote",script:"eden-script",notexist:"eden-notexist"},r.prototype.pushLine=function(){this.linestack.push(this.lineelement)},r.prototype.pushMode=function(){this.modestack.push(this.mode)},r.prototype.popLine=function(){this.linestack.length>0&&(this.lineelement=this.linestack.pop())},r.prototype.popMode=function(){this.modestack.length>0&&(this.mode=this.modestack.pop())},r.prototype.setScrollTop=function(t){this.scrolltop=t},r.isType=function(t){return!1},r.lineclearmode={COMMENT:!0,SECTION_TITLE:!0,SECTION_TITLE2:!0,SECTION_TITLE3:!0,SECTION_TITLE4:!0,SECTION_TITLE_H1:!0,SECTION_TITLE_H2:!0,SECTION_TITLE_H3:!0,SECTION_TITLE_H4:!0,COMMENT_BOLD:!0,COMMENT_CODE:!0,COMMENT_ICON:!0,COMMENT_EMPH:!0,COMMENT_ITALIC:!0,COMMENT_BOLD_END:!0,COMMENT_QUERY:!0,END_COMMENT_TAG:!0,COMMENT_TAG:!0,COMMENT_LINK:!0,COMMENT_LINK_END:!0,COMMENT_HTML:!0,COMMENT_HTML_START:!0,COMMENT_HTML_CONTENT:!0,COMMENT_ATTRS:!0},r.prototype.applyClasses=function(t,e){for(var s=e||this.classes,i="",r=0;r<s.length;r++)if(i+=this.styles[s[r]]+" ",this.styleExtensions[s[r]]){var n=this.styleExtensions[s[r]];for(var o in n)this.applyAttribute(t,o,n[o])}t.className=i.trim()},r.prototype.generateClasses=function(){for(var t="",e=0;e<this.classes.length;e++)t+=this.styles[this.classes[e]]+" ";return t.trim()},r.prototype.highlightLine=function(t){var e=!1,s=this.stream;this.stream=s;var i="INVALID",r="INVALID";this.outerline="",this.linestack=[],this.mode_at_line[this.line-1]?this.mode=this.mode_at_line[this.line-1]:this.mode=this.startmode,this.clearmodes[this.mode]&&(this.incomment=!1,this.mode=this.startmode);var n="",o=this.lineelement;if(35==s.peek()&&35!=s.peek2())if(o&&"commentbox"==o.className.trim())if(10==s.peek2()){var a=document.createElement("p");o.appendChild(a),o=a,this.pushLine()}else this.pushLine(),o=o.lastElementChild;else(o=document.createElement("div")).className="commentbox",this.lineelement=o,o=document.createElement("p"),this.lineelement.appendChild(o),this.pushLine();else(o=document.createElement("div")).className=this.styles["script-line"];for(this.lineelement=o;;){if(s.position==t){if(""!=n){p=document.createTextNode(n);o.appendChild(p),n=""}(c=document.createElement("span")).className="fake-caret",o.appendChild(c);for(m=o;m&&"DIV"!=m.nodeName;)m=m.parentNode;m&&m.className.startsWith(this.styles["comment-line"])&&(m.className+=" current")}var h=s.peek();if(10==h||13==h){if(""!=n){if(o.lastChild&&o.lastChild.className!=this.styles["hidden-comment"]&&"fake-caret"!=o.lastChild.className)if(o.lastChild.lastChild&&"#text"==o.lastChild.lastChild.nodeName)o.lastChild.lastChild.textContent+=n;else{p=document.createTextNode(n);o.lastChild.appendChild(p)}else{p=document.createTextNode(n);o.appendChild(p)}n=""}break}if(9!=h&&13!=h&&32!=h&&160!=h){if(""!=n){if(o.lastChild&&o.lastChild.className!=this.styles["hidden-comment"]&&"fake-caret"!=o.lastChild.className)if(o.lastChild.lastChild&&"#text"==o.lastChild.lastChild.nodeName)o.lastChild.lastChild.textContent+=n;else{p=document.createTextNode(n);o.lastChild.appendChild(p)}else{p=document.createTextNode(n);o.appendChild(p)}n=""}if(r=i,"string"!=typeof(i=s.readToken(this.incomment))&&console.error("Token error: line = "+this.line+" position = "+s.position),"EOF"==i){if(""!=n){if(o.lastChild&&o.lastChild.className!=this.styles["hidden-comment"]&&"fake-caret"!=o.lastChild.className)if(o.lastChild.lastChild&&"#text"==o.lastChild.lastChild.nodeName)o.lastChild.lastChild.textContent+=n;else{p=document.createTextNode(n);o.lastChild.appendChild(p)}else{var p=document.createTextNode(n);o.appendChild(p)}n=""}break}if("INVALID"!=i)if(this.token=i,this.prevtoken=r,this.type=lexer.Stream.tokenType(i),this.classes=[],this.tokentext=s.tokenText(),e&&"EOF"!=ast.script.errors[0].token&&this.classes.push("error"),void 0===this[this.mode]&&console.error("No Mode",this.mode),this[this.mode].call(this),o=this.lineelement,s.prevposition<t&&s.position>t){var c=t-s.prevposition,l=this.tokentext.slice(0,c),u=this.tokentext.slice(c),d=document.createElement("span");this.applyClasses(d),(f=document.createElement("span")).appendChild(document.createTextNode(l)),d.appendChild(f),(c=document.createElement("span")).className="fake-caret",d.appendChild(c),(f=document.createElement("span")).appendChild(document.createTextNode(u)),d.appendChild(f),o.appendChild(d);for(var m=o;m&&"DIV"!=m.nodeName;)m=m.parentNode;m&&m.className.startsWith(this.styles["comment-line"])&&(m.className+=" current")}else if(o.lastChild&&o.lastChild.className==this.generateClasses())(f=o.lastChild).lastChild&&"#text"==f.lastChild.nodeName?f.lastChild.textContent+=this.tokentext:f.appendChild(document.createTextNode(this.tokentext));else{var f=document.createElement("span");this.applyClasses(f),f.appendChild(document.createTextNode(this.tokentext)),o.appendChild(f)}else console.log("INVALID: "+s.peek()),s.skip()}else s.skip(),32==h||160==h?n+=" ":13!=h&&(n+=String.fromCharCode(h))}return this.linestack.length>0&&(o=this.linestack[0],this.lineelement=o),this.mode_at_line[this.line]=this.mode,o},r.prototype.highlightAll=function(t,e){var s=void 0,r=!1,n=0,o=this.stream;this.metrics={},this.styleExtensions={},i(this,this.outelement,!1,function(){for(;this.outelement.lastChild;)this.outelement.removeChild(this.outelement.lastChild);for(this.mode_at_line={};o.valid();){var i=o.peek();if(10!=i&&13!=i)if(this.disablehl||this.scrolltop>=0&&(this.line<this.scrolltop-105||this.line>this.scrolltop+105)){var a,h=o.code.indexOf("\n",o.position);-1==h?(a=o.code.substring(o.position),o.position=o.code.length):(a=o.code.substring(o.position,h),o.position=h),s=document.createTextNode(a),this.disablehl||"#"!=a.trim().charAt(0)||(this.outerline="eden-line eden-wrapline")}else s=this.highlightLine(t);else{r=n<=this.errstart&&o.position>=this.errend,void 0===s&&this.brline?s=document.createElement("br"):void 0===s&&(s=document.createElement("div"),console.log("MISSING LINE"),this.lineelement=void 0),s.className=this.outerline+" "+s.className,e&&e.spacing&&e.spacing[this.line]&&(s.height=e.spacing[this.line]+"px"),this.line++,void 0!==s||(this.mode_at_line[this.line-1]=this.mode);var p=document.createTextNode("\n");s.appendChild(p),this.outelement.appendChild(s),n=o.position+1,s=void 0,o.skip(),13==i&&o.skip(),this.outerline=""}}if(r=n<=this.errstart&&o.position>=this.errend,void 0===s&&this.brline&&(s=document.createElement("br")),void 0!==s)(c=document.createElement("div")).className="eden-line",e&&e.spacing&&e.spacing[this.line]&&(c.style.height=e.spacing[this.line]+"px"),c.setAttribute("data-line",this.line-1),c.appendChild(s),this.outelement.appendChild(c);else{var c=document.createElement("div");if(t>=o.position){c.className="eden-line",e&&e.spacing&&e.spacing[this.line]&&(c.style.height=e.spacing[this.line]+"px"),c.setAttribute("data-line",this.line-1);var l=document.createElement("span");l.className="fake-caret",c.appendChild(l)}else c.className="eden-line";this.outelement.appendChild(c)}})},r.prototype.highlightOpt=function(t,e,s){for(var i=void 0,r=0,n=this.stream;n.valid()&&this.line<t-1;)10!=(f=n.peek())&&13!=f||this.line++,n.skip(),13==f&&n.skip();for(var o=2;o>=0;o--)if(this.line=t-o+1,this.metrics[this.line]&&delete this.metrics[this.line],void 0!==(g=this.outelement.childNodes[t-o])){for(;g.lastChild;)g.removeChild(g.lastChild);if(r=n.position,this.disablehl){var a,h=n.code.indexOf("\n",n.position);if(-1==h?(a=n.code.substring(n.position),n.position=n.code.length):(a=n.code.substring(n.position,h),n.position=h),r<e&&n.position>e){var p=e-r,c=a.slice(0,p),l=a.slice(p),u=document.createElement("span"),d=document.createTextNode(c);u.appendChild(d),(p=document.createElement("span")).className="fake-caret",u.appendChild(p);var m=document.createTextNode(l);u.appendChild(m),i=u}else i=document.createTextNode(a)}else i=this.highlightLine(e);r<=this.errstart&&n.position>=this.errend,g.appendChild(i),g.className=this.outerline;var f=n.peek(),x=document.createTextNode("\n");g.appendChild(x),n.skip(),13==f&&n.skip()}if(!this.disablehl)for(;void 0!==this.mode_at_line[this.line+1]&&this.mode_at_line[this.line]!=this.mode_at_line[this.line+1];){this.line++,this.metrics[this.line]&&delete this.metrics[this.line];var g=this.outelement.childNodes[this.line-1];if(void 0!==g){for(;g.lastChild;)g.removeChild(g.lastChild);r=n.position,i=this.highlightLine(e),r<=this.errstart&&n.position>=this.errend,g.appendChild(i),g.className=this.outerline;var f=n.peek(),x=document.createTextNode("\n");g.appendChild(x),n.skip(),13==f&&n.skip()}}},r.prototype.highlight=function(t,e,s){if(this.line=1,void 0!==this.outelement){if(0!=this.stream.code.length)return this.disablehl=!(!s||!s.disabled),-1==t?this.highlightAll(e,s):this.highlightOpt(t,e,s);this.outelement&&(this.outelement.innerHTML="<div class='eden-line'><span class='fake-caret'></span></div>")}},e.exports=r},{"./builtins.js":51,"@construit/lexer":58}],54:[function(t,e,s){const i=t("./highlighter.js");t("./rules.js"),t("./commentrules.js"),s.Highlighter=i,s.highlight=function(t,e,s){return new i(t,e,s).highlight(-1,-1,void 0),t},s.html=function(t,e,s){var r=document.createElement("div");if(new i(r,t).highlight(-1,-1,void 0),e)return r.childNodes[0].innerHTML;for(var n="",o=0;o<r.childNodes.length;o++)n+=r.childNodes[o].innerHTML;return s?'<div style="display: flex; align-items: center;"><div class="eden-hl-play" data-src="'+t+'">&#xf04b;</div><div>'+n+"</div></div>":n}},{"./commentrules.js":52,"./highlighter.js":53,"./rules.js":55}],55:[function(t,e,s){const i=t("../js/highlighter.js"),r=t("@construit/ast").Indexer,n=t("@construit/language");i.prototype.START=function(){switch(this.token){case"##":"INVALID"==this.prevtoken?(this.classes.push("hidden-comment"),this.mode="SECTION_TITLE",this.applyClasses(this.lineelement,["comment-line"]),32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)):(this.classes.push("comment"),this.mode="COMMENT");break;case"#":if("INVALID"==this.prevtoken||";"==this.prevtoken){var t=33==this.stream.peek();t&&(this.tokentext+="!",this.stream.position++),this.classes.push("hidden-comment"),this.mode="COMMENT",this.incomment=!0,this.applyClasses(this.lineelement,t?["comment-line","doxycomment"]:["comment-line"]),32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)}else this.classes.push("operator");break;case"NUMBER":this.classes.push("number");break;case"STRING":this.classes.push("string");break;case"BOOLEAN":this.classes.push("constant");break;case"CHARACTER":this.classes.push("string");break;case"use":this.classes.push("keyword"),this.pushMode(),this.mode="SELECTOR";break;case"${{":this.classes.push("javascript"),this.mode="JAVASCRIPT";break;case"<<":this.stream.readToken();var e=this.stream.tokenText();this.tokentext+=e,this.heredocend=e,this.classes.push("storage"),this.mode="HEREDOC";break;case"OBSERVABLE":this.functionNames.hasOwnProperty(this.stream.data.value)?this.classes.push("function"):i.isType(this.stream.data.value)?this.classes.push("type"):this.valueNames.hasOwnProperty(this.stream.data.value)?this.classes.push("constant"):this.specialNames.hasOwnProperty(this.stream.data.value)?this.classes.push("special"):"$"==this.stream.data.value.charAt(0)?this.classes.push("parameter"):(this.classes.push("observable"),this.options.showMissing&&(r.name_index.hasOwnProperty(this.stream.data.value)||this.classes.push("notexist")));break;case"`":this.classes.push("operator"),this.pushMode(),this.mode="SELECTOR";break;default:"keyword"==this.type?this.storageNames.hasOwnProperty(this.stream.data.value)?this.classes.push("storage"):this.classes.push("keyword"):"-"==this.token&&this.stream.isNumeric(this.stream.peek())?(this.token=this.stream.readToken(),this.tokentext="-"+this.stream.tokenText(),this.classes.push("number")):"/*"==this.token?42==this.stream.peek()?(this.mode="DOXY_COMMENT",this.classes.push("block-comment")):(this.mode="BLOCK_COMMENT",this.classes.push("block-comment")):this.classes.push("operator")}},i.prototype.BACKTICK=function(){"`"==this.token?this.mode="ENDBACKTICK":"}"==this.token?(this.popMode(),this.classes.push("operator")):this.START()},i.prototype.ENDBACKTICK=function(){this.popLine(),this.popMode(),this.START()},i.prototype.SELECTOR=function(){this.pushLine();var t=document.createElement("span");this.applyClasses(t,["pathblock"]),this.lineelement.appendChild(t),this.lineelement=t,this.mode="SELECTOR2",this.SELECTOR2()},i.prototype.SELECTOR2=function(){"{"==this.token?(this.classes.push("operator"),this.pushMode(),this.mode=this.startmode):"["==this.token?(this.classes.push("selector"),this.mode="SELECTOR_TYPES"):"`"==this.token||";"==this.token||"="==this.token||"+="==this.token||"//="==this.token?(this.popLine(),this.classes.push("operator"),this.popMode()):"::"==this.token||"with"==this.token||"as"==this.token?(this.popLine(),this.classes.push("keyword"),this.popMode()):"OBSERVABLE"!=this.token||"."!=this.prevtoken&&":"!=this.prevtoken||!n.selectorAttributes[this.tokentext]&&!n.selectorPseudo[this.tokentext]?this.classes.push("selector"):this.classes.push("selector2")},i.prototype.SELECTOR_TYPES=function(){"OBSERVABLE"==this.token&&n.resultTypes[this.tokentext]?this.classes.push("selector3"):"]"==this.token?(this.classes.push("selector"),this.mode="SELECTOR2"):this.classes.push("selector")},i.prototype.JAVASCRIPT=function(){this.classes.push("javascript"),"}}$"==this.token&&(this.mode=this.startmode)},i.prototype.HEREDOC=function(){"INVALID"==this.prevtoken&&this.tokentext==this.heredocend?(this.classes.push("storage"),this.mode=this.startmode):this.classes.push("string")}},{"../js/highlighter.js":53,"@construit/ast":35,"@construit/language":57}],56:[function(t,e,s){s.errors=[["An unknown error occurred"],["Wrong kind of bracket, expected a ')'","Missing a closing ')' bracket before end of statement","Missing a closing bracket ')' or operator"],["Wrong kind of bracket, use '(' or '[' in expressions.","Missing expression? Unexpected closing bracket","Expected a value or observable","Missing an operand.","Keywords are not allowed in expressions"],["Need a ':' before listing trigger observables","Actions require a list of observables to trigger on, expected a ':'","Expecting a ':' here","Need a ':' after an action name, not a reserved word"],["A reserved word cannot be used as an observable name","Umm, ask for some help. Need a list of observables","There needs to be at least one watch observable","Expressions cannot be used as watches","Literals cannot be watched by actions","Missing first observable before comma","Cannot watch list literals"],["Either too many ','s or a missing watch observable","Must give an observable name, not an expression","The reserved word '%R' cannot be used as an observable name","Expecting an observable name but got %T"],["Cannot do a function call here","Can only watch observables, not a specific list index","An action must have a body of code","Missing an open '{' to start the action code","Use ',' to separate watch observables","Expected an open '{' to start action","Action code must start with a curly '{' bracket"],["Wrong kind of bracket to close an action, use '}' instead","Missing a closing '}' bracket at end of action code"],["Reserved words cannot be used as local variable names","Missing a name after a 'local' declaration","'local' must be followed by a valid name"],["Need a ';' after a local declaration","It's not possible to initialise a local here"],["Did you mean 'when change' or 'when touch'?","Need to know type of 'when' first (change, touch or condition)","Wrong kind of bracket, use '(' for a 'when' condition","A 'when' must have some condition or trigger observables"],["A list index must be a valid expression","A list index must be a valid expression","A list index must be a valid expression"],["Wrong kind of bracket, need a ']' to end the list index","Missing a ']' to end the list index","Missing a ']' to end the list index","Unexpected observable name, did you forget ']'?"],["Must be an observable name","Expected an observable name, cannot use reserved words as observables","Missing an observable"],["Missing a ';'","Incomplete floating point number","Need another dot for a range, or a property name","Missing a ';' on previous line?","Missing either an operator or a ';'","Missing an open bracket, or too many close brackets","Expected a ';' not a bracket"],["A keyword can't be used as an observable name","Missing an observable name","Wrong kind of bracket, only '{' is allowed here"],["Must be an 'is' or some kind of assignment","Must be an 'is' or some kind of assignment","Must be an 'is' or some kind of assignment","Wrong kind of bracket, can only be '['"],["Missing a ')' after function call","Missing a ')' after function call","Missing a ')' after function call","Missing a ')' after function call","Wrong kind of bracket, need a ')'"],["Missing a ']' after a list literal"],["An 'if' in an expression must have a ':' else part"],["An 'if' condition must be surrounded by '(' and ')'"],["Missing a closing ')' after if condition"],["Reserved words can't be used as para names","'para' can't be used as an observable name","Unexpected bracket, expected a para name"],["Need a ';' after a para declaration","It's not possible to initialise a para","Need a ';' after a para declaration","Unexpected bracket, need a ';'"],["Cannot do a function call here","Can only watch observables, not a specific list index","An action must have a body of code","Missing an open '{' to start the action code","Use ',' to separate watch observables","Expected an open '{' to start action","Action code must start with a curly '{' bracket"],["Wrong kind of bracket, use '}' to end action code","Missing a closing '}'"],["'func' names can't be keywords","'func' needs a name","'func' needs a name"],["Missing an open '(' in 'for'"],["Missing a closing ')' after 'for'"],["Missing a ';' after initialising statement in 'for'"],["Missing a ';' after 'for' condition"],["Expected a '[' to list subscribers"],["Expected a ']' to end subscribers list"],["Expected a '(' to start 'switch' expression"],["Expected a ')' to end 'switch' expression"],["A 'default' statement must be followed by a ':'"],["A 'case' needs a number or string after it"],["A 'case' must end in a ':'"],["An 'insert' operation takes 3 parts"],["A 'delete' operation takes 2 parts"],["An 'append' operation takes 2 parts"],["Expected an observable name for a scope override"],["Missing an 'is' in giving a scope override"],["Need a closing ')' when using a procedure","Need a closing ')' when giving function parameters"],["Missing a closing backtick"],["While loop conditions start with an open '('"],["Missing a closing ')' after while condition"],["While loops must have a statement"],["Expected a number after a negative sign"],["Cannot define individual list items"],["List items start at 1"],["Invalid property name"],["Missing 'while' after 'do' statement(s)"],["Using '$' for parameters requires a number starting at 1"],["Problem whilst executing a function call"],["Missing an open ( in 'after' statement"],["Missing a close ) in 'after' statement"],["Actions need a name"],["Missing an '(' before 'when' expression"],["Missing a close ')' after 'when' expression"],["'do' requires an action name to call"],["'proc' names cannot be keywords","'proc' action names cannot be a literal value","'proc' actions need a name","Unexpected closing bracket","A 'proc' needs a name before it's watch list","A 'proc' needs a name and a watch list"],["Incorrect import path, must be names and '/'"],["Invalid import option"],["Combination of options not allowed"],["Missing statement after 'if'"],["Missing statement after 'after'"],["Missing statement after 'when'"],["Missing a character between single quotes"],["Missing a closing quote after character literal"],["Strings cannot be split over multiple lines"],["Missing a closing quote after a string"],["Import version tag invalid"],["Switch must have a code block { }"],['A range "in" cannot be used here'],["A heredoc token must be a single word at the end of a line"],["Invalid action name in code selector"],["Invalid code selector attribute"],["Invalid code selector hashtag"],["Missing a closing } after embedded expression"],["Invalid selector option"],["A query must be enclosed in ()"],["Missing a closing query bracket"],["A query must specify what to return using []"],["Missing a closing ]"],["Expected a comma separated list of attributes"],["A block comment has not been closed"],["You must have a new line after a section header or comment"]],s.ui={tooltips:{home_logo:"Home page in new tab",notifications:"Notifications",maker:"Maker Mode",comments:"Comments",save:"Save or Share",create:"Create Views",existing:"Existing",clear:"Clear",rename:"Rename project",options:"Options",help:"Help"},comments:{signin:"Sign-in to post a comment...",comments:"Comments"},links:{learnmore:"Learn More",conference2017:"Conference 2017",teachers:"Teachers",students:"Students",lifelong:"Lifelong",erasmus:"Erasmus+ Project"},categories:{featured:"Featured Construals",starter:"Starter Examples",all:"All Construals",ref:"Reference",construit2017:"Construit 2017",games:"Games",edres:"Educational Resources",seemore:"See More"},welcome:{},input_window:{title:"Script View",run:"Run"},canvas:{title:"Canvas Picture"},menu_bar:{signin:"Sign-in",search:"Search...",opt_confirm:"Confirm closing environment",opt_simple_search:"Simplified searching",opt_hide:"Hide windows on minimize",opt_collapse:"Collapse to title bar on double click",opt_debug:"Debug JS-EDEN",cancel:"Cancel",notconnected:"Not Connected"},search:{disjunction:"or"},general:{error:"Error",loading:"Loading...",finished_loading:"JS-EDEN has finished loading.",leaving:"Leaving this page will discard the current script. Your work will not be saved."},notifications:{no:"No notifications"},details:{open:"Open",follow:"Follow",maker:"Maker",authors:"Authors",published:"Published by",by:"by"},explorer:{capture:"Capture",clear:"Clear",state:"State",settings:"Settings",filter:"Filter...",input:"Script Input"},views:{agent:"Agent List",functions:"Function List",observables:"Observable List",symbols:"Symbol List",map:"Dependency Map",lookup:"Symbol Look-Up Table",script:"Script View",version:"Version List",debug:"Debugger",canvas:"Canvas 2D",html:"HTML Content",plugin:"Plug-in Manager"},viewcat:{comprehension:"Comprehension",making:"Making Definitions",history:"History & State",vis:"Visualisation",management:"Management"},sharebox:{file:"File",title:"Save and Share",publically:"List publically",save:"Save",fork:"Fork"}}},{}],57:[function(t,e,s){let i={language:"en",loadSymbols:function(t){for(var e in this.symbols)e!=this.symbols[e]&&void 0===t.symbols[this.symbols[e]]&&(t.symbols[this.symbols[e]]=t.lookup(e))},addKeywords:function(t){for(var e in t)this.keywords[e]=t[e]},addSymbols:function(t){for(var e in t)this.symbols[e]=t[e]},doxytags:{title:"title",author:"author",version:"version",param:"param",return:"return",debug:"debug",local:"local",role:"role",shared:"shared",oracle:"oracle",handle:"handle",deprecated:"deprecated",see:"see","{":"{","}":"}",hidden:"hidden",script:"script"},selectorAttributes:{name:"name",type:"type",datatype:"datatype",id:"id",lines:"lines",depends:"depends",time:"time",date:"date",title:"title",author:"author",v:"v",version:"version",source:"source",comment:"comment"},selectorOptions:{external:"external",history:"history",all:"all",indexed:"indexed",index:"index",nosort:"nosort",remote:"remote"},resultTypes:{brief:"brief",comment:"comment",source:"source",innersource:"innersource",title:"title",path:"path",name:"name",symbol:"symbol",line:"line",depends:"depends",value:"value",tags:"tags",rawcomment:"rawcomment",id:"id",remote:"remote",root:"root",enabled:"enabled",executed:"executed",exprtree:"exprtree"},selectorPseudo:{line:"line",determines:"determines",first:"first",last:"last",unexecuted:"unexecuted",executed:"executed",root:"root",project:"project",nth:"nth",value:"value",matches:"matches",age:"age",remote:"remote",not:"not",active:"active",me:"me",listed:"listed"},keywords:{function:"function",auto:"local",para:"para",local:"local",var:"local",if:"if",is:"is",in:"in",else:"else",for:"for",while:"while",do:"do",switch:"switch",case:"case",default:"default",break:"break",continue:"continue",return:"return",when:"when",wait:"wait",use:"use",as:"as",delete:"delete",with:"with",and:"and",or:"or",not:"not"},values:{true:!0,false:!1,"@":void 0},errors:[]};var r=t("./en.js");i.errors=r.errors,i.ui=r.ui,e.exports=i},{"./en.js":56}],58:[function(t,e,s){function i(t,e){this.name=t,this.value=e}let r=t("@construit/language"),n=function(){this.value=void 0,this.error=!1,this.line=0},o=function(t,e){this.code=t,this.position=0,this.position_stack=[0],this.prevposition=0,this.line=1,this.prevline=1,this.data=new n,this.paragraph=!1,this.indent=!1,this.ignorestrings=e&&e.ignoreStrings,this.keywords=e&&e.keywords?e.keywords:r.keywords};o.prototype.pushPosition=function(){this.position_stack.push(this.position)},o.prototype.popPosition=function(){this.position=this.position_stack.pop()},o.prototype.discardPosition=function(){this.position_stack.pop()},o.prototype.get=function(){return this.position<this.code.length?this.code.charCodeAt(this.position++):0},o.prototype.peek=function(){return this.position<this.code.length?this.code.charCodeAt(this.position):0},o.prototype.peek2=function(){return this.position+1>=this.code.length?0:this.code.charCodeAt(this.position+1)},o.prototype.peek3=function(){return this.position+2>=this.code.length?0:this.code.charCodeAt(this.position+2)},o.prototype.readLine=function(){var t=this.code.indexOf("\n",this.position);if(-1==t){e=this.code.substring(this.position);return this.position=this.code.length,e}var e=this.code.substring(this.position,t+1);return this.position=t+1,this.line++,e},o.prototype.peekLine=function(){var t=this.code.indexOf("\n",this.position);if(-1==t)return e=this.code.substring(this.position);var e=this.code.substring(this.position,t+1);return e},o.prototype.move=function(t){this.position=t},o.prototype.reset=function(){this.position=0,this.position_stack=[0],this.prevposition=0,this.line=1},o.prototype.tokenText=function(){return this.code.substr(this.prevposition,this.position-this.prevposition)},o.prototype.isBEOL=function(){if(10==this.peek2())return!0;for(var t=this.prevposition-1,e=this.code.charCodeAt(t);9==e||32==e;)t--,e=this.code.charCodeAt(t);return 10==e},o.prototype.skip=function(){this.position++},o.prototype.eof=function(){return this.position>=this.code.length},o.prototype.valid=function(){return this.position<this.code.length},o.prototype.unget=function(){this.position--},o.prototype.skipWhiteSpace=function(){for(var t=!1;this.valid();){var e=this.peek();if(10==e)this.line++,t&&(this.paragraph=!0),t=!0,this.indent=!1,this.skip();else if(9==e)t&&(this.indent=!0),this.skip();else if(32==e){if(this.skip(),t){if(32!=this.peek())continue;if(this.skip(),32!=this.peek())continue;if(this.skip(),32!=this.peek())continue;this.skip(),this.indent=!0}}else{if(13!=e&&160!=e)break;this.skip()}}},o.prototype.skipLine=function(){for(;this.valid()&&10!=this.peek();)this.skip()},o.isAlphaNumeric=function(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||95==t||t>=128||36==t},o.prototype.isNumeric=function(t){return t>=48&&t<=57},o.tokenType=function(t){return"OBSERVABLE"==t?"identifier":"JAVASCRIPT"==t?"javascript":"NUMBER"==t?"number":"STRING"==t?"string":"CHARACTER"==t?"character":"BOOLEAN"==t?"boolean":"string"!=typeof t?(console.error(t),"INVALID"):o.isAlphaNumeric(t.charCodeAt(0))?"keyword":"("==t||"["==t||"{"==t?"openbracket":")"==t||"]"==t||"}"==t?"closebracket":","==t||"."==t||";"==t||":"==t?"separator":"operator"},o.prototype.parseAlphaNumeric=function(t){var e="";if(0==o.isAlphaNumeric(this.peek()))return!1;for(;this.valid()&&o.isAlphaNumeric(this.peek());)e+=String.fromCharCode(this.get());return t.value=e,!0},o.prototype.parseString=function(t,e){for(var s="";this.valid()&&this.peek()!=e;){var i=String.fromCharCode(this.get());if("\n"==i)return this.unget(),t.error=!0,void(t.value="LINEBREAK");s+="\\"==i?"\\"+(i=String.fromCharCode(this.get())):i}this.valid()&&this.peek()==e?(this.skip(),t.error=!1):t.error=!0,t.value=s},o.prototype.parseCharacter=function(t){var e=String.fromCharCode(this.get());if("'"==e)return t.value="",void(t.error=!0);"\\"==e&&(e=String.fromCharCode(this.get())),t.value=e,this.valid()&&39==this.peek()?this.skip():t.error=!0},o.prototype.parseNumber=function(t){for(var e="";this.valid()&&this.isNumeric(this.peek());)e+=String.fromCharCode(this.get());if(46==this.peek()&&this.isNumeric(this.peek2()))for(this.skip(),e+=".";this.valid()&&this.isNumeric(this.peek());)e+=String.fromCharCode(this.get());t.value=parseFloat(e)},o.prototype.readToken=function(t,e){if(this.prevline=this.line,this.paragraph=!1,this.skipWhiteSpace(),this.prevposition=this.position,void 0===t&&(t=this.ignorestrings),this.eof())return"EOF";var s=this.code.charCodeAt(this.position);switch(this.position++,s){case 33:return 61==this.peek()?(this.skip(),"!="):126==this.peek()?(this.skip(),"!~"):"!";case 34:return t?'"':(this.parseString(this.data,34),"STRING");case 35:return 35==this.peek()?(this.skip(),"##"):"#";case 36:if(123==this.peek()&&123==this.peek2())return this.skip(),this.skip(),"${{";break;case 37:return 61==this.peek()?(this.skip(),"%="):"%";case 38:return 38==this.peek()?(this.skip(),"&&"):61==this.peek()?(this.skip(),"&="):"&";case 39:return t?"'":(this.parseString(this.data,39),"STRING");case 40:return"(";case 41:return")";case 42:return 61==this.peek()?(this.skip(),"*="):47==this.peek()?(this.skip(),"*/"):"*";case 43:return 43==this.peek()?(this.skip(),"++"):61==this.peek()?(this.skip(),"+="):"+";case 44:return",";case 45:return 45==this.peek()?(this.skip(),"--"):61==this.peek()?(this.skip(),"-="):62==this.peek()?(this.skip(),"->"):"-";case 46:return 46==this.peek()&&46==this.peek2()?(this.skip(),"..."):46==this.peek()?(this.skip(),".."):".";case 47:return 47==this.peek()&&61==this.peek2()?(this.skip(),"//="):47==this.peek()?(this.skip(),"//"):61==this.peek()?(this.skip(),"/="):42==this.peek()?(this.skip(),"/*"):"/";case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.unget(),this.parseNumber(this.data),"NUMBER";case 58:return 58==this.peek()?(this.skip(),"::"):61==this.peek()?(this.skip(),":="):45==this.peek()?(this.skip(),":-"):":";case 59:return";";case 60:return 60==this.peek()?(this.skip(),"<<"):61==this.peek()?(this.skip(),"<="):"<";case 61:return 61==this.peek()?(this.skip(),"=="):126==this.peek()?(this.skip(),"=~"):62==this.peek()?(this.skip(),"=>"):"=";case 62:return 62==this.peek()?(this.skip(),">>"):61==this.peek()?(this.skip(),">="):">";case 63:return"?";case 64:return"@";case 91:return"[";case 92:return'"';case 93:return"]";case 94:return"^";case 95:if(e)return"_";break;case 96:return"`";case 123:return"{";case 124:return 124==this.peek()?(this.skip(),"||"):61==this.peek()?(this.skip(),"|="):"|";case 125:return 125==this.peek()&&36==this.peek2()?(this.skip(),this.skip(),"}}$"):"}";case 126:return 62==this.peek()?(this.skip(),"~>"):61==this.peek()?(this.skip(),"~="):126==this.peek()?(this.skip(),"~~"):"~";case 170:return""}if(this.unget(),this.parseAlphaNumeric(this.data))return this.keywords.hasOwnProperty(this.data.value)?this.keywords[this.data.value]:r.values.hasOwnProperty(this.data.value)?(this.data.value=r.values[this.data.value],"BOOLEAN"):"OBSERVABLE";throw this.skip(),new Error("Invalid Token: "+s)},i.prototype.toString=function(){return void 0!==this.value?this.name+"("+this.value+")":this.name},i.prototype.type=function(){return o.tokenType(this.name)},s.Stream=o,s.SyntaxData=n,s.Token=i,s.tokenise=function(t,e){for(var s=[],r=new o(t,e);r.valid();)r.data.value=void 0,s.push(new i(r.readToken(),r.data.value));return s}},{"@construit/language":57}],59:[function(t,e,s){const i=t("./parser.js"),r=t("@construit/ast").Declarations;i.prototype.pPARAMS=function(){var t=new r;for(t.kind="oracle";"para"==this.token||"oracle"==this.token;){this.next();var e=this.pOLIST();if(t.list.push.apply(t.list,e),0==e.length||"NONAME"==e[e.length-1])return t.errors.push(new i.SyntaxError(this,i.SyntaxError.PARAMNAME)),t;if(";"!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.PARAMSEMICOLON)),t;this.next()}return t},i.prototype.pLOCALS=function(){for(var t=new r;"auto"==this.token||"local"==this.token;){this.next();var e=this.pOLIST();if(t.list.push.apply(t.list,e),0==e.length||"NONAME"==e[e.length-1])return t.errors.push(new i.SyntaxError(this,i.SyntaxError.LOCALNAME)),t;if(";"!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.LOCALSEMICOLON)),t;this.next()}return t}},{"./parser.js":71,"@construit/ast":35}],60:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pDELETE=function(){var t=new r.Delete;if("`"==this.token);else{if("OBSERVABLE"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),t;t.setObservable(this.data.value),this.next()}return t}},{"../js/parser.js":71,"@construit/ast":35}],61:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pDO=function(){var t=new r.Do,e=this.parent;this.parent=t;var s=this.allowBreak;return this.allowBreak=!0,t.setStatement(this.pSTATEMENT()),this.allowBreak=s,void 0===t.statement?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHILENOSTATEMENT)),this.parent=e,t):"while"!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),this.parent=e,t):(this.next(),"("!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHILEOPEN)),this.parent=e,t):(this.next(),t.setCondition(this.pEXPRESSION()),t.errors.length>0?(this.parent=e,t):")"!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHILECLOSE)),this.parent=e,t):(this.next(),this.parent=e,t)))}},{"../js/parser.js":71,"@construit/ast":35}],62:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pEXPRESSION_PPPPP=function(){if("#"==this.token)return this.next(),new r.Length},i.prototype.pEXPRESSION_PPPPPP=function(){if("?"==this.token)return this.next(),(t=new r.TernaryOp("?")).setFirst(this.pEXPRESSION()),t.warning=new i.SyntaxWarning(this,t,i.SyntaxWarning.DEPRECATED,"use of ? for 'if'."),t.errors.length>0?t:":"!=this.token?(t.error(new i.SyntaxError(this,i.SyntaxError.TERNIFCOLON)),t):(this.next(),t.setSecond(this.pEXPRESSION()),t);if("if"==this.token){this.next();var t=new r.TernaryOp("?");return t.setCondition(this.pEXPRESSION()),t.errors.length>0?t:"else"!=this.token?(t.error(new i.SyntaxError(this,i.SyntaxError.TERNIFCOLON)),t):(this.next(),t.setSecond(this.pEXPRESSION()),t)}},i.prototype.pEXPRESSION_PLAIN=function(){for(var t=this.pTERM();"&&"==this.token||"||"==this.token||"&"==this.token||"|"==this.token||"and"==this.token||"or"==this.token;){var e=new r.BinaryOp(this.token);this.next(),e.left(t),e.setRight(this.pTERM()),t=e}return t},i.prototype.pEXPRESSION=function(){var t,e=this.inExpression;if(this.inExpression=!0,"{"==this.token){if(this.next(),t=this.pSTRUCTURE(),"}"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),t;this.next(),t=this.pEXTRAS(t)}else t=this.pEXPRESSION_PLAIN();if("with"==this.token||"::"==this.token){this.next();var s=this.pSCOPE();return s.setExpression(t),this.inExpression=e,s}return this.inExpression=e,t}},{"../js/parser.js":71,"@construit/ast":35}],63:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pEXTRAS=function(t){if("["==this.token||"."==this.token){var e=this.pINDEXED();return e.setExpression(t),"("==this.token?r=this.pEXTRAS(e):e}if("("==this.token){if(this.next(),")"==this.token)return this.next(),t;var s=this.pSCOPE();if(s.setExpression(t),")"!=this.token)return s.error(new i.SyntaxError(this,i.SyntaxError.SCOPECLOSE)),s;this.next();var r=this.pEXTRAS(s);return r}return t},i.prototype.pFACTOR=function(){if("("==this.token){this.next();var t=this.pEXPRESSION();return t.errors.length>0?t:(")"!=this.token?t.error(new i.SyntaxError(this,i.SyntaxError.EXPCLOSEBRACKET)):this.next(),f=this.pEXTRAS(t))}if("["==this.token){this.next();var e=[];"]"!=this.token&&(e=this.pELIST());for(var s=new r.Literal("LIST",e),n=0;n<e.length;n++)e[n].errors.length>0&&s.errors.push.apply(s.errors,e[n].errors);return s.errors.length>0?s:("]"!=this.token?s.error(new i.SyntaxError(this,i.SyntaxError.LISTLITCLOSE)):this.next(),s)}if("@"==this.token)return this.next(),new r.Literal("UNDEFINED","@");if("JAVASCRIPT"==this.token){l=new r.Literal("JAVASCRIPT",this.data.value);return this.next(),l}if("NUMBER"==this.token){l=new r.Literal("NUMBER",this.data.value);return this.next(),l}if("`"==this.token){this.next();var o=this.pQUERY();return"`"!=this.token?(o.error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),o):(this.next(),f=this.pEXTRAS(o))}if("-"==this.token)return this.next(),new r.UnaryOp("-",this.pFACTOR());if("<<"==this.token){if(this.next(),"OBSERVABLE"!=this.token)return(l=new r.Literal("STRING",this.data.value)).error(new i.SyntaxError(this,i.SyntaxError.HEREDOCTOKEN)),l;var a=this.data.value;if(10!=this.stream.get())return(l=new r.Literal("STRING",this.data.value)).error(new i.SyntaxError(this,i.SyntaxError.HEREDOCTOKEN)),l;for(var h="";this.stream.valid();){var p=this.stream.position,c=this.stream.readLine();if(c.startsWith(a)){this.stream.position=p+3;break}h+=c}l=new r.Literal("STRING",h.slice(0,-1).replace(/\\/g,"\\\\").replace(/"/g,'\\"'));return this.stream.valid()||l.error(new i.SyntaxError(this,i.SyntaxError.NEWLINE)),this.next(),l}if("STRING"==this.token){l=new r.Literal("STRING",this.data.value);for(this.data.error||this.next();0==this.data.error&&"STRING"==this.token;)l.value+="\n"+this.data.value,this.next();return this.data.error&&("LINEBREAK"==this.data.value?l.error(new i.SyntaxError(this,i.SyntaxError.LITSTRLINE)):l.error(new i.SyntaxError(this,i.SyntaxError.LITSTRCLOSE))),l}if("BOOLEAN"==this.token){l=new r.Literal("BOOLEAN",this.data.value);return this.next(),l}if("CHARACTER"==this.token){var l=new r.Literal("CHARACTER",this.data.value);return this.data.error?(""==this.data.value?l.error(new i.SyntaxError(this,i.SyntaxError.LITCHAREMPTY)):l.error(new i.SyntaxError(this,i.SyntaxError.LITCHARCLOSE)),l):(this.next(),l)}if("!"==this.token||"not"==this.token){this.next();m=this.pFACTOR();return new r.UnaryOp("!",m)}if("&"==this.token){this.next();u=this.pLVALUE();return new r.UnaryOp("&",u)}if("*"==this.token){this.next();var u=this.pFACTOR();return new r.UnaryOp("*",u)}if("function"==this.token){if(this.next(),"{"!=this.token){var d=new r.Function;return d.error(new i.SyntaxError(this,i.SyntaxError.ACTIONOPEN)),d}this.next();var m=this.pFUNCTION();if("}"!=this.token)return m.error(new i.SyntaxError(this,i.SyntaxError.ACTIONCLOSE)),m;this.next();var f=this.pEXTRAS(m);return f}if("OBSERVABLE"==this.token||"`"==this.token){var x=this.pPRIMARY();return x=this.pEXTRAS(x)}var g=new r.Primary;return g.error(new i.SyntaxError(this,i.SyntaxError.BADFACTOR)),g}},{"../js/parser.js":71,"@construit/ast":35}],64:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pFOR=function(){var t=new r.For,e=this.parent;if(this.parent=t,"("!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.FOROPEN)),this.parent=e,t;if(this.next(),";"==this.token)this.next();else{if(t.setStart(this.pSTATEMENT_P(!0)),t.errors.length>0)return this.parent=e,t;if("range"!=t.sstart.type&&";"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.FORSTART)),this.parent=e,t;";"==this.token&&this.next()}if(t.sstart&&"range"==t.sstart.type){if(")"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.FORCLOSE)),this.parent=e,t;this.next()}else{if(";"==this.token)this.next();else{if(t.setCondition(this.pEXPRESSION()),t.errors.length>0)return this.parent=e,t;if(";"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.FORCOND)),this.parent=e,t;this.next()}if(")"==this.token)this.next();else{if(t.setIncrement(this.pSTATEMENT_P()),t.errors.length>0)return this.parent=e,t;if(")"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.FORCLOSE)),this.parent=e,t;this.next()}}var s=this.allowBreak;return this.allowBreak=!0,t.setStatement(this.pSTATEMENT()),this.allowBreak=s,t.statement&&(t.statement.parent=t),t.parent=e,this.parent=e,t}},{"../js/parser.js":71,"@construit/ast":35}],65:[function(t,e,s){function i(t){if(!t)return!1;switch(t.type){case"if":return i(t.statement)&&(!t.elsestatement||i(t.elsestatement));case"return":return!0;case"block":return i(t.statements[t.statements.length-1]);default:return!1}}const r=t("../js/parser.js"),n=t("@construit/ast");r.prototype.pNAMEDFUNCTION=function(){var t;if("OBSERVABLE"!=this.token)return(e=new n.Function).error(new r.SyntaxError(this,r.SyntaxError.ACTIONNAME)),e;if(t=this.data.value,this.next(),"{"!=this.token)return(e=new n.Function).error(new r.SyntaxError(this,r.SyntaxError.ACTIONOPEN)),e;this.next();var e=new n.Definition;e.setExpression(this.pFUNCTION());var s=new n.LValue;return s.setObservable(t),e.setLValue(s),e.errors.length>0?e:"}"!=this.token?(e.error(new r.SyntaxError(this,r.SyntaxError.ACTIONCLOSE)),e):(this.next(),e)},r.prototype.pFUNCTION=function(){var t=new n.Function;t.parent=this.parent;for(this.parent;"EOF"!=this.token;){var e=this.pSTATEMENT();if(void 0!==e){if(t.appendChild(e),e.errors.length>0)break}else{if("}"!=this.token&&";"!=this.token&&t.error(new r.SyntaxError(this,r.SyntaxError.STATEMENT)),";"!=this.token)break;this.next()}}return i(t.statements[t.statements.length-1])||t.error(new r.SyntaxError(this,r.SyntaxError.UNKNOWN)),t}},{"../js/parser.js":71,"@construit/ast":35}],66:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pIF=function(){var t=new r.If;t.parent=this.parent;var e=this.parent;return this.parent=t,"("!=this.token?(t.error(new i.SyntaxError(this,i.SyntaxError.IFCONDOPEN)),this.parent=e,t):(this.next(),t.setCondition(this.pEXPRESSION()),t.errors.length>0?(this.parent=e,t):")"!=this.token?(t.error(new i.SyntaxError(this,i.SyntaxError.IFCONDCLOSE)),this.parent=e,t):(this.next(),t.setStatement(this.pSTATEMENT()),t.errors.length>0?(this.parent=e,t):void 0===t.statement?(t.error(new i.SyntaxError(this,i.SyntaxError.IFNOSTATEMENT)),this.parent=e,t):(t.setElse(this.pIF_P()),this.parent=e,t)))},i.prototype.pIF_P=function(){if("else"==this.token){this.next();var t=this.pSTATEMENT();return void 0===t&&(t=new r.DummyStatement).error(new i.SyntaxError(this,i.SyntaxError.IFNOSTATEMENT)),t}}},{"../js/parser.js":71,"@construit/ast":35}],67:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pINDEXED=function(){for(var t=new r.Indexed;this.stream.valid()&&("["==this.token||"."==this.token);)if("["==this.token){this.next();var e=new r.Index;if("]"==this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.LISTINDEXEXP)),t;var s=this.pEXPRESSION();if(s.errors.length>0)return e.setExpression(s),t.addIndex(e),t;if("literal"==s.type&&"NUMBER"==s.datatype&&s.value<1)return t.error(new i.SyntaxError(this,i.SyntaxError.OUTOFBOUNDS)),t;if("]"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.LISTINDEXCLOSE)),t;this.next(),e.setExpression(s),t.addIndex(e)}else{if(this.next(),"OBSERVABLE"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.LISTINDEXEXP)),t;(e=new r.Index).setExpression(new r.Literal("STRING",this.data.value)),t.addIndex(e),this.next()}return t}},{"../js/parser.js":71,"@construit/ast":35}],68:[function(t,e,s){const i=t("../js/parser.js");i.prototype.pELIST=function(){var t=this.pEXPRESSION();if(t.errors.length>0)return[t];var e=this.pELIST_P();return e.unshift(t),e},i.prototype.pELIST_P=function(){for(var t=[];","==this.token;){this.next();var e=this.pEXPRESSION();if(t.push(e),e.errors.length>0)return t}return t},i.prototype.pOLIST=function(){if("OBSERVABLE"!=this.token)return[];var t=this.data.value;this.next();var e=this.pOLIST_P();return e.unshift(t),e},i.prototype.pOLIST_P=function(){for(var t=[];","==this.token;){if(this.next(),"OBSERVABLE"!=this.token)return t.push("NONAME"),t;t.push(this.data.value),this.next()}return t}},{"../js/parser.js":71}],69:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pLVALUE_P=function(){for(var t=[];;){if("["!=this.token)break;this.next();var e=new r.Index,s=this.pEXPRESSION();if(e.setExpression(s),t.push(e),s.errors.length>0&&e.error(new i.SyntaxError(this,i.SyntaxError.LISTINDEXEXP)),"literal"==s.type&&"NUMBER"==s.datatype&&s.value<1&&e.error(new i.SyntaxError(this,i.SyntaxError.OUTOFBOUNDS)),"]"!=this.token)return e.error(new i.SyntaxError(this,i.SyntaxError.LISTINDEXCLOSE)),t;this.next()}return t},i.prototype.pLVALUE=function(){var t=new r.LValue;if("*"==this.token)this.next(),t.setPrimary(this.pPRIMARY());else if("`"==this.token){if(this.next(),t.setExpression(this.pEXPRESSION()),t.errors.length>0)return t;if("`"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.BACKTICK)),t;this.next()}else{if("OBSERVABLE"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.LVALUE)),t;var e=this.data.value;if(this.next(),"{"==this.token){for(var s=new r.Literal("STRING",e);"{"==this.token;){this.next();var n=this.pEXPRESSION();if(n.errors.length>0)return t.setExpression(n),t;if("}"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.BACKTICK)),t;this.next();var o=new r.BinaryOp("//");o.left(s),o.setRight(n),s=o,"OBSERVABLE"==this.token&&((o=new r.BinaryOp("//")).left(s),o.setRight(new r.Literal("STRING",this.data.value)),s=o,this.next())}t.setExpression(s)}else t.setObservable(e)}return t.setExtras(this.pLVALUE_P()),t}},{"../js/parser.js":71,"@construit/ast":35}],70:[function(t,e,s){const i=t("./parser.js"),r=t("@construit/ast");t("./declarations.js"),t("./do.js"),t("./expression.js"),t("./factor.js"),t("./for.js"),t("./function.js"),t("./if.js"),t("./use.js"),t("./indexed.js"),t("./delete.js"),t("./lists.js"),t("./lvalue.js"),t("./scope.js"),t("./primary.js"),t("./query.js"),t("./script.js"),t("./section.js"),t("./selector.js"),t("./structure.js"),t("./statement.js"),t("./switch.js"),t("./terms.js"),t("./wait.js"),t("./when.js"),t("./while.js"),s.SyntaxError=i.SyntaxError,s.SyntaxWarning=i.SyntaxWarning,s.parse=function(t,e){return new i(t,e||{}).script},s.Parser=i,s.parseStatement=function(t,e){var s=new i(t,e||{},{noparse:!0,noindex:!0});s.next();var r=s.pSTATEMENT();r.base=s,r.setSource(0,t.length,t),r.stamp=s.stamp;var n=t.match("\n");return r.numlines=null===n?0:n.length,r},s.parseScript=function(t,e){return new i(code,e||{}).script},s.parseExpression=function(t){var e=new i(t,{},{noparse:!0,noindex:!0});return e.next(),e.pEXPRESSION()},s.htmlify=r.htmlify},{"./declarations.js":59,"./delete.js":60,"./do.js":61,"./expression.js":62,"./factor.js":63,"./for.js":64,"./function.js":65,"./if.js":66,"./indexed.js":67,"./lists.js":68,"./lvalue.js":69,"./parser.js":71,"./primary.js":72,"./query.js":73,"./scope.js":74,"./script.js":75,"./section.js":76,"./selector.js":77,"./statement.js":78,"./structure.js":79,"./switch.js":80,"./terms.js":83,"./use.js":84,"./wait.js":85,"./when.js":86,"./while.js":87,"@construit/ast":35}],71:[function(t,e,s){function i(t,e,s){this.stream=void 0!==t?new r.Stream(t):void 0,this.data=new r.SyntaxData,this.token="INVALID",this.previous="INVALID",this.src="input",this.parent=void 0,this.scripts={},this.definitions={},this.origin=e,this.lastposition=0,this.lastline=0,this.errors=[],this.warnings=[],this.whens=[],this.options=s||{},this.lastresult=void 0,this.depth=0,this.allowBreak=!1,this.inWhen=!1,this.inExpression=!1,this.inFence=!1,e||console.error("NO ORIGIN",t),this.lastDoxyComment=[],this.mainDoxyComment=void 0,this.parentDoxy=void 0,this.lastStatement=void 0,this.lastStatementEndline=-1,this.stream&&(this.stream.data=this.data),this.stamp=Date.now(),s&&s.noparse||(this.next(),this.script=this.pSCRIPT(),this.script.base=this,this.script.name=e.name,e.id&&(this.script.id=e.id),this.script.setSource(0,t.length,t),this.script.setDoxyComment(this.doxyFromOrigin()),this.options&&this.options.noindex?0==this.script.id&&this.script.buildID():this.script.addIndex(),0==this.errors.length?this.errors=this.script.errors:this.errors.push.apply(this.errors,this.script.errors))}const r=t("@construit/lexer"),n=t("@construit/ast");i.prototype.doxyFromOrigin=function(){var t=this.origin.name;if(this.origin.title&&(t+="\n * @title "+this.origin.title),this.origin.author&&(t+="\n * @author "+this.origin.author),this.origin.id&&(t+="\n * @id "+this.origin.id),this.origin.saveID&&(t+="\n * @version "+this.origin.vid),this.origin.tags&&this.origin.tags.length>0){t+="\n *";for(var e=0;e<this.origin.tags.length;e++)t+=" #"+this.origin.tags[e]}return new n.DoxyComment(t)},i.prototype.next=function(){this.previous=this.token,this.lastposition=this.stream.position,this.lastline=this.stream.line;this.stream.indent;this.token=this.stream.readToken();for(var t=this.stream.prevline;;)if("/*"==this.token){var e=1,s=!1,r=this.stream.position-2,o=this.stream.line;for(42==this.stream.peek()&&(s=!0);this.stream.valid()&&("*/"!=this.token||e>0);)this.token=this.stream.readToken(),"/*"==this.token?e++:"*/"==this.token&&e--;if("*/"!=this.token){var a=new i.SyntaxError(this,i.SyntaxError.BLOCKCOMMENT);a.line=o,this.errors.push(a)}if(s){var h=new n.DoxyComment(this.stream.code.substring(r+3,this.stream.position-2).trim(),o,this.stream.line);this.lastDoxyComment.push(h),h.parent=this.parentDoxy,h.content.endsWith("@{")?this.parentDoxy=h:h.content.startsWith("@}")&&this.parentDoxy&&(this.parentDoxy=this.parentDoxy.parent)}this.token=this.stream.readToken()}else{if("${{"!=this.token)break;var r=this.stream.position,o=this.stream.line;for(this.data.line=o;this.stream.valid()&&"}}$"!=this.token;)this.token=this.stream.readToken();this.data.value=this.stream.code.substring(r,this.stream.position-3),this.token="JAVASCRIPT",this.stream.prevposition=r-3}this.stream.prevline=t},i.prototype.peekNext=function(t){var e,s={value:""};for(this.stream.data=s,this.stream.pushPosition();t>0;)e=this.stream.readToken(),t--;return this.stream.popPosition(),this.stream.data=this.data,e},i.SyntaxError=t("./syntaxerrors.js"),i.SyntaxWarning=t("./syntaxwarnings.js"),e.exports=i},{"./syntaxerrors.js":81,"./syntaxwarnings.js":82,"@construit/ast":35,"@construit/lexer":58}],72:[function(t,e,s){const i=t("./parser.js"),r=t("@construit/ast");i.prototype.pPRIMARY=function(){if("OBSERVABLE"==this.token){var t,e=this.data.value;if(this.next(),"{"==this.token){for(var s=new r.Literal("STRING",e);"{"==this.token;){this.next();var n=this.pEXPRESSION();if(n.errors.length>0)return(t=new r.Primary).setBackticks(n),t;if("}"!=this.token)return(t=new r.Primary).error(new i.SyntaxError(this,i.SyntaxError.BACKTICK)),t;this.next();var o=new r.BinaryOp("//");o.left(s),o.setRight(n),s=o,"OBSERVABLE"==this.token&&((o=new r.BinaryOp("//")).left(s),o.setRight(new r.Literal("STRING",this.data.value)),s=o,this.next())}(t=new r.Primary).setBackticks(s),t.setObservable("__BACKTICKS__")}else(t=new r.Primary).setObservable(e);return t}return(t=new r.Primary).error(new i.SyntaxError(this,i.SyntaxError.BADFACTOR)),t}},{"./parser.js":71,"@construit/ast":35}],73:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pQUERY=function(){var t=new r.Query,e=[];if(t.setSelector(this.pCODESELECTOR()),"["==this.token){for(this.next();this.stream.valid()&&"]"!=this.token&&(e.push(this.data.value),this.next(),"]"!=this.token);){if(","!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.QUERYSELECTCOMMA)),t;this.next()}if("]"!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.QUERYSELECTCLOSE)),t;this.next()}return 0==e.length&&e.push("value"),t.setResultTypes(e),t}},{"../js/parser.js":71,"@construit/ast":35}],74:[function(t,e,s){const i=t("./parser.js"),r=t("@construit/ast");i.prototype.pSCOPE=function(){if("("==this.token){this.next();var t=this.pSCOPE_P();return")"!=this.token?(t.error(new i.SyntaxError(this,i.SyntaxError.SCOPECLOSE)),t):(this.next(),t)}return this.pSCOPE_P()},i.prototype.pPROCSCOPE=function(){if("("==this.token){this.next();var t=this.pPROCSCOPE_P();return")"!=this.token?(t.error(new i.SyntaxError(this,i.SyntaxError.SCOPECLOSE)),t):(this.next(),t)}return this.pPROCSCOPE_P()},i.prototype.pPROCSCOPE_P=function(t){var e,s=this.peekNext(1);if(void 0===t&&(t=1),")"==this.token)return new r.ProcedureScope;if("is"!=s&&"="!=s&&"in"!=s)(e=new r.ScopePattern).setObservable("$"+t),t++,s="=";else{if(e=new r.ScopePattern,"OBSERVABLE"!=this.token)return e.error(new i.SyntaxError(this,i.SyntaxError.SCOPENAME)),e;if(e.setObservable(this.data.value),this.next(),e.errors.length>0)return(h=new r.ProcedureScope).addOverride(e,void 0,void 0,void 0,!1),h;if("is"!=this.token&&"="!=this.token&&"in"!=this.token)return(h=new r.ProcedureScope).error(new i.SyntaxError(this,i.SyntaxError.SCOPEEQUALS)),h;this.next()}var n=this.pEXPRESSION();if(n.errors.length>0)return(h=new r.ProcedureScope).errors.push.apply(h.errors,n.errors),h;var o=void 0;if(".."==this.token&&(this.next(),(o=this.pEXPRESSION()).errors.length>0))return(h=new r.ProcedureScope).addOverride(e,n,o,void 0,s),h;var a=void 0;if(".."==this.token&&(this.next(),(a=this.pEXPRESSION()).errors.length>0))return(h=new r.ProcedureScope).addOverride(e,n,o,a,s),h;var h=this.pPROCSCOPE_PP(t);return h.addOverride(e,n,o,a,s),h},i.prototype.pPROCSCOPE_PP=function(t){return","==this.token?(this.next(),this.pPROCSCOPE_P(t)):new r.ProcedureScope},i.prototype.pSCOPE_P=function(t){var e,s=this.peekNext(1);if(void 0===t&&(t=1),"is"!=s&&"="!=s&&"in"!=s)(e=new r.ScopePattern).setObservable("$"+t),s="=",t++;else{if(e=new r.ScopePattern,"OBSERVABLE"!=this.token)return e.error(new i.SyntaxError(this,i.SyntaxError.SCOPENAME)),e;if(e.setObservable(this.data.value),this.next(),e.errors.length>0)return(h=new r.ExpressionScope).addOverride(e,void 0,void 0,void 0,s),h;if("is"!=this.token&&"="!=this.token&&"in"!=this.token)return(h=new r.ExpressionScope).error(new i.SyntaxError(this,i.SyntaxError.SCOPEEQUALS)),h;"in"==this.token&&!0,this.next()}var n=this.pEXPRESSION();if(n.errors.length>0)return(h=new r.ExpressionScope).errors.push.apply(h.errors,n.errors),h;var o=void 0;if(".."==this.token){if("in"!=s)return(h=new r.ExpressionScope).error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),h;if(this.next(),(o=this.pEXPRESSION()).errors.length>0)return(h=new r.ExpressionScope).addOverride(e,n,o,void 0,s),h}var a=void 0;if(".."==this.token&&(this.next(),(a=this.pEXPRESSION()).errors.length>0))return(h=new r.ExpressionScope).addOverride(e,n,o,a,s),h;var h=this.pSCOPE_PP(t);return h.addOverride(e,n,o,a,s),h},i.prototype.pSCOPE_PP=function(t){return","==this.token?(this.next(),this.pSCOPE_P(t)):new r.ExpressionScope}},{"./parser.js":71,"@construit/ast":35}],75:[function(t,e,s){const i=t("./parser.js"),r=t("@construit/ast");i.prototype.pSCRIPT=function(){var t=new r.Block;t.parent=this.parent;var e=this.parent;this.parent=t;var s=new r.DummyStatement;for(s.setSource(this.lastposition,this.stream.prevposition,this.stream.code.substring(this.lastposition,this.stream.prevposition)),s.numlines=s.source.match(/\n/g),null===s.numlines?s.numlines=0:s.numlines=s.numlines.length,t.appendChild(s);"EOF"!=this.token;){var n=this.pSTATEMENT();if(void 0!==n){if(n.errors.length>0){t.appendChild(n);break}var o=n.end;t.appendChild(n);var a=this.stream.code.substring(o,this.stream.prevposition);a.length>0&&((s=new r.DummyStatement).setSource(o,this.stream.prevposition,a),s.numlines=s.source.match(/\n/g),null===s.numlines?s.numlines=0:s.numlines=s.numlines.length,t.appendChild(s))}else{if("}"!=this.token&&";"!=this.token&&t.errors.push(new i.SyntaxError(this,i.SyntaxError.STATEMENT)),";"!=this.token)break;this.next()}}return this.parent=e,t}},{"./parser.js":71,"@construit/ast":35}],76:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pSECTION=function(){for(var t=1;35==this.stream.peek();)t++,this.stream.skip();var e=this.stream.readLine().trim();return this.stream.valid()?(this.stream.position--,this.stream.line--):this.errors.push(new i.SyntaxError(this,i.SyntaxError.NEWLINE)),this.next(),stat=new r.Section,stat.setName(e),stat.depth=t,stat}},{"../js/parser.js":71,"@construit/ast":35}],77:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast"),n=t("@construit/language");i.prototype.pCODESELECTOR=function(){var t=void 0;if("OBSERVABLE"==this.token||n.keywords[this.token]&&"with"!=this.token)t=new r.Literal("STRING",this.data.value),this.next();else if(":"==this.token||"."==this.token){var e=":"==this.token;if(this.next(),"OBSERVABLE"==this.token){if(!(!e&&n.selectorAttributes[this.data.value]||e&&n.selectorPseudo[this.data.value]))return(t=new r.Literal("STRING","")).errors.push(new i.SyntaxError(this,i.SyntaxError.SELECTORATTRIB)),t;t=new r.Literal("STRING",(e?":":".")+this.data.value),this.next()}else if("NUMBER"==this.token)t=new r.Literal("STRING",(e?":":".")+this.data.value),this.next();else if("{"==this.token)t=new r.Literal("STRING",e?":":".");else{if("("!=this.token)return(t=new r.Literal("STRING","")).errors.push(new i.SyntaxError(this,i.SyntaxError.SELECTORATTRIB)),t;a=this.stream.position;for(this.next();this.stream.valid()&&")"!=this.token;)this.next();var s=this.stream.prevposition,o=":("+this.stream.code.substring(a,s).replace(/[\r\n]*/g,"")+")";t=new r.Literal("STRING",o),this.next()}}else if("@"==this.token){if(this.next(),"OBSERVABLE"!=this.token)return(t=new r.Literal("STRING","")).errors.push(new i.SyntaxError(this,i.SyntaxError.SELECTOROPTION)),t;if(!n.selectorOptions[this.data.value])return(t=new r.Literal("STRING","")).errors.push(new i.SyntaxError(this,i.SyntaxError.SELECTOROPTION)),t;t=new r.Literal("STRING","@"+this.data.value+" "),this.next()}else if("#"==this.token)if(this.next(),"OBSERVABLE"==this.token)t=new r.Literal("STRING","#"+this.data.value),this.next();else{if("{"!=this.token)return(t=new r.Literal("STRING","")).errors.push(new i.SyntaxError(this,i.SyntaxError.SELECTORTAG)),t;t=new r.Literal("STRING","#")}else if("{"==this.token){if(this.next(),t=this.pEXPRESSION(),"}"!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.SELECTORBTICK)),t;this.next()}else if(">"==this.token)t=new r.Literal("STRING"," > "),this.next();else if(">>"==this.token)t=new r.Literal("STRING"," >> "),this.next();else if("<"==this.token)t=new r.Literal("STRING"," < "),this.next();else if(","==this.token)t=new r.Literal("STRING",","),this.next();else if("<<"==this.token)t=new r.Literal("STRING"," << "),this.next();else if("("==this.token){var a=this.stream.position;for(this.next();this.stream.valid()&&")"!=this.token;)this.next();var s=this.stream.prevposition,o="("+this.stream.code.substring(a,s).replace(/[\r\n]*/g,"")+")";t=new r.Literal("STRING",o),this.next()}else{if(")"==this.token)return;"*"==this.token&&(t=new r.Literal("STRING","*"),this.next())}if(t){var h=this.pCODESELECTOR();if(void 0===h)return t;if(h.errors.length>0)return h;if("literal"==t.type&&"literal"==h.type)t.value+=h.value;else{var p=new r.BinaryOp("//");p.left(t),p.setRight(h),t=p}}return t}},{"../js/parser.js":71,"@construit/ast":35,"@construit/language":57}],78:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pSTATEMENT_PP=function(t){if("is"==this.token){this.next();var e=new r.Definition;if(this.inWhen)return e.error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),e;var s=this.parent;this.parent=e;var n=this.pEXPRESSION();return e.setExpression(n),this.parent=s,e}if("in"==this.token){if(this.next(),!t)return(o=new r.Range).error(new i.SyntaxError(this,i.SyntaxError.RANGEBANNED)),o;var o=new r.Range(this.pEXPRESSION());return".."==this.token&&(this.next(),o.setSecond(this.pEXPRESSION())),o}if("="==this.token){this.next();var a=new r.Assignment;return a.setExpression(this.pEXPRESSION()),a}if("+="==this.token)return this.next(),new r.Modify("+=",this.pEXPRESSION());if("-="==this.token)return this.next(),new r.Modify("-=",this.pEXPRESSION());if("/="==this.token)return this.next(),new r.Modify("/=",this.pEXPRESSION());if("*="==this.token)return this.next(),new r.Modify("*=",this.pEXPRESSION());if("++"==this.token)return this.next(),new r.Modify("++",void 0);if("--"==this.token)return this.next(),new r.Modify("--",void 0);if("with"==this.token)return this.next(),this.pPROCSCOPE();if("("==this.token){this.next();var h=this.pPROCSCOPE();return")"!=this.token?(h.error(new i.SyntaxError(this,i.SyntaxError.SCOPECLOSE)),h):(this.next(),h)}var p=[];p.push(new i.SyntaxError(this,i.SyntaxError.DEFINITION));var c=new r.Assignment(void 0);return c.error(p[0]),c},i.prototype.pSTATEMENT_P=function(t){var e=this.pLVALUE();if(e.errors.length>0)return e;var s=this.pSTATEMENT_PP(t);return s.left(e),s.errors.length,s},i.prototype.pSTATEMENT=function(t){var e=this.stream.prevposition,s=this.stream.line-1,n=-1,o=void 0,a=-1,h=this.lastDoxyComment.length>0?this.lastDoxyComment.pop():void 0;if(0==this.lastDoxyComment.length&&this.parentDoxy&&this.lastDoxyComment.push(this.parentDoxy),this.inExpression)switch(this.token){case"use":case"function":case"when":case"wait":case"delete":case"action":return(o=new r.DummyStatement).error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),o}if(this.inWhen)switch(this.token){case"use":case"function":case"when":case"delete":case"action":return(o=new r.DummyStatement).error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),o}switch(this.token){case"function":this.next(),o=this.pNAMEDFUNCTION();break;case"when":this.next(),o=this.pWHEN();break;case"for":this.next(),o=this.pFOR();break;case"while":this.next(),o=this.pWHILE();break;case"do":this.next(),o=this.pDO();break;case"wait":this.next(),o=this.pWAIT();break;case"switch":this.next(),o=this.pSWITCH();break;case"case":this.next(),o=this.pCASE();break;case"delete":this.next(),o=this.pDELETE();break;case"use":this.next(),o=this.pUSE();break;case"para":o=this.pPARAMS();break;case"local":case"var":case"auto":o=this.pLOCALS();break;case"default":this.next();var p=new r.Default;":"!=this.token?p.error(new i.SyntaxError(this,i.SyntaxError.DEFAULTCOLON)):this.next(),o=p;break;case"if":this.next(),o=this.pIF();break;case"#":var c=this.stream.position+1,l=this.stream.line,u=33==this.stream.peek();do{if(this.stream.skipLine(),!this.stream.valid())return(o=new r.DummyStatement).error(new i.SyntaxError(this,i.SyntaxError.NEWLINE)),o;this.stream.skip(),this.stream.line++}while(35==this.stream.peek()&&35!=this.stream.peek2());if(u){var d=new r.DoxyComment(this.stream.code.substring(c,this.stream.position-1).trim(),l,this.stream.line);d.parent=this.parentDoxy,d.content.endsWith("@{")?this.parentDoxy=d:d.content.startsWith("@}")&&this.parentDoxy&&(this.parentDoxy=this.parentDoxy.parent),!this.lastStatement||void 0!==this.lastStatement.doxyComment||this.lastStatEndline!=l-1&&this.lastStatEndline!=l?this.lastDoxyComment.push(d):this.lastStatement.setDoxyComment(d)}this.next(),o=new r.DummyStatement;break;case"##":o=this.pSECTION(),this.lastDoxyComment.length>0&&this.lastline==this.lastDoxyComment[0].startline-1&&o.setDoxyComment(this.lastDoxyComment.shift());break;case"return":this.next();var m=new r.Return;if(";"==this.token){this.next(),o=m;break}if(m.setExpression(this.pEXPRESSION()),m.errors.length>0){o=m;break}";"!=this.token?m.errors.push(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)):this.next(),o=m;break;case"continue":this.next();var f=new r.Continue;if(this.allowBreak||f.error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),f.errors.length>0){o=f;break}";"!=this.token?f.error(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)):this.next(),o=f;break;case"break":this.next();var x=new r.Break;if(this.allowBreak||x.error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),x.errors.length>0){o=x;break}";"!=this.token?x.error(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)):this.next(),o=x;break;case"{":this.next();var g=this.pSCRIPT();if(g.hasErrors()){o=g;break}if("}"!=this.token){g.error(new i.SyntaxError(this,i.SyntaxError.ACTIONCLOSE)),o=g;break}this.next(),o=g;break;case"JAVASCRIPT":s=this.data.line-1;var y=this.data.value;this.next(),o=new r.Literal("JAVASCRIPT",y);break;case"?":this.next(),o=this.pQUERY(),";"!=this.token?o.error(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)):this.next();break;case"`":case"*":case"OBSERVABLE":var E=this.pLVALUE();if(E.errors.length>0){(o=new r.DummyStatement).lvalue=E,o.errors=E.errors;break}var v=this.pSTATEMENT_PP();if(v.left(E),v.errors.length>0){o=v;break}";"!=this.token?v.error(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)):this.next(),void 0===this.definitions[E.name]&&(this.definitions[E.name]=[]),this.definitions[E.name].push(v),o=v;break;default:return}return a=this.lastposition,n=this.lastline,o.parent=this.parent,null===o.doxyComment&&o.setDoxyComment(h),o.stamp=this.stamp,o.numlines=n-s-1,o.setSource(e,a,this.stream.code.substring(e,a)),"dummy"!=o.type&&(this.lastStatement=o,this.lastStatEndline=n),o}},{"../js/parser.js":71,"@construit/ast":35}],79:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pSTRUCTURE=function(){var t=new r.Structure;if("*"==this.token)return this.next(),t;if("}"==this.token)return t.elements={},t;for(;"EOF"!=this.token;){if("OBSERVABLE"!=this.token&&"NUMBER"!=this.token&&"STRING"!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),t;var e=this.data.value;if(this.next(),":"!=this.token){var s=new r.Primary;s.setObservable(e),t.addElement(e,s)}else{this.next();var n=this.pEXPRESSION();t.addElement(e,n)}if(","!=this.token)break;this.next()}return t}},{"../js/parser.js":71,"@construit/ast":35}],80:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pSWITCH=function(){var t=new r.Switch,e=this.parent;if(this.parent=t,"("!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.SWITCHOPEN)),this.parent=e,t;if(this.next(),t.setExpression(this.pEXPRESSION()),t.errors.length>0)return this.parent=e,t;if(")"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.SWITCHCLOSE)),this.parent=e,t;if(this.next(),"{"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.SWITCHSCRIPT)),this.parent=e,t;var s=this.allowBreak;return this.allowBreak=!0,t.setStatement(this.pSTATEMENT()),this.allowBreak=s,this.parent=e,t},i.prototype.pCASE=function(){var t=new r.Case;return"STRING"!=this.token&&"NUMBER"!=this.token?(t.error(new i.SyntaxError(this,i.SyntaxError.CASELITERAL)),t):(t.setLiteral(this.token,this.data.value),this.next(),":"!=this.token?(t.error(new i.SyntaxError(this,i.SyntaxError.CASECOLON)),t):(this.next(),t))}},{"../js/parser.js":71,"@construit/ast":35}],81:[function(t,e,s){function i(t,e,s){this.type="syntax",this.context=t,this.errno=e,this.extra=s,this.token=t.token,this.prevtoken=t.previous,this.line=t.stream.prevline,this.position=t.stream.position,this.prevposition=t.stream.prevposition,this.statement=null}const r=t("@construit/language"),n=t("@construit/lexer").Stream;i.UNKNOWN=0,i.EXPCLOSEBRACKET=1,i.BADFACTOR=2,i.ACTIONCOLON=3,i.ACTIONNOWATCH=4,i.ACTIONCOMMAS=5,i.ACTIONOPEN=6,i.ACTIONCLOSE=7,i.LOCALNAME=8,i.LOCALSEMICOLON=9,i.WHENTYPE=10,i.LISTINDEXEXP=11,i.LISTINDEXCLOSE=12,i.LVALUE=13,i.SEMICOLON=14,i.STATEMENT=15,i.DEFINITION=16,i.FUNCCALLEND=17,i.LISTLITCLOSE=18,i.TERNIFCOLON=19,i.IFCONDOPEN=20,i.IFCONDCLOSE=21,i.PARAMNAME=22,i.PARAMSEMICOLON=23,i.FUNCOPEN=24,i.FUNCCLOSE=25,i.FUNCNAME=26,i.FOROPEN=27,i.FORCLOSE=28,i.FORSTART=29,i.FORCOND=30,i.SUBSCRIBEOPEN=31,i.SUBSCRIBECLOSE=32,i.SWITCHOPEN=33,i.SWITCHCLOSE=34,i.DEFAULTCOLON=35,i.CASELITERAL=36,i.CASECOLON=37,i.INSERTCOMMA=38,i.DELETECOMMA=39,i.APPENDCOMMA=40,i.SCOPENAME=41,i.SCOPEEQUALS=42,i.SCOPECLOSE=43,i.BACKTICK=44,i.WHILEOPEN=45,i.WHILECLOSE=46,i.WHILENOSTATEMENT=47,i.NEGNUMBER=48,i.DEFINELISTIX=49,i.OUTOFBOUNDS=50,i.PROPERTYNAME=51,i.WHILEOFDO=52,i.PARAMNUMBER=53,i.AFTEROPEN=55,i.AFTERCLOSE=56,i.ACTIONNAME=57,i.WHENOPEN=58,i.WHENCLOSE=59,i.DONAME=60,i.PROCNAME=61,i.IMPORTPATH=62,i.IMPORTOPTION=63,i.IMPORTCOMB=64,i.IFNOSTATEMENT=65,i.AFTERNOSTATEMENT=66,i.WHENNOSTATEMENT=67,i.LITCHAREMPTY=68,i.LITCHARCLOSE=69,i.LITSTRLINE=70,i.LITSTRCLOSE=71,i.IMPORTTAG=72,i.SWITCHSCRIPT=73,i.RANGEBANNED=74,i.HEREDOCTOKEN=75,i.SELECTORACTION=76,i.SELECTORATTRIB=77,i.SELECTORTAG=78,i.SELECTORBTICK=79,i.SELECTOROPTION=80,i.QUERYOPEN=81,i.QUERYCLOSE=82,i.QUERYSELECTOPEN=83,i.QUERYSELECTCLOSE=84,i.QUERYSELECTCOMMA=85,i.BLOCKCOMMENT=86,i.NEWLINE=87,i.db=[{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return"}"==this.token||"]"==this.token?0:";"==this.token?1:2},suggestion:{expected:[")"],next:[";","+","-","==","<=",">=","!=","/","*","%","^"]}},{message:function(){if("{"==this.token)return 0;if("EOF"==this.token)return 2;if(")"==this.token)return"operator"==n.tokenType(this.prevtoken)?3:1;var t=n.tokenType(this.token);return"keyword"==t?4:"operator"==t?3:2},suggestion:{expected:["NUMBER","STRING","OBSERVABLE","&","!","("],next:["NUMBER","STRING","OBSERVABLE","&","!","(",";","+","-","==","<=",">=","!=","/","*","%","^"]}},{message:function(){return"{"==this.token?1:"OBSERVABLE"==this.token?0:"keyword"==n.tokenType(this.token)?3:2},suggestion:{expected:[":"],next:["OBSERVABLE"]}},{message:function(){if("{"==this.token)return 2;if("("==this.token)return 3;if("["==this.token&&(":"==this.prevtoken||","==this.prevtoken))return 6;if("NUMBER"==this.token||"STRING"==this.token)return 4;if(","==this.token)return 5;var t=n.tokenType(this.token);return"keyword"==t?0:1},suggestion:{expected:["OBSERVABLE"],next:[",","{"]}},{message:function(){return"{"==this.token?0:"("!=this.token||this.context.stream.isBEOL()?"keyword"==n.tokenType(this.token)?2:3:1},suggestion:{expected:["OBSERVABLE"],next:[",","{"]}},{message:function(){if(("("==this.token||"["==this.token)&&this.context.stream.isBEOL())return 6;if("("==this.token)return 0;if("["==this.token)return 1;if(";"==this.token)return 2;var t=n.tokenType(this.token);return"keyword"==t||"identifier"==t?3:"separator"==t?4:5},suggestion:{expected:["{"],next:["local","OBSERVABLE","if","for","switch","while","return"]}},{message:function(){return(")"==this.token||"]"==this.token)&&this.context.stream.isBEOL()?0:1},suggestion:{expected:["}"],next:["proc","func","if","for","OBSERVABLE","switch","while","return","continue","break"]}},{message:function(){return"keyword"==n.tokenType(this.token)?0:";"==this.token?1:2},suggestion:{expected:["OBSERVABLE"],next:[";"]}},{message:function(){return"is"==this.token||"="==this.token?1:0},suggestion:{expected:[";"],next:["local","OBSERVABLE","if","for","switch","while","return"]}},{message:function(){return 0},suggestion:{expected:["touch","change","("],next:["OBSERVABLE",":","NUMBER","STRING","!","&"]}},{message:function(){return 0},suggestion:{expected:["(","OBSERVABLE","NUMBER"],next:["]","OBSERVABLE","NUMBER","+","-","/","*","%","^"]}},{message:function(){return 1},suggestion:{expected:["]"],next:["[",".","=","+=","-=","==","+","-","/","*",";","/=","*=","%","^","is"]}},{message:function(){return 0},suggestion:{expected:["OBSERVABLE"],next:[".","[","is","=","+=","-=","++","--","*=","/="]}},{message:function(){if("."==this.token){var t=this.position>=2?this.context.stream.code.charCodeAt(this.position-2):0;return"NUMBER"==this.prevtoken&&32!=t&&160!=t?1:2}return"OBSERVABLE"==this.token?this.context.stream.isBEOL()?3:4:0},suggestion:{expected:[";"],next:["proc","when","OBSERVABLE","if","for","while","EOF","switch","func"]}},{message:function(){return 0},suggestion:{expected:["proc","func","when","if","for","while","switch","OBSERVABLE","{"],next:["OBSERVABLE","(","change","touch","is","=","+=","-=","*=","proc","func","when","if","for","while","switch"]}},{message:function(){return 0},suggestion:{expected:["=","is","+=","-=","/=","*="],next:["(","OBSERVABLE","NUMBER","STRING","!"]}},{message:function(){return 0},suggestion:{expected:[")"],next:[";","(","[","+","-","/","*","%","^"]}},{message:function(){return 0},suggestion:{expected:["]"],next:[]}},{message:function(){return 0},suggestion:{expected:[":"],next:[]}},{message:function(){return 0},suggestion:{expected:["("],next:[]}},{message:function(){return 0},suggestion:{expected:[")"],next:[]}},{message:function(){return 0},suggestion:{expected:["OBSERVABLE"],next:[";"]}},{message:function(){return 0},suggestion:{expected:[";"],next:["para","local","OBSERVABLE","if","for","switch","while","return"]}},{message:function(){if(("("==this.token||"["==this.token)&&this.context.stream.isBEOL())return 6;if("("==this.token)return 0;if("["==this.token)return 1;if(";"==this.token)return 2;var t=n.tokenType(this.token);return"keyword"==t||"identifier"==t?3:"separator"==t?4:5},suggestion:{expected:["{"],next:["local","OBSERVABLE","if","for","switch","while","return"]}},{message:function(){return 0},suggestion:{expected:["}"],next:[";"]}},{message:function(){return 0},suggestion:{expected:["OBSERVABLE"],next:["{"]}},{message:function(){return 0},suggestion:{expected:["("],next:[]}},{message:function(){return 0},suggestion:{expected:[")"],next:[]}},{message:function(){return 0},suggestion:{expected:[";"],next:[]}},{message:function(){return 0},suggestion:{expected:[";"],next:[]}},{message:function(){return 0},suggestion:{expected:["["],next:[]}},{message:function(){return 0},suggestion:{expected:["]"],next:[]}},{message:function(){return 0},suggestion:{expected:["("],next:[]}},{message:function(){return 0},suggestion:{expected:["]"],next:[]}},{message:function(){return 0},suggestion:{expected:[":"],next:[]}},{message:function(){return 0},suggestion:{expected:["NUMBER","STRING"],next:[]}},{message:function(){return 0},suggestion:{expected:[":"],next:[]}},{message:function(){return 0},suggestion:{expected:[","],next:[]}},{message:function(){return 0},suggestion:{expected:[","],next:[]}},{message:function(){return 0},suggestion:{expected:[","],next:[]}},{message:function(){return 0},suggestion:{expected:["OBSERVABLE"],next:[]}},{message:function(){return 0},suggestion:{expected:["="],next:[]}},{message:function(){return"procedurescope"==this.statement.type?0:1},suggestion:{expected:[")"],next:[]}},{message:function(){return 0},suggestion:{expected:["`"],next:[]}},{message:function(){return 0},suggestion:{expected:["("],next:[]}},{message:function(){return 0},suggestion:{expected:[")"],next:[]}},{message:function(){return 0},suggestion:{expected:[")"],next:[]}},{message:function(){return 0},suggestion:{expected:["NUMBER"],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){var t=n.tokenType(this.token);return"keyword"==t?0:"boolean"==t||"character"==t||"string"==t||"number"==t?1:":"==this.token?4:"{"==this.token?5:"closebracket"==this.token?3:2},suggestion:{expected:["OBSERVABLE"],next:[":"]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}},{message:function(){return 0},suggestion:{expected:[],next:[]}}],i.prototype.setStatement=function(t){this.statement=t},i.prototype.extractBefore=function(t){for(var e=this.prevposition;e>0&&t>0&&10!=this.context.stream.code.charCodeAt(e);)e--,t--;return 10==this.context.stream.code.charCodeAt(e)&&e++,this.context.stream.code.substr(e,this.prevposition-e)},i.prototype.extractToken=function(){return this.context.stream.code.substr(this.prevposition,this.position-this.prevposition)},i.prototype.extractAfter=function(t){for(var e=this.position;e<this.context.stream.code.length&&t>0&&10!=this.context.stream.code.charCodeAt(e);)e++,t--;return this.context.stream.code.substr(this.position,e-this.position)},i.prototype.buildSuggestion=function(){var t=i.db[this.errno].suggestion;return-1!=t.next.indexOf(this.token)?this.extractBefore(10)+t.expected[0]+" "+this.extractToken()+this.extractAfter(10):this.extractBefore(10)+t.expected[0]+" "+this.extractAfter(10)},i.codeToName=function(t){for(var e in i)if(i[e]===t)return e},i.prototype.messageText=function(){var t=i.db[this.errno],e=r.errors[this.errno][t.message.call(this)];return void 0===this.extra?e:e+": "+this.extra},i.prototype.prettyPrint=function(){this.context.stream.pushPosition(),this.context.stream.move(this.position);var t=i.db[this.errno],e="Error:\n    "+r.errors[this.errno][t.message.call(this)]+"\n    Source : "+this.context.src+", line "+this.line+"\n    Code   : "+this.errno;return e+="\n    Here   : "+this.extractBefore(10)+">>> "+this.extractToken()+" <<<"+this.extractAfter(10),t.suggestion&&(e+="\n    Suggestion : "+this.buildSuggestion()),this.context.stream.popPosition(),e},i.prototype.prettyHTML=function(){this.context.stream.pushPosition(),this.context.stream.move(this.position);var t=i.db[this.errno],e="<div style='padding: 10px;'><b style='color: red;'>Error:</b><br>    "+r.errors[this.errno][t.message.call(this)]+"<br>    <b>Source :</b> "+this.context.src+", line "+this.line+"<br>    <b>Code   :</b> <span style='color: blue;'>"+this.errno+"</span><br>    <b>Name   :</b> <em>"+i.codeToName(this.errno)+"</em>";return e+="<br>    <b>Here   :</b> "+this.extractBefore(10)+">>> "+this.extractToken()+" <<<"+this.extractAfter(10),t.suggestion&&(e+="<br>    <b>Suggestion :</b> "+this.buildSuggestion()),e+="</div>",this.context.stream.popPosition(),e},i.prototype.toString=function(){return this.prettyPrint()},e.exports=i},{"@construit/language":57,"@construit/lexer":58}],82:[function(t,e,s){function i(t,e,s,i){this.type="syntax",this.context=t,this.node=e,this.warnno=s,this.extra=i,this.token=t.token,this.prevtoken=t.previous,this.line=t.stream.prevline,this.position=t.stream.position,this.prevposition=t.stream.prevposition}i.UNKNOWN=0,i.DEPRECATED=1,i.NESTEDWHEN=2,i.DEFINWHEN=3,i.EXPRESSIONLIT=4,i.prototype.messageText=function(){var t;switch(this.warnno){case i.DEPRECATED:t="Deprecation: ";break;case i.NESTEDWHEN:t='"when"\'s should not be nested';break;case i.DEFINWHEN:t='"when"\'s should not contain definitions';break;case i.EXPRESSIONLIT:t="Keep literals in separate observables";break;case i.USEOFWHILE:t="Try and use 'for', 'when' or 'with' to achieve looping";break;default:t="Warning: "}return t+=this.extra},e.exports=i},{}],83:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pTERM=function(){var t=this.pTERM_A(),e=this.pEXPRESSION_PPPPPP();return e?(e.left(t),e):t},i.prototype.pTERM_A=function(){for(var t=this.pTERM_P();"<"==this.token||"<="==this.token||">"==this.token||">="==this.token||"=="==this.token||"!="==this.token;){var e=new r.BinaryOp(this.token);this.next(),e.left(t),e.setRight(this.pTERM_P()),t=e}return t},i.prototype.pTERM_P=function(){for(var t=this.pTERM_PP();"+"==this.token||"-"==this.token||"//"==this.token;){var e=new r.BinaryOp(this.token);this.next(),e.left(t),e.setRight(this.pTERM_PP()),t=e}return t},i.prototype.pTERM_PP=function(){for(var t=this.pTERM_PPP();"*"==this.token||"/"==this.token||"%"==this.token||"^"==this.token;){var e=new r.BinaryOp(this.token);this.next(),e.left(t),e.setRight(this.pTERM_PPP()),t=e}return t},i.prototype.pTERM_PPP=function(){var t=this.pFACTOR(),e=this.pEXPRESSION_PPPPP();return e?(e.left(t),e):t}},{"../js/parser.js":71,"@construit/ast":35}],84:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pUSE=function(){var t=new r.Use,e=this.pCODESELECTOR();return void 0===e||e.errors.length>0?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.IMPORTPATH)),t):(t.setSelector(e),";"!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)),t):(this.next(),t))}},{"../js/parser.js":71,"@construit/ast":35}],85:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pWAIT=function(){var t=new r.Wait;if(";"==this.token)return this.next(),t;var e=this.pEXPRESSION();return t.setDelay(e),";"!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)),t):(this.next(),t)}},{"../js/parser.js":71,"@construit/ast":35}],86:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pWHEN=function(){var t=new r.When,e=this.parent;return this.parent=t,"("!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHENOPEN)),this.parent=e,t):(this.next(),t.setExpression(this.pEXPRESSION()),t.errors.length>0?(this.parent=e,t):")"!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHENCLOSE)),this.parent=e,t):(this.next(),this.inWhen=!0,t.setStatement(this.pSTATEMENT()),this.inWhen=!1,t.errors.length>0?(this.parent=e,t):void 0===t.statement?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHENNOSTATEMENT)),t.active=!0,this.parent=e,t):(this.whens.push(t),this.parent=e,t)))}},{"../js/parser.js":71,"@construit/ast":35}],87:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pWHILE=function(){var t=new r.While,e=this.parent;if(this.parent=t,"("!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHILEOPEN)),this.parent=e,t;if(this.next(),t.setCondition(this.pEXPRESSION()),t.errors.length>0)return this.parent=e,t;if(")"!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHILECLOSE)),this.parent=e,t;this.next();var s=this.allowBreak;return this.allowBreak=!0,t.setStatement(this.pSTATEMENT()),this.allowBreak=s,void 0===t.statement?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHILENOSTATEMENT)),this.parent=e,t):(this.parent=e,t)}},{"../js/parser.js":71,"@construit/ast":35}],88:[function(t,e,s){e.exports=function(t){var e=t.colate_dependencies;t.colate_dependencies={};var s=t.options.usePrefix;t.options.usePrefix=!t.staticOnly;var i=this.expression.generate(t);t.options.usePrefix=s;var r=Object.keys(t.colate_dependencies);if(t.colate_dependencies=e,t.staticOnly)return n=this.lvalue.generate(t)+" = "+i;var n="state."+this.lvalue.name+" = "+i;if(r.length>0){var o=Object.keys(t.changed);t.changed={},o.length>0&&(n='this.flush(["'+o.join('","')+'"]);\n'+n)}return t.changed[this.lvalue.name]=t.lastchanged++,n}},{}],89:[function(t,e,s){e.exports=function(t){return"("+this.l.generate(t)+" "+this.op+" "+this.r.generate(t)+")"}},{}],90:[function(t,e,s){e.exports=function(t){for(var e="{\n",s=0;s<this.statements.length;s++)if("dummy"!=this.statements[s].type){var i="\t"+this.statements[s].generate(t).replace(/\n/g,"\n\t");i.length>0&&(e+=i+";\n")}return e+"}\n"}},{}],91:[function(t,e,s){e.exports=function(t){return"var "+this.list.join(";\nvar ")}},{}],92:[function(t,e,s){e.exports=function(t){var e=t.colate_dependencies;t.colate_dependencies={};var s=t.staticOnly;t.staticOnly=!0;var i=this.expression.generate(t);t.staticOnly=s;var r=Object.keys(t.colate_dependencies);t.colate_dependencies=e,t.changed[this.lvalue.name]=!0;var n=r.length>0?'["'+r.join('","')+'"]':"[]";return'this.define("'+this.lvalue.name+'", `'+i+"`, "+n+")"}},{}],93:[function(t,e,s){e.exports=function(t){if(1==this.statements.length&&"return"==this.statements[0].type)return this.statements[0].expression.generate(t);var e=t.staticOnly;t.staticOnly=!0;for(var s="(function() {",i=0;i<this.statements.length;i++)if("dummy"!=this.statements[i].type){var r=this.statements[i].generate(t);r.length>0&&(s+=r+";\n")}return t.staticOnly=e,s+"})()"}},{}],94:[function(t,e,s){e.exports=function(t){var e=t.options.usePrefix;t.options.usePrefix=!t.staticOnly;var s=this.condition.generate(t);t.options.usePrefix=e;var i="if ("+s+") "+this.statement.generate(t);return this.elsestatement&&(i+=" else "+this.elsestatement.generate(t)),this.parent&&"if"!=this.parent.type&&(i="this.flush();\n"+i),i}},{}],95:[function(t,e,s){e.exports=function(t){return"this.l.index("+this.expression.generate(t)+")"}},{}],96:[function(t,e,s){e.exports=function(t){for(var e=this.expression.generate(t),s=0;s<this.indexes.length;s++)e+="["+this.indexes[s].generate(t)+"]";return e}},{}],97:[function(t,e,s){e.exports=function(t){return this.l.generate(t)+".length"}},{}],98:[function(t,e,s){e.exports=function(t){var e;switch(this.datatype){case"NUMBER":e=this.value;break;case"LIST":e="[";for(var s=0;s<this.value.length;s++)e+=this.value[s].generate(t),s!=this.value.length-1&&(e+=",");e+="]";break;case"CHARACTER":case"STRING":e='"'+this.value.replace(/\n/g,"\\n")+'"';break;case"BOOLEAN":case"JAVASCRIPT":e=this.value}return e}},{}],99:[function(t,e,s){e.exports=function(t){return t.option&&t.options.usePrefix?this.backtick?t.prefix+'["'+this.backtick.generate(t)+'"]':t.prefix+"."+this.name:this.backtick?void 0:this.name}},{}],100:[function(t,e,s){"use strict";function i(t,e,s){if(this.src=t,this.ast="object"==typeof t?t:n.parse(t),this.rt=e,this.options=s||{},this.staticOnly=this.options.staticOnly,this.prefix=this.options.prefix?s.prefix:"state",this.colate_dependencies={},this.def_cache=this.options.clearedCache?{}:e.def_cache,this.scope_cache={},this.visited={},this.unresolved={},this.wasDynamic=!1,this.name_map={},this.isObject=!0,this.changed={},this.lastchanged=0,this.ast.hasErrors()){if(!this.options.error)throw this.ast.errors[0];this.options.error(this.ast.errors[0])}}const r=t("@construit/ast"),n=t("@construit/parser");r.Literal.prototype.generate=t("./literal.js"),r.LValue.prototype.generate=t("./lvalue.js"),r.Assignment.prototype.generate=t("./assignment.js"),r.Definition.prototype.generate=t("./definition.js"),r.Procedure.prototype.generate=t("./procedure.js"),r.Function.prototype.generate=t("./function.js"),r.BinaryOp.prototype.generate=t("./binaryop.js"),r.Block.prototype.generate=t("./block.js"),r.Primary.prototype.generate=t("./primary.js"),r.ExpressionScope.prototype.generate=t("./scopeexpr.js"),r.Structure.prototype.generate=t("./structure.js"),r.Indexed.prototype.generate=t("./indexed.js"),r.Index.prototype.generate=t("./index.js"),r.Return.prototype.generate=t("./return.js"),r.Declarations.prototype.generate=t("./declarations.js"),r.Length.prototype.generate=t("./length.js"),r.UnaryOp.prototype.generate=t("./unaryop.js"),r.If.prototype.generate=t("./if.js"),r.While.prototype.generate=t("./while.js"),i.prototype.generateDependencies=function(t){function e(t){for(var o=0;o<t.length;o++)if(!i[t[o]]){n++,i[t[o]]=!0;var a=r.dep_cache[t[o]];if(a&&a.length>0&&e(a),!r.def_cache.hasOwnProperty(t[o])){if(!r.ast_cache.hasOwnProperty(t[o])){r.unresolved[t[o]]=!0;continue}r.ast_cache[t[o]].generate(r)}s+="this."+t[o]+" = "+r.def_cache[t[o]]+";\n"}}var s="",i=this.visited,r=this,n=0;return console.log("Generate Dependencies"),e(t),s},i.prototype.generateMaintainer=function(){return""},i.prototype.translate=function(t){if(t||(t=this.ast),t.hasErrors())return null;n="";if(this.options&&Array.isArray(this.options.inputs)&&this.options.inputs.length>0)for(o=0;o<this.options.inputs.length;o++){var e=this.options.inputs[o];this.changed[e]=!0,this.visited[e]=!0,n+=this.prefix+"."+this.options.inputs[o]+" = p_"+this.options.inputs[o]+";\n",this.name_map[e]="p_"+e}var s=t.generate(this);t.isExpression()&&(s="structure"==t.type&&null===t.elements?this.generateDependencies(Object.keys(this.colate_dependencies)):"primary"==t.type?this.generateDependencies(Object.keys(this.colate_dependencies)):this.generateDependencies(Object.keys(this.colate_dependencies))+"this.__result__ = "+s),s=n+s;var i="";if(!this.options||!this.options.noScopeFunctions)for(var r in this.scope_cache)i+=this.scope_cache[r]+";\n";if(i=this.options&&this.options.standalone?"const state = {};\nconst funcs = {};\n\n"+i:"const state = this.state;\nconst funcs = this.funcs;\n\n"+i,this.options&&this.options.noScopeFunctions?s=s:s+=this.generateMaintainer(),i="'use strict';\n"+i,s+=";\nthis.flush();\n",this.options)if(this.options.outputAll)s=s+"return "+this.prefix+";";else if(Array.isArray(this.options.outputs)&&this.options.outputs.length>0)if(1==this.options.outputs.length)s=s+"return "+this.prefix+"."+this.options.outputs[0]+";";else{for(var n="this.__result__ = {\n",o=0;o<this.options.outputs.length;o++)n+="\t"+this.options.outputs[o]+": this."+this.options.outputs[o],o<this.options.outputs.length-1&&(n+=",\n");s+=n+="\n};"}if(this.options&&this.options.standalone){var a="function program(";Array.isArray(this.options.inputs)&&(a+="p_"+this.options.inputs.join(",p_")),s="(function(){\n\t"+(i+(a+=") {\n\t"+s.replace(/\n/g,"\n\t")+"\n}\nreturn program;")).replace(/\n/g,"\n\t")+"\n})()"}else s=this.options.includeWrapper?"(function(){\n\t"+(i+s).replace(/\n/g,"\n\t")+"\n})":i+s;return this.options.inputs&&console.log(this.makeMaintainerList(this.options.inputs)),s},i.prototype.transpile=function(){var t=this.translate();return null===t?null:Function(t).bind(this.rt)},s.eval=function(t,e,s){return new i(t,e,s).transpile()()},s.transpile=function(t,e,s){return s&&(s.includeWrapper=!1),new i(t,e,s).transpile()},s.translate=function(t,e,s){return new i(t,e,s).translate()},s.Transpiler=i},{"./assignment.js":88,"./binaryop.js":89,"./block.js":90,"./declarations.js":91,"./definition.js":92,"./function.js":93,"./if.js":94,"./index.js":95,"./indexed.js":96,"./length.js":97,"./literal.js":98,"./lvalue.js":99,"./primary.js":101,"./procedure.js":102,"./return.js":103,"./scopeexpr.js":104,"./structure.js":105,"./unaryop.js":106,"./while.js":107,"@construit/ast":137,"@construit/parser":169}],101:[function(t,e,s){e.exports=function(t){return this.backtick?(t.wasDynamic=!0,"this["+this.backtick.generate(t)+"]"):(t.colate_dependencies.hasOwnProperty(this.observable)?t.colate_dependencies[this.observable]++:t.colate_dependencies[this.observable]=1,t.options&&t.options.usePrefix?t.prefix+"."+this.observable:this.observable)}},{}],102:[function(t,e,s){e.exports=function(t){return'this.procs["'+this.name+'"] = function() '+this.block.generate(t)}},{}],103:[function(t,e,s){e.exports=function(t){return this.expression?"return "+this.expression.generate(t):"return"}},{}],104:[function(t,e,s){function r(t){var e=0;if(0==t.length)return e;for(i=0;i<t.length;i++)char=t.charCodeAt(i),e=(e<<5)-e+char,e&=e;return e}function n(t,e,s){var i="";for(var n in t.overrides)i+="$"+n;return s?"f_"+Math.abs(r(e))+i:t.expression.observable+i}e.exports=function(t){var e=Object.keys(this.overrides),s=t.colate_dependencies;t.colate_dependencies={};var i=t.options.usePrefix;t.options.usePrefix=!1;var r=this.expression.generate(t);t.options.usePrefix=i;for(var o=Object.keys(t.colate_dependencies),a=0;a<o.length;a++)this.overrides.hasOwnProperty(o[a])||(s[o[a]]=!0);t.colate_dependencies=s;var h;h="(";for(var p="",a=0;a<e.length;a++)"="==this.overrides[e[a]].kind?(h+=this.overrides[e[a]].expr.generate(t),a<e.length-1&&(h+=",")):p+=this.overrides[e[a]].expr.generate(t);var c=n(this,r+p,p.length>0||"primary"!=this.expression.type);return t.rt.hasScope(c)||(t.scope_cache[c]='this.scope("'+c+'", `'+r+'`, ["'+e.join('","')+'"], ["'+o.join('","')+'"])',t.changed[c]=!0),h="funcs.s"+c+h,h+=")"}},{}],105:[function(t,e,s){e.exports=function(t){if(null===this.elements)return"this";for(var e="{\n",s=Object.keys(this.elements),i=0;i<s.length;i++)e+="\t"+s[i]+": "+this.elements[s[i]].generate(t),i<s.length-1&&(e+=",\n");return e+="\n}"}},{}],106:[function(t,e,s){e.exports=function(t){if("!"==this.op)return this.op+this.r.generate(t)}},{}],107:[function(t,e,s){e.exports=function(t){var e=t.options.usePrefix;t.options.usePrefix=!t.staticOnly;var s=this.condition.generate(t);t.options.usePrefix=e,t.changed={};var i="this.flush();\nwhile ("+s+") {"+this.statement.generate(t)+"\nthis.flush();}";return t.changed={},i}},{}],108:[function(t,e,s){function i(t,e,s){this.type="assignment",r.call(this),this.errors=s?s.errors:[],s&&s.warning&&(this.warning=s.warning),this.expression=s,this.lvalue=void 0,this.compiled=void 0,this.dirty=!1,this.value=void 0,this.compiled=void 0,this.source=t,e&&this.setLValue(e)}const r=t("./basecontext.js");r.extend(i),i.prototype.left=function(t){this.lvalue=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setLValue=i.prototype.left,i.prototype.setExpression=function(t){this.expression=t,t.warning&&(this.warning=t.warning),t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.validate=function(){return!this.hasErrors()&&this.lvalue&&this.lvalue.validate()&&this.expression&&this.expression.isExpression()&&this.expression.validate()},e.exports=i},{"./basecontext.js":109}],109:[function(t,e,s){function i(){r.call(this),this.scopes=[],this.backtickCount=0,this.locals=void 0,this.params=void 0,this.dependencies={}}const r=t("./basescript.js");r.extend(i),i.extend=function(t){t.prototype=Object.create(i.prototype),t.prototype.constructor=t},e.exports=i},{"./basescript.js":112}],110:[function(t,e,s){function i(){this.type=this.constructor.name.toLowerCase(),this.errors=[],this.warning=null}i.prototype.isExpression=function(){return!0},i.prototype.isStatement=function(){return!1},i.prototype.left=function(t){this.l=t,t.errors&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors),t&&t.warning&&(this.warning=t.warning)},i.prototype.setLeft=i.prototype.left,i.prototype.hasErrors=function(){return this.errors.length>0},i.prototype.error=function(t){this.errors.unshift(t),t.setStatement(this)},i.extend=function(t){t.prototype=Object.create(i.prototype),t.prototype.constructor=t},e.exports=i},{}],111:[function(t,e,s){arguments[4][10][0].apply(s,arguments)},{dup:10}],112:[function(t,e,s){function i(){r.call(this),this.statements=[],this.parameters=void 0,this.locals=void 0,this.indexed=!1,this.name=null,this.active=!1,this.root=null,this.prefix="",this.postfix=""}const r=t("./basestatement.js"),n=t("./indexer.js");r.extend(i),i.extend=function(t){t.prototype=Object.create(i.prototype),t.prototype.constructor=t},i.prototype.getSource=function(){return this.prefix+this.getInnerSource()+this.postfix},i.prototype.getInnerSource=function(){for(var t="",e=0;e<this.statements.length;e++)t+=this.statements[e].getSource();return t},i.prototype.patchInner=function(t){for(var e=this;e.parent;)e=e.parent;for(var s={},i=0;i<this.statements.length;i++)void 0===s[(r=this.statements[i]).id]&&(s[r.id]=[]),s[r.id].push(r);for(i=0;i<t.statements.length;i++){var r=t.statements[i];r.buildID(),s[r.id]&&s[r.id].length>0?(t.replaceChild(i,s[r.id][0]),s[r.id].shift(),0==s[r.id].length&&delete s[r.id]):"dummy"!=r.type&&this.indexed&&r.addIndex()}for(var n in s)for(var o=s[n],i=0;i<o.length;i++)"when"==o[i].type&&o[i].enabled&&eden.project.removeAgent(o[i]),this.indexed&&0==o[i].executed?o[i].removeIndex():o[i].destroy();if(void 0===this.parent)for(i=0;i<t.statements.length;i++)"script"==t.statements[i].type&&"ACTIVE"==t.statements[i].name?(t.statements[i]=eden.root,Eden.Index.remove(t.statements[i])):t.statements[i].parent=this;else for(i=0;i<t.statements.length;i++)t.statements[i].parent=this;this.statements=t.statements},i.prototype.patchOuter=function(t){},i.prototype.getLine=function(){return this.line},i.prototype.isRemote=function(){for(var t=this;t.parent;)t=t.parent;return t.base.origin.remote},i.prototype.setLocals=function(t){this.locals=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.subscribeDynamic=function(t,e){return eden.root.lookup(e)},i.prototype.getParameterByNumber=function(t){if(this.parameters)return this.parameters[t-1]},i.prototype.setName=function(t,e){this.name=e,this.shortName=e},i.prototype.setSource=function(t,e,s){if(this.start=t,this.end=e,s){0==this.statements.length||(this.prefix=s.substring(0,this.statements[0].start-t),this.postfix=s.substring(this.statements[this.statements.length-1].end-t)),this.numlines=0;for(i=0;i<this.prefix.length;i++)"\n"==this.prefix.charAt(i)&&this.numlines++;for(var i=0;i<this.postfix.length;i++)"\n"==this.postfix.charAt(i)&&this.numlines++}},i.prototype.appendChild=function(t){this.statements.push(t),this.statements.length>1&&(t.previousSibling=this.statements[this.statements.length-2],this.statements[this.statements.length-2].nextSibling=t),t.parent=this,this.indexed&&0!=this.id&&console.log("INVALIDATE ID",this),"dummy"!=t.type&&this.indexed&&t.addIndex(),t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.append=i.appendChild,i.prototype.insertAfter=function(t,e){var s;for(s=0;s<this.statements.length&&this.statements[s]!==t;s++);if(s+1<this.statements.length)e.previousSibling=this.statements[s],e.nextSibling=this.statements[s+1],this.statements[s].nextSibling=e,this.statements[s+1].previousSibling=e,this.statements.splice(s+1,0,e);else{if(!(s<this.statements.length))return;e.previousSibling=this.statements[s],e.nextSibling=void 0,this.statements[s].nextSibling=e,this.statements.push(e)}e.parent=this,"dummy"!=e.type&&this.indexed&&e.addIndex(),e.errors.length>0&&this.errors.push.apply(this.errors,e.errors),this.indexed&&0!=this.id&&console.log("INVALIDATE ID",this)},i.prototype.insertBefore=function(t,e){var s;for(s=0;s<this.statements.length&&this.statements[s]!==t;s++);s<this.statements.length?(this.statements.splice(s,0,e),e.parent=this,"dummy"!=e.type&&this.indexed&&e.addIndex(),e.errors.length>0&&this.errors.push.apply(this.errors,e.errors),this.indexed&&0!=this.id&&console.log("INVALIDATE ID",this)):eden.emit("error",[new Eden.RuntimeError(void 0,Eden.RuntimeError.NOCHILD,this,"Statement is not a child when using insertBefore")])},i.prototype.removeChild=function(t){var e;for(e=0;e<this.statements.length&&this.statements[e]!==t;e++);e<this.statements.length?(this.statements.splice(e,1),t.nextSibling&&(t.nextSibling.previousSibling=t.previousSibling),t.previousSibling&&(t.previousSibling.nextSibling=t.nextSibling),t.destroy(),this.indexed&&0!=this.id&&console.log("INVALIDATE ID",this)):eden.emit("error",[new Eden.RuntimeError(void 0,Eden.RuntimeError.NOCHILD,this,"Statement is not a child when using removeChild")])},i.prototype.replaceChild=function(t,e){var s;if("number"==typeof t)s=t;else{var i;for(i=0;i<this.statements.length&&this.statements[i]!==t;i++);if(i>=this.statements.length)return void eden.emit("error",[new Eden.RuntimeError(void 0,Eden.RuntimeError.NOCHILD,this,"Statement is not a child when using replaceChild")]);s=i}e.nextSibling=this.statements[s].nextSibling,e.nextSibling&&(e.nextSibling.previousSibling=e),e.previousSibling=this.statements[s].previousSibling,e.previousSibling&&(e.previousSibling.nextSibling=e),this.statements[s].destroy(),this.statements[s]=e,e.parent=this,"dummy"!=e.type&&this.indexed&&e.addIndex(),this.indexed&&0!=this.id&&console.log("INVALIDATE ID",this)},i.prototype.destroy=function(){this.executed<1&&Eden.Index.remove(this);for(var t=0;t<this.statements.length;t++)this.statements[t].destroy();this.executed=-1,this.statements=void 0,this.base=void 0,this.parent=void 0,this.nextSibling=void 0,this.previousSibling=void 0},i.prototype.addIndex=function(){if(!this.indexed){0==this.id&&this.buildID();for(var t=0;t<this.statements.length;t++)"dummy"!=this.statements[t].type&&this.statements[t].addIndex();this.indexed=!0,n.update(this)}},i.prototype.removeIndex=function(){if(this.indexed){for(var t=0;t<this.statements.length;t++)"dummy"!=this.statements[t].type&&this.statements[t].removeIndex();this.indexed=!1,n.remove(this)}},i.prototype.buildID=function(){for(var t=0,e=this.getSource(),s=e.length,i=0;i<s;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;this.id=this.type+"@"+t},i.prototype.getStatementByLine=function(t,e){var s=0;if(e&&this.parent&&(s=this.parent.getRelativeLine(this,e)),!(s>t)&&void 0!==this.statements)for(var i=0;i<this.statements.length;i++){var r=this.statements[i].getNumberOfLines();if(t>=s&&t<=s+r&&"dummy"!=this.statements[i].type)return this.statements[i];s+=r}},i.prototype.getRelativeLine=function(t,e){var s=0;e&&e!==this&&this.parent&&(s=this.parent.getRelativeLine(this,e));for(var i=0;i<this.statements.length;i++){if(this.statements[i]===t)return s;s+=this.statements[i].getNumberOfLines()}return-1},i.prototype.getNumberOfLines=function(){void 0===this.statements&&console.error("No Statements",this);for(var t=this.numlines,e=0;e<this.statements.length;e++)t+=this.statements[e].getNumberOfLines();return t},e.exports=i},{"./basestatement.js":113,"./indexer.js":133}],113:[function(t,e,s){"use strict";function i(){this.type=this.constructor.name.toLowerCase(),this.start=0,this.end=0,this.parent=null,this.errors=[],this.warning=null,this.executed=0,this.numlines=-1,this.doxyComment=null,this.lock=0,this.source=null,this.id=0,this.stamp=0,this.nextSibling=null,this.previousSibling=null,this.tags=null}const r=t("./indexer.js");i.prototype.setDoxyComment=function(t){this.doxyComment=t,t&&(null===this.tags?this.tags=t.getHashTags():this.tags=this.tags.concat(t.getHashTags()),t.hasTag("#library")&&("function"==this.type||"action"==this.type?r.addLibrarySymbol(this.name):"definition"==this.type&&r.addLibrarySymbol(this.lvalue.name)))},i.prototype.buildID=function(){var t=0,e=this.source;this.doxyComment&&(e=this.doxyComment.content+e);for(var s=e.length,i=0;i<s;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;this.name&&"do"!=this.type?this.id=this.name+"@"+t:this.lvalue?this.id=this.lvalue.name+"@"+t:this.id=this.type+"@"+t},i.prototype.addIndex=function(){if("dummy"==this.type&&console.trace("ADDING DUMMY INDEX"),this.buildID(),this.statements)for(var t=0;t<this.statements.length;t++)"dummy"!=this.statements[t].type&&this.statements[t].addIndex();r.update(this)},i.prototype.removeIndex=function(){if(this.statements)for(var t=0;t<this.statements.length;t++)"dummy"!=this.statements[t].type&&this.statements[t].removeIndex();r.remove(this)},i.prototype.destroy=function(){if(this.executed<1&&r.remove(this),this.parent=void 0,this.nextSibling=void 0,this.previousSibling=void 0,this.statements)for(var t=0;t<this.statements.length;t++)"dummy"!=this.statements[t].type&&this.statements[t].destroy();this.executed=-1},i.prototype.hasErrors=function(){return this.errors.length>0},i.prototype.error=function(t){this.errors.unshift(t),t.setStatement(this)},i.prototype.getNumberOfLines=function(){return this.numlines},i.prototype.getStartLine=function(t){return this.parent?this.parent.getRelativeLine(this,t):-1},i.prototype.getEndLine=function(t){return this.getStartLine(t)+this.getNumberOfLines()},i.prototype.getRange=function(t){var e=this.getStartLine(t);return[e,e+this.getNumberOfLines()]},i.prototype.setSource=function(t,e,s){this.start=t,this.end=e,this.source=s},i.prototype.getSource=function(){return this.source},i.prototype.getOuterSource=function(){var t=this.getSource();void 0===this.parent&&(t="action "+this.name+"{"+t+"}"),this.doxyComment&&(t="/** "+this.doxyComment.content+" */\n"+t);for(var e=this.parent;e;)"script"==e.type?(t=e.name?"action "+e.name+" {\n"+t+"\n}":"{\n"+t+"\n}",e.doxyComment&&(t="/** "+e.doxyComment.content+" */\n"+t),e=e.parent):e=void 0;return t},i.prototype.getOrigin=function(){for(var t=this;t.parent;)t=t.parent;return t.base?t.base.origin:void 0},i.prototype.isExpression=function(){return!1},i.prototype.isStatement=function(){return!0},i.extend=function(t){t.prototype=Object.create(i.prototype),t.prototype.constructor=t},e.exports=i},{"./indexer.js":133}],114:[function(t,e,s){arguments[4][13][0].apply(s,arguments)},{"./baseexpression.js":110,dup:13}],115:[function(t,e,s){arguments[4][14][0].apply(s,arguments)},{"./basescript.js":112,dup:14}],116:[function(t,e,s){"use strict";function i(){r.call(this)}const r=t("./basestatement.js");r.extend(i),i.prototype.validate=function(){return!0},e.exports=i},{"./basestatement.js":113}],117:[function(t,e,s){arguments[4][16][0].apply(s,arguments)},{"./basestatement.js":113,dup:16}],118:[function(t,e,s){arguments[4][17][0].apply(s,arguments)},{"./basestatement.js":113,dup:17}],119:[function(t,e,s){arguments[4][18][0].apply(s,arguments)},{"./basestatement.js":113,dup:18}],120:[function(t,e,s){arguments[4][19][0].apply(s,arguments)},{"./basestatement.js":113,dup:19}],121:[function(t,e,s){arguments[4][20][0].apply(s,arguments)},{"./basecontext.js":109,dup:20}],122:[function(t,e,s){arguments[4][21][0].apply(s,arguments)},{"./basestatement.js":113,dup:21}],123:[function(t,e,s){function i(){r.call(this),this.name=void 0,this.script=void 0,this.parameters=[],this.params=[],this.scope=void 0,this.compScope=void 0,this.nscope=void 0,this.selector=void 0}const r=t("./basestatement.js");r.extend(i),i.prototype.addParameter=function(t){this.parameters.push(t),t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setScript=function(t){this.script=t,this.script&&this.script.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setName=function(t){t&&t.errors&&this.errors.push.apply(this.errors,t.errors),this.name=t},i.prototype.setScope=function(t){this.scope=t,t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":113}],124:[function(t,e,s){arguments[4][23][0].apply(s,arguments)},{"./basenode.js":111,dup:23}],125:[function(t,e,s){arguments[4][24][0].apply(s,arguments)},{"./basestatement.js":113,dup:24}],126:[function(t,e,s){function i(){r.call(this),this.range=!1,this.overrides={},this.expression=null}const r=t("./baseexpression.js"),n=t("./primary.js");r.extend(i),i.prototype.prepend=function(t){this.primary.prepend(t)},i.prototype.setExpression=function(t){this.expression=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setObservable=function(t){this.expression=new n,this.expression.setObservable(t)},i.prototype.addOverride=function(t,e,s,i,r){this.errors.push.apply(this.errors,t.errors),"in"==r&&(this.range=!0),i?(this.range=!0,this.overrides[t.observable]={expr:e,endexpr:i,increment:s,components:t.components,kind:r},this.errors.push.apply(this.errors,e.errors),this.errors.push.apply(this.errors,s.errors),this.errors.push.apply(this.errors,i.errors)):s?(this.range=!0,this.overrides[t.observable]={expr:e,endexpr:s,components:t.components,kind:r},this.errors.push.apply(this.errors,e.errors),this.errors.push.apply(this.errors,s.errors)):e&&(this.overrides[t.observable]={expr:e,endexpr:void 0,components:t.components,kind:r},this.errors.push.apply(this.errors,e.errors))},e.exports=i},{"./baseexpression.js":110,"./primary.js":139}],127:[function(t,e,s){arguments[4][26][0].apply(s,arguments)},{"./basestatement.js":113,dup:26}],128:[function(t,e,s){"use strict";function i(){r.call(this)}const r=t("./basescript.js");r.extend(i),i.prototype.isExpression=function(){return!0},e.exports=i},{"./basescript.js":112}],129:[function(t,e,s){arguments[4][28][0].apply(s,arguments)},{"./basestatement.js":113,dup:28}],130:[function(t,e,s){function i(){r.call(this),this.path=void 0,this.selector=void 0,this.statements=void 0}const r=t("./basestatement.js");r.extend(i),i.prototype.setPath=function(t){this.path=t},e.exports=i},{"./basestatement.js":113}],131:[function(t,e,s){arguments[4][29][0].apply(s,arguments)},{"./basenode.js":111,dup:29}],132:[function(t,e,s){arguments[4][30][0].apply(s,arguments)},{"./baseexpression.js":110,dup:30}],133:[function(t,e,s){"use strict";let i={},r={},n={},o={},a={};s.addLibrarySymbol=function(t){a[t]=!0},s.isLibrary=function(t){return a.hasOwnProperty(t)},s.idExists=function(t){return i.hasOwnProperty(t)},s.getByID=function(t){var e=i[t];return e||[]},s.getAll=function(){var t=[];return Object.values?t.concat.apply(t,Object.values(i)):t.concat.apply(t,Object.keys(i).map(function(t){return i[t]}))},s.getAllWithName=function(){var t=[];for(var e in r)t.push.apply(t,r[e].map(function(t){return i[t]}));return t},s.getByName=function(t){var e=[];return r[t]?e.concat.apply(e,r[t].map(function(t){return i[t]})):e},s.getByNameRegex=function(t){var e=[];for(var s in r)t.test(s)&&(e=e.concat.apply(e,r[s].map(function(t){return i[t]})));return e},s.getByType=function(t){var e=[];return o[t]?e.concat.apply(e,Object.keys(o[t]).map(function(t){return i[t]})):e},s.getByTag=function(t){var e=[];return n[t]?e.concat.apply(e,n[t].map(function(t){return i[t]})):e},s.getByTagRegex=function(t){var e=[];for(var s in n)t.test(s)&&(e=e.concat.apply(e,n[s].map(function(t){return i[t]})));return e},s.remove=function(t){var e=i[t.id];if(e){for(h=0;h<e.length;h++)e[h]===t&&e.splice(h,1);if(0==e.length){if(delete i[t.id],delete o[t.type][t.id],t.name&&"do"!=t.type||t.lvalue){var s=t.name?t.name:t.lvalue.name;if(void 0===r[s])return;(p=r[s].indexOf(t.id))>=0&&r[s].splice(p,1)}if(t.tags)for(var a=t.tags,h=0;h<a.length;h++)if(void 0!==n[a[h]]){var p=n[a[h]].indexOf(t.id);p>=0&&n[a[h]].splice(p,1)}}}},s.update=function(t){if(void 0===i[t.id]&&(i[t.id]=[]),i[t.id].push(t),1==i[t.id].length){if(void 0===o[t.type]&&(o[t.type]={}),o[t.type][t.id]=!0,t.name&&"do"!=t.type||t.lvalue){var e=t.name?t.name:t.lvalue.name;void 0===r[e]&&(r[e]=[]),-1==r[e].indexOf(t.id)&&r[e].push(t.id)}if(t.tags)for(var s=t.tags,a=0;a<s.length;a++)void 0===n[s[a]]&&(n[s[a]]=[]),-1==n[s[a]].indexOf(t.id)&&n[s[a]].push(t.id)}},s.reset=function(){i={},r={},n={},o={},a={}}},{}],134:[function(t,e,s){arguments[4][32][0].apply(s,arguments)},{"./baseexpression.js":110,dup:32}],135:[function(t,e,s){function i(t,e){r.call(this),this.datatype=t,this.value=e}const r=t("./basestatement.js");r.extend(i),e.exports=i},{"./basestatement.js":113}],136:[function(t,e,s){function i(){n.call(this),this.name=void 0,this.express=void 0,this.primary=void 0,this.lvaluep=void 0,this.islocal=!1}function r(t){this.type="lvaluecomponent",this.errors=[],this.kind=t,this.indexexp=void 0,this.observable=void 0}const n=t("./basenode.js");n.extend(i),i.prototype.setExtras=function(t){if(this.lvaluep=t,t)for(var e=0;e<t.length;e++)this.errors.push.apply(this.errors,t[e].errors)},i.prototype.setObservable=function(t){this.name=t},i.prototype.setPrimary=function(t){this.primary=t,t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setExpression=function(t){this.express=t,t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},i.prototype.hasListIndices=function(){return this.lvaluep&&this.lvaluep.length>0&&"index"==this.lvaluep[0].kind},r.prototype.index=function(t){this.indexexp=t,this.errors.push.apply(this.errors,t.errors)},r.prototype.property=function(t){this.observable=t},r.prototype.generate=function(t,e){if("index"==this.kind)return"[rt.index("+this.indexexp.generate(t,e,{bound:!1})+")]"},e.exports=i},{"./basenode.js":111}],137:[function(t,e,s){function i(t){var e="<b>"+t.constructor.name+"</b> {\n\t";t.hasErrors&&t.hasErrors()&&t.errors[0].statement===t&&(e+=t.errors[0].prettyHTML());for(var s in t)if(!r.hasOwnProperty(s)){var n=t[s];if(null===n)continue;if(void 0===n)continue;var o=typeof n;if("function"==o)continue;switch(o){case"object":if(Array.isArray(n)){if(0==n.length)continue;for(var a="[\n\t",h=0;h<n.length;h++)a+="\n\t\t"+i(n[h]).replace(/\n/g,"\n\t\t"),h<n.length-1&&(a+=",\n\t");n=a+"\n\t]"}else if("overrides"==s){a="{\n\t";for(var p in n)a+="\n\t\t"+p+": "+i(n[p]).replace(/\n/g,"\n\t\t"),h<n.length-1&&(a+=",\n\t");n=a+"\n\t}"}else n=(n=i(n)).replace(/\n/g,"\n\t")+"\n";break;case"string":n='<span style="color: red;">"'+n+'"</span>';break;case"number":n='<span style="color: blue;">'+n+"</span>"}e+=s+" = "+n+"\n\t"}return e.trim()+"\n}"}let r={type:!0,errors:!0,nextSibling:!0,previousSibling:!0,parent:!0,start:!0,end:!0,prefix:!0,postfix:!0,source:!0,root:!0,base:!0,warning:!0,numlines:!0,lock:!0,executed:!0,active:!0,indexed:!0,id:!0,backtickCount:!0};s.htmlify=i,s.Assignment=t("./assignment.js"),s.DoxyComment=t("./doxycomments.js"),s.BinaryOp=t("./binaryop.js"),s.Break=t("./break.js"),s.Block=t("./block.js"),s.Case=t("./case.js"),s.Continue=t("./continue.js"),s.Declarations=t("./declarations.js"),s.Default=t("./default.js"),s.Definition=t("./definition.js"),s.Delete=t("./delete.js"),s.Do=t("./do.js"),s.DummyStatement=t("./dummy.js"),s.For=t("./for.js"),s.Function=t("./function.js"),s.If=t("./if.js"),s.Import=t("./import.js"),s.Index=t("./index.js"),s.Indexer=t("./indexer.js"),s.Indexed=t("./indexed.js"),s.Length=t("./length.js"),s.Literal=t("./literal.js"),s.LValue=t("./lvalue.js"),s.Modify=t("./modify.js"),s.Primary=t("./primary.js"),s.Procedure=t("./procedure.js"),s.Query=t("./querystat.js"),s.Range=t("./range.js"),s.Return=t("./return.js"),s.ExpressionScope=t("./exprscope.js"),s.ProcedureScope=t("./procscope.js"),s.ScopePattern=t("./scopepattern.js"),s.Section=t("./section.js"),s.Structure=t("./structure.js"),s.Switch=t("./switch.js"),s.TernaryOp=t("./ternaryop.js"),s.UnaryOp=t("./unaryop.js"),s.Wait=t("./wait.js"),s.When=t("./when.js"),s.While=t("./while.js")},{"./assignment.js":108,"./binaryop.js":114,"./block.js":115,"./break.js":116,"./case.js":117,"./continue.js":118,"./declarations.js":119,"./default.js":120,"./definition.js":121,"./delete.js":122,"./do.js":123,"./doxycomments.js":124,"./dummy.js":125,"./exprscope.js":126,"./for.js":127,"./function.js":128,"./if.js":129,"./import.js":130,"./index.js":131,"./indexed.js":132,"./indexer.js":133,"./length.js":134,"./literal.js":135,"./lvalue.js":136,"./modify.js":138,"./primary.js":139,"./procedure.js":140,"./procscope.js":141,"./querystat.js":142,"./range.js":143,"./return.js":144,"./scopepattern.js":145,"./section.js":146,"./structure.js":147,"./switch.js":148,"./ternaryop.js":149,"./unaryop.js":150,"./wait.js":151,"./when.js":152,"./while.js":153}],138:[function(t,e,s){function i(t,e){r.call(this),this.errors=e?e.errors:[],this.kind=t,this.expression=e,this.lvalue=void 0}const r=t("./basecontext.js");r.extend(i),i.prototype.left=function(t){this.lvalue=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basecontext.js":109}],139:[function(t,e,s){function i(){r.call(this),this.observable="",this.extras=[],this.backtick=void 0}const r=t("./baseexpression.js");r.extend(i),i.prototype.setBackticks=function(t){this.backtick=t,this.errors.push.apply(this.errors,t.errors)},i.prototype.setObservable=function(t){this.observable=t},i.prototype.getObservable=function(){return this.observable},i.prototype.prepend=function(t){this.extras.unshift(t),t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./baseexpression.js":110}],140:[function(t,e,s){function i(){r.call(this),this.block=null,this.name=null}const r=t("./basestatement.js");r.extend(i),i.prototype.setBlock=function(t){this.block=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":113}],141:[function(t,e,s){function i(){r.call(this),this.range=!1,this.overrides={},this.lvalue=null}const r=t("./basestatement.js");r.extend(i),i.prototype.setLValue=function(t){this.lvalue=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.left=i.prototype.setLValue,i.prototype.addOverride=function(t,e,s,i,r){this.errors.push.apply(this.errors,t.errors),i?(this.range=!0,this.overrides[t.observable]={expr:e,exprend:i,increment:s,components:t.components,kind:r},this.errors.push.apply(this.errors,e.errors),this.errors.push.apply(this.errors,s.errors),this.errors.push.apply(this.errors,i.errors)):s?(this.range=!0,this.overrides[t.observable]={expr:e,exprend:s,components:t.components,kind:r},this.errors.push.apply(this.errors,e.errors),this.errors.push.apply(this.errors,s.errors)):e&&(this.overrides[t.observable]={expr:e,exprend:void 0,components:t.components,kind:r},this.errors.push.apply(this.errors,e.errors))},e.exports=i},{"./basestatement.js":113}],142:[function(t,e,s){arguments[4][38][0].apply(s,arguments)},{"./basestatement.js":113,dup:38}],143:[function(t,e,s){function i(t){this.type="range",this.parent=void 0,this.errors=t?t.errors:[],this.expression=t,this.lvalue=void 0,this.start=0,this.end=0}i.prototype.setSource=function(t,e){this.start=t,this.end=e},i.prototype.setSecond=function(t){this.second=t,t&&t.errors&&this.errors.push.apply(this.errors,t.errors)},i.prototype.left=function(t){this.lvalue=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{}],144:[function(t,e,s){function i(){r.call(this),this.expression=null}const r=t("./basestatement.js");r.extend(i),i.prototype.setExpression=function(t){this.expression=t,this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":113}],145:[function(t,e,s){function i(){this.type="scopepattern",this.observable="NONAME",this.components=[],this.errors=[]}i.prototype.setObservable=function(t){this.observable=t},i.prototype.addListIndex=function(t){this.components.push(t),t&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{}],146:[function(t,e,s){function i(){r.call(this),this.name=void 0,this.depth=1}const r=t("./basestatement.js");r.extend(i),i.prototype.setName=function(t){this.name=t;var e=t.match(/#[\w]+/g);null!==e&&(void 0===this.tags?this.tags=e:this.tags=this.tags.concat(e))},i.prototype.getRange=function(t){for(var e=this.getStartLine(t),s=this.nextSibling;s&&s.nextSibling&&("section"!=s.nextSibling.type||s.nextSibling.depth>this.depth);)s=s.nextSibling;return s&&"dummy"==s.type&&(s=s.previousSibling),[e,s?s.getEndLine(t):e+this.getNumberOfLines()]},e.exports=i},{"./basestatement.js":113}],147:[function(t,e,s){function i(){r.call(this),this.elements=null}const r=t("./baseexpression.js");r.extend(i),i.prototype.addElement=function(t,e){null===this.elements&&(this.elements={}),e.errors.length>0&&this.errors.push.apply(this.errors,e.errors),this.elements[t]=e},e.exports=i},{"./baseexpression.js":110}],148:[function(t,e,s){function i(){r.call(this),this.expression="",this.statement=void 0,this.compiled=void 0}const r=t("./basestatement.js");r.extend(i),i.prototype.setExpression=function(t){this.expression=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setStatement=function(t){this.statement=t,this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":113}],149:[function(t,e,s){function i(t){r.call(this),this.op=t,this.errors=[],this.first=void 0,this.second=void 0,this.condition=void 0,this.warning=void 0}const r=t("./baseexpression.js");r.extend(i),i.prototype.setFirst=function(t){this.first=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors),t&&t.warning&&(this.warning=t.warning)},i.prototype.setSecond=function(t){this.second=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors),t&&t.warning&&(this.warning=t.warning)},i.prototype.setCondition=function(t){this.condition=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors),t&&t.warning&&(this.warning=t.warning)},i.prototype.left=function(t){void 0===this.condition?this.condition=t:this.first=t,t.errors.length>0&&this.errors.push.apply(this.errors,t.errors),t&&t.warning&&(this.warning=t.warning)},e.exports=i},{"./baseexpression.js":110}],150:[function(t,e,s){function i(t,e){r.call(this),this.op=t,this.errors=e.errors,this.r=e}const r=t("./baseexpression.js");r.extend(i),e.exports=i},{"./baseexpression.js":110}],151:[function(t,e,s){function i(){r.call(this),this.delay=void 0,this.compiled_delay=void 0}const r=t("./basestatement.js");r.extend(i),i.prototype.setDelay=function(t){this.delay=t,t&&t.errors.length>0&&this.errors.push.apply(this.errors,t.errors)},e.exports=i},{"./basestatement.js":113}],152:[function(t,e,s){function i(){r.call(this),this.name="*When",this.id=0,this.expression=void 0,this.active=!1,this.compiled=void 0,this.scope=void 0,this.compScope=void 0,this.local=!1,this.dirty=!1,this.statement=void 0,this.enabled=!1,this.statements=[],this.retrigger=!1}const r=t("./basecontext.js");r.extend(i),i.prototype.getSource=function(){return this.statement?this.prefix+this.statement.getSource()+this.postfix:this.prefix+this.postfix},i.prototype.setSource=function(t,e,s){if(this.start=t,this.end=e,s){this.statement?(this.prefix=s.substring(0,this.statement.start-t),this.postfix=s.substring(this.statement.end-t)):(this.prefix=s.substring(0,e),this.postfix=""),this.numlines=0;for(i=0;i<this.prefix.length;i++)"\n"==this.prefix.charAt(i)&&this.numlines++;for(var i=0;i<this.postfix.length;i++)"\n"==this.postfix.charAt(i)&&this.numlines++}},i.prototype.getLine=function(){return this.line},i.prototype.doDebug=function(){return this.doxyComment&&this.doxyComment.getControls()["@debug"]},i.prototype.setScope=function(t){this.scope=t},i.prototype.subscribeDynamic=function(t,e,s){return console.log("Subscribe Dyn: ",e,s),eden.project.addTrigger(this,e,s),eden.root.lookup(e)},i.prototype.setExpression=function(t){this.expression=t,t&&this.errors.push.apply(this.errors,t.errors)},i.prototype.setStatement=function(t){this.statement=t,t&&(this.statements.push(t),this.errors.push.apply(this.errors,t.errors))},e.exports=i},{"./basecontext.js":109}],153:[function(t,e,s){const i=t("./basestatement.js");While=function(){i.call(this),this.condition=void 0,this.statement=void 0,this.compiled=void 0},i.extend(While),While.prototype.setCondition=function(t){this.condition=t,this.errors.push.apply(this.errors,t.errors)},While.prototype.setStatement=function(t){this.statement=t,t&&this.errors.push.apply(this.errors,t.errors)},e.exports=While},{"./basestatement.js":113}],154:[function(t,e,s){arguments[4][56][0].apply(s,arguments)},{dup:56}],155:[function(t,e,s){let i={language:"en",loadSymbols:function(t){for(var e in this.symbols)e!=this.symbols[e]&&void 0===t.symbols[this.symbols[e]]&&(t.symbols[this.symbols[e]]=t.lookup(e))},addKeywords:function(t){for(var e in t)this.keywords[e]=t[e]},addSymbols:function(t){for(var e in t)this.symbols[e]=t[e]},importoptions:{readonly:"readonly",remote:"remote",local:"local",rebase:"rebase",noexec:"noexec",reload:"reload",force:"force",async:"async",create:"create",remove:"remove"},selectors:{"has-name":!0,name:!0,type:!0,definition:!0,assignment:!0,script:!0,when:!0,for:!0,if:!0,last:!0,nth:!0,executed:!0,not:!0,unexecuted:!0,remote:!0,value:!0,active:!0,depends:!0},doxytags:{title:"title",author:"author",version:"version",param:"param",return:"return",debug:"debug",local:"local",role:"role",shared:"shared",oracle:"oracle",handle:"handle",deprecated:"deprecated",see:"see","{":"{","}":"}",hidden:"hidden",script:"script"},selectorAttributes:{name:"name",type:"type",datatype:"datatype",id:"id",lines:"lines",depends:"depends",time:"time",date:"date",title:"title",author:"author",v:"v",version:"version",source:"source",comment:"comment"},selectorOptions:{external:"external",history:"history",all:"all",indexed:"indexed",index:"index",nosort:"nosort",remote:"remote"},resultTypes:{brief:"brief",comment:"comment",source:"source",innersource:"innersource",title:"title",path:"path",name:"name",symbol:"symbol",line:"line",depends:"depends",value:"value",tags:"tags",rawcomment:"rawcomment",id:"id",remote:"remote",root:"root",enabled:"enabled",executed:"executed",exprtree:"exprtree"},selectorPseudo:{line:"line",determines:"determines",first:"first",last:"last",unexecuted:"unexecuted",executed:"executed",root:"root",project:"project",nth:"nth",value:"value",matches:"matches",age:"age",remote:"remote",not:"not",active:"active",me:"me",listed:"listed"},keywords:{func:"function",function:"function",proc:"procedure",auto:"local",para:"para",action:"action",procedure:"procedure",local:"local",var:"local",if:"if",is:"is",in:"in",else:"else",for:"for",while:"while",do:"do",switch:"switch",case:"case",default:"default",break:"break",continue:"continue",return:"return",when:"when",wait:"wait",import:"import",delete:"delete",with:"with",and:"and",or:"or",not:"not"},symbols:{int:"int",str:"str",round:"round",min:"min",max:"max",random:"random",floor:"floor",ceil:"ceil",abs:"abs",acos:"acos",asin:"asin",atan:"atan",cos:"cos",exp:"exp",ln:"ln",log:"log",mod:"mod",randomInteger:"randomInteger",randomFloat:"randomFloat",sin:"sin",sqrt:"sqrt",sum:"sum",tan:"tan",length:"length",error:"error",substr:"substr",type:"type",createView:"createView",createCanvas:"createCanvas",zonesAt:"zonesAt",execute:"execute",indexOf:"indexOf",forget:"forget",eager:"eager",time:"time",writeln:"writeln",apply:"apply",todo:"todo",char:"char",isBoolean:"isBoolean",isCallable:"isCallable",isChar:"isChar",isDefined:"isDefined",isValue:"isValue",isFunc:"isFunc",isInt:"isInt",isNaN:"isNaN",isNumber:"isNumber",isObject:"isObject",isPoint:"isPoint",isProc:"isProc",showView:"showView",array:"array",sublist:"sublist",reverse:"reverse",search:"search",sort:"sort",tail:"tail",concat:"concat",decodeHTML:"decodeHTML"},values:{true:!0,false:!1},errors:[]};var r=t("./en.js");i.errors=r.errors,i.ui=r.ui,e.exports=i},{"./en.js":154}],156:[function(t,e,s){function i(t,e){this.name=t,this.value=e}let r=t("@construit/language"),n=function(){this.value=void 0,this.error=!1,this.line=0},o=function(t,e){this.code=t,this.position=0,this.position_stack=[0],this.prevposition=0,this.line=1,this.prevline=1,this.data=new n,this.ignorestrings=e&&e.ignoreStrings,this.keywords=e&&e.keywords?e.keywords:r.keywords};o.prototype.pushPosition=function(){this.position_stack.push(this.position)},o.prototype.popPosition=function(){this.position=this.position_stack.pop()},o.prototype.discardPosition=function(){this.position_stack.pop()},o.prototype.get=function(){return this.position<this.code.length?this.code.charCodeAt(this.position++):0},o.prototype.peek=function(){return this.position<this.code.length?this.code.charCodeAt(this.position):0},o.prototype.peek2=function(){return this.position+1>=this.code.length?0:this.code.charCodeAt(this.position+1)},o.prototype.peek3=function(){return this.position+2>=this.code.length?0:this.code.charCodeAt(this.position+2)},o.prototype.readLine=function(){var t=this.code.indexOf("\n",this.position);if(-1==t){e=this.code.substring(this.position);return this.position=this.code.length,e}var e=this.code.substring(this.position,t+1);return this.position=t+1,this.line++,e},o.prototype.peekLine=function(){var t=this.code.indexOf("\n",this.position);if(-1==t)return e=this.code.substring(this.position);var e=this.code.substring(this.position,t+1);return e},o.prototype.move=function(t){this.position=t},o.prototype.reset=function(){this.position=0,this.position_stack=[0],this.prevposition=0,this.line=1},o.prototype.tokenText=function(){return this.code.substr(this.prevposition,this.position-this.prevposition)},o.prototype.isBEOL=function(){if(10==this.peek2())return!0;for(var t=this.prevposition-1,e=this.code.charCodeAt(t);9==e||32==e;)t--,e=this.code.charCodeAt(t);return 10==e},o.prototype.skip=function(){this.position++},o.prototype.eof=function(){return this.position>=this.code.length},o.prototype.valid=function(){return this.position<this.code.length},o.prototype.unget=function(){this.position--},o.prototype.skipWhiteSpace=function(){for(;this.valid();){var t=this.peek();if(10==t&&this.line++,9!=t&&10!=t&&13!=t&&32!=t&&160!=t)break;this.skip()}},o.prototype.skipLine=function(){for(;this.valid()&&10!=this.peek();)this.skip()},o.isAlphaNumeric=function(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||95==t||t>=128||36==t},o.prototype.isNumeric=function(t){return t>=48&&t<=57},o.tokenType=function(t){return"OBSERVABLE"==t?"identifier":"JAVASCRIPT"==t?"javascript":"NUMBER"==t?"number":"STRING"==t?"string":"CHARACTER"==t?"character":"BOOLEAN"==t?"boolean":"string"!=typeof t?(console.error(t),"INVALID"):o.isAlphaNumeric(t.charCodeAt(0))?"keyword":"("==t||"["==t||"{"==t?"openbracket":")"==t||"]"==t||"}"==t?"closebracket":","==t||"."==t||";"==t||":"==t?"separator":"operator"},o.prototype.parseAlphaNumeric=function(t){var e="";if(0==o.isAlphaNumeric(this.peek()))return!1;for(;this.valid()&&o.isAlphaNumeric(this.peek());)e+=String.fromCharCode(this.get());return t.value=e,!0},o.prototype.parseString=function(t,e){for(var s="";this.valid()&&this.peek()!=e;){var i=String.fromCharCode(this.get());if("\n"==i)return this.unget(),t.error=!0,void(t.value="LINEBREAK");s+="\\"==i?"\\"+(i=String.fromCharCode(this.get())):i}this.valid()&&this.peek()==e?(this.skip(),t.error=!1):t.error=!0,t.value=s},o.prototype.parseCharacter=function(t){var e=String.fromCharCode(this.get());if("'"==e)return t.value="",void(t.error=!0);"\\"==e&&(e=String.fromCharCode(this.get())),t.value=e,this.valid()&&39==this.peek()?this.skip():t.error=!0},o.prototype.parseNumber=function(t){for(var e="";this.valid()&&this.isNumeric(this.peek());)e+=String.fromCharCode(this.get());if(46==this.peek()&&this.isNumeric(this.peek2()))for(this.skip(),e+=".";this.valid()&&this.isNumeric(this.peek());)e+=String.fromCharCode(this.get());t.value=parseFloat(e)},o.prototype.readToken=function(t){if(this.prevline=this.line,this.skipWhiteSpace(),this.prevposition=this.position,void 0===t&&(t=this.ignorestrings),this.eof())return"EOF";var e=this.code.charCodeAt(this.position);switch(this.position++,e){case 33:return 61==this.peek()?(this.skip(),"!="):126==this.peek()?(this.skip(),"!~"):"!";case 34:return t?'"':(this.parseString(this.data,34),"STRING");case 35:return 35==this.peek()?(this.skip(),"##"):"#";case 36:if(123==this.peek()&&123==this.peek2())return this.skip(),this.skip(),"${{";break;case 37:return"%";case 38:return 38==this.peek()?(this.skip(),"&&"):61==this.peek()?(this.skip(),"&="):"&";case 39:return t?"'":(this.parseString(this.data,39),"STRING");case 40:return"(";case 41:return")";case 42:return 61==this.peek()?(this.skip(),"*="):47==this.peek()?(this.skip(),"*/"):"*";case 43:return 43==this.peek()?(this.skip(),"++"):61==this.peek()?(this.skip(),"+="):"+";case 44:return",";case 45:return 45==this.peek()?(this.skip(),"--"):61==this.peek()?(this.skip(),"-="):"-";case 46:return 46==this.peek()?(this.skip(),".."):".";case 47:return 47==this.peek()&&61==this.peek2()?(this.skip(),"//="):47==this.peek()?(this.skip(),"//"):61==this.peek()?(this.skip(),"/="):42==this.peek()?(this.skip(),"/*"):"/";case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.unget(),this.parseNumber(this.data),"NUMBER";case 58:return 58==this.peek()?(this.skip(),"::"):":";case 59:return";";case 60:return 60==this.peek()?(this.skip(),"<<"):61==this.peek()?(this.skip(),"<="):"<";case 61:return 61==this.peek()?(this.skip(),"=="):126==this.peek()?(this.skip(),"=~"):"=";case 62:return 62==this.peek()?(this.skip(),">>"):61==this.peek()?(this.skip(),">="):">";case 63:return"?";case 64:return"@";case 91:return"[";case 92:return'"';case 93:return"]";case 94:return"^";case 96:return"`";case 123:return"{";case 124:return 124==this.peek()?(this.skip(),"||"):61==this.peek()?(this.skip(),"|="):"|";case 125:return 125==this.peek()&&36==this.peek2()?(this.skip(),this.skip(),"}}$"):"}";case 126:return 62==this.peek()?(this.skip(),"~>"):"~"}if(this.unget(),this.parseAlphaNumeric(this.data))return this.keywords.hasOwnProperty(this.data.value)?this.keywords[this.data.value]:r.values.hasOwnProperty(this.data.value)?(this.data.value=r.values[this.data.value],"BOOLEAN"):"OBSERVABLE";throw this.skip(),new Error("Invalid Token: "+e)},i.prototype.toString=function(){return void 0!==this.value?this.name+"("+this.value+")":this.name},i.prototype.type=function(){return o.tokenType(this.name)},s.Stream=o,s.SyntaxData=n,s.Token=i,s.tokenise=function(t,e){for(var s=[],r=new o(t,e);r.valid();)r.data.value=void 0,s.push(new i(r.readToken(),r.data.value));return s}},{"@construit/language":155}],157:[function(t,e,s){arguments[4][59][0].apply(s,arguments)},{"./parser.js":170,"@construit/ast":137,dup:59}],158:[function(t,e,s){arguments[4][60][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,dup:60}],159:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pDO=function(){var t=new r.Do,e=this.parent;if(this.parent=t,"{"==this.token){this.next();var s=this.pSCRIPT();return s.parent=t,"}"!=this.token?(t.setScript(s),t.errors.push(new i.SyntaxError(this,i.SyntaxError.ACTIONCLOSE)),this.parent=e,t):(this.next(),t.setScript(s),this.parent=e,t)}if("OBSERVABLE"!=this.token&&"."!=this.token&&">>"!=this.token&&">"!=this.token&&"<"!=this.token&&"<<"!=this.token&&":"!=this.token&&"*"!=this.token&&"@"!=this.token&&"#"!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.DONAME)),this.parent=e,t;var n=this.pCODESELECTOR();return t.setName(n),t.errors.length>0?(this.parent=e,t):";"!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)),this.parent=e,t):(this.next(),this.parent=e,t)}},{"../js/parser.js":170,"@construit/ast":137}],160:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pEXPRESSION_PPPPP=function(){if("#"==this.token)return this.next(),new r.Length},i.prototype.pEXPRESSION_PPPPPP=function(){if("?"==this.token)return this.next(),(t=new r.TernaryOp("?")).setFirst(this.pEXPRESSION()),t.warning=new i.SyntaxWarning(this,t,i.SyntaxWarning.DEPRECATED,"use of ? for 'if'."),t.errors.length>0?t:":"!=this.token?(t.error(new i.SyntaxError(this,i.SyntaxError.TERNIFCOLON)),t):(this.next(),t.setSecond(this.pEXPRESSION()),t);if("if"==this.token){this.next();var t=new r.TernaryOp("?");return t.setCondition(this.pEXPRESSION()),t.errors.length>0?t:"else"!=this.token?(t.error(new i.SyntaxError(this,i.SyntaxError.TERNIFCOLON)),t):(this.next(),t.setSecond(this.pEXPRESSION()),t)}},i.prototype.pEXPRESSION_PLAIN=function(){for(var t=this.pTERM();"&&"==this.token||"||"==this.token||"&"==this.token||"|"==this.token||"and"==this.token||"or"==this.token;){var e=new r.BinaryOp(this.token);this.next(),e.left(t),e.setRight(this.pTERM()),t=e}return t},i.prototype.pEXPRESSION=function(){var t;if("{"==this.token){if(this.next(),t=this.pSTRUCTURE(),"}"!=this.token)return t.error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),t;this.next(),t=this.pEXTRAS(t)}else t=this.pEXPRESSION_PLAIN();if("with"==this.token||"::"==this.token){this.next();var e=this.pSCOPE();return e.setExpression(t),e}return t}},{"../js/parser.js":170,"@construit/ast":137}],161:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pEXTRAS=function(t){if("["==this.token||"."==this.token){var e=this.pINDEXED();return e.setExpression(t),"("==this.token?r=this.pEXTRAS(e):e}if("("==this.token){if(this.next(),")"==this.token)return this.next(),t;var s=this.pSCOPE();if(s.setExpression(t),")"!=this.token)return s.error(new i.SyntaxError(this,i.SyntaxError.SCOPECLOSE)),s;this.next();var r=this.pEXTRAS(s);return r}return t},i.prototype.pFACTOR=function(){if("("==this.token){this.next();var t=this.pEXPRESSION();return t.errors.length>0?t:(")"!=this.token?t.error(new i.SyntaxError(this,i.SyntaxError.EXPCLOSEBRACKET)):this.next(),x=this.pEXTRAS(t))}if("["==this.token){this.next();var e=[];"]"!=this.token&&(e=this.pELIST());for(var s=new r.Literal("LIST",e),n=0;n<e.length;n++)e[n].errors.length>0&&s.errors.push.apply(s.errors,e[n].errors);return s.errors.length>0?s:("]"!=this.token?s.error(new i.SyntaxError(this,i.SyntaxError.LISTLITCLOSE)):this.next(),s)}if("@"==this.token)return this.next(),new r.Literal("UNDEFINED","@");if("JAVASCRIPT"==this.token){u=new r.Literal("JAVASCRIPT",this.data.value);return this.next(),u}if("NUMBER"==this.token){u=new r.Literal("NUMBER",this.data.value);return this.next(),u}if("?"==this.token){this.next();var o=this.pQUERY();if("["==this.token){var a=this.pINDEXED();return a.setExpression(o),a}return o}if("-"==this.token)return this.next(),new r.UnaryOp("-",this.pFACTOR());if("<<"==this.token){if(this.next(),"OBSERVABLE"!=this.token)return(u=new r.Literal("STRING",this.data.value)).error(new i.SyntaxError(this,i.SyntaxError.HEREDOCTOKEN)),u;var h=this.data.value;if(10!=this.stream.get())return(u=new r.Literal("STRING",this.data.value)).error(new i.SyntaxError(this,i.SyntaxError.HEREDOCTOKEN)),u;for(var p="";this.stream.valid();){var c=this.stream.position,l=this.stream.readLine();if(l.startsWith(h)){this.stream.position=c+3;break}p+=l}u=new r.Literal("STRING",p.slice(0,-1).replace(/\\/g,"\\\\").replace(/"/g,'\\"'));return this.stream.valid()||u.error(new i.SyntaxError(this,i.SyntaxError.NEWLINE)),this.next(),u}if("STRING"==this.token){u=new r.Literal("STRING",this.data.value);for(this.data.error||this.next();0==this.data.error&&"STRING"==this.token;)u.value+="\n"+this.data.value,this.next();return this.data.error&&("LINEBREAK"==this.data.value?u.error(new i.SyntaxError(this,i.SyntaxError.LITSTRLINE)):u.error(new i.SyntaxError(this,i.SyntaxError.LITSTRCLOSE))),u}if("BOOLEAN"==this.token){u=new r.Literal("BOOLEAN",this.data.value);return this.next(),u}if("CHARACTER"==this.token){var u=new r.Literal("CHARACTER",this.data.value);return this.data.error?(""==this.data.value?u.error(new i.SyntaxError(this,i.SyntaxError.LITCHAREMPTY)):u.error(new i.SyntaxError(this,i.SyntaxError.LITCHARCLOSE)),u):(this.next(),u)}if("!"==this.token||"not"==this.token){this.next();f=this.pFACTOR();return new r.UnaryOp("!",f)}if("&"==this.token){this.next();d=this.pLVALUE();return new r.UnaryOp("&",d)}if("*"==this.token){this.next();var d=this.pFACTOR();return new r.UnaryOp("*",d)}if("function"==this.token){if(this.next(),"{"!=this.token){var m=new r.Function;return m.error(new i.SyntaxError(this,i.SyntaxError.ACTIONOPEN)),m}this.next();var f=this.pFUNCTION();if("}"!=this.token)return f.error(new i.SyntaxError(this,i.SyntaxError.ACTIONCLOSE)),f;this.next();var x=this.pEXTRAS(f);return x}if("OBSERVABLE"==this.token||"`"==this.token){var g=this.pPRIMARY();return g=this.pEXTRAS(g)}var y=new r.Primary;return y.error(new i.SyntaxError(this,i.SyntaxError.BADFACTOR)),y}},{"../js/parser.js":170,"@construit/ast":137}],162:[function(t,e,s){arguments[4][64][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,dup:64}],163:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pNAMEDFUNCTION=function(){var t;if("OBSERVABLE"!=this.token)return(e=new r.Function).error(new i.SyntaxError(this,i.SyntaxError.ACTIONNAME)),e;if(t=this.data.value,this.next(),"{"!=this.token)return(e=new r.Function).error(new i.SyntaxError(this,i.SyntaxError.ACTIONOPEN)),e;this.next();var e=new r.Definition;e.setExpression(this.pFUNCTION());var s=new r.LValue;return s.setObservable(t),e.setLValue(s),e.errors.length>0?e:"}"!=this.token?(e.error(new i.SyntaxError(this,i.SyntaxError.ACTIONCLOSE)),e):(this.next(),e)},i.prototype.pFUNCTION=function(){var t=new r.Function;t.parent=this.parent;for(this.parent;"EOF"!=this.token;){var e=this.pSTATEMENT(!0);if(void 0!==e){if(t.appendChild(e),e.errors.length>0)break}else{if("}"!=this.token&&";"!=this.token&&t.error(new i.SyntaxError(this,i.SyntaxError.STATEMENT)),";"!=this.token)break;this.next()}}return t}},{"../js/parser.js":170,"@construit/ast":137}],164:[function(t,e,s){arguments[4][66][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,dup:66}],165:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pIMPORT=function(){var t=new r.Import,e=this.pCODESELECTOR();return void 0===e||e.errors.length>0?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.IMPORTPATH)),t):(t.setPath(e),";"!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)),t):(this.next(),t))}},{"../js/parser.js":170,"@construit/ast":137}],166:[function(t,e,s){arguments[4][67][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,dup:67}],167:[function(t,e,s){arguments[4][68][0].apply(s,arguments)},{"../js/parser.js":170,dup:68}],168:[function(t,e,s){arguments[4][69][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,dup:69}],169:[function(t,e,s){const i=t("./parser.js"),r=t("@construit/ast");t("./declarations.js"),t("./do.js"),t("./expression.js"),t("./factor.js"),t("./for.js"),t("./function.js"),t("./if.js"),t("./import.js"),t("./indexed.js"),t("./delete.js"),t("./lists.js"),t("./lvalue.js"),t("./scope.js"),t("./primary.js"),t("./query.js"),t("./script.js"),t("./section.js"),t("./selector.js"),t("./structure.js"),t("./statement.js"),t("./switch.js"),t("./terms.js"),t("./wait.js"),t("./when.js"),t("./while.js"),t("./procedure.js"),s.SyntaxError=i.SyntaxError,s.SyntaxWarning=i.SyntaxWarning,s.parse=function(t,e){return new i(t,e||{}).script},s.Parser=i,s.parseStatement=function(t,e){var s=new i(t,e||{},{noparse:!0,noindex:!0});s.next();var r=s.pSTATEMENT();r.base=s,r.setSource(0,t.length,t),r.stamp=s.stamp;var n=t.match("\n");return r.numlines=null===n?0:n.length,r},s.parseScript=function(t,e){return new i(code,e||{}).script},s.parseExpression=function(t){var e=new i(t,{},{noparse:!0,noindex:!0});return e.next(),e.pEXPRESSION()},s.htmlify=r.htmlify},{"./declarations.js":157,"./delete.js":158,"./do.js":159,"./expression.js":160,"./factor.js":161,"./for.js":162,"./function.js":163,"./if.js":164,"./import.js":165,"./indexed.js":166,"./lists.js":167,"./lvalue.js":168,"./parser.js":170,"./primary.js":171,"./procedure.js":172,"./query.js":173,"./scope.js":174,"./script.js":175,"./section.js":176,"./selector.js":177,"./statement.js":178,"./structure.js":179,"./switch.js":180,"./terms.js":183,"./wait.js":184,"./when.js":185,"./while.js":186,"@construit/ast":137}],170:[function(t,e,s){function i(t,e,s){this.stream=void 0!==t?new r.Stream(t):void 0,this.data=new r.SyntaxData,this.token="INVALID",this.previous="INVALID",this.src="input",this.parent=void 0,this.scripts={},this.definitions={},this.origin=e,this.lastposition=0,this.lastline=0,this.errors=[],this.warnings=[],this.whens=[],this.options=s||{},this.lastresult=void 0,this.depth=0,this.allowBreak=!1,e||console.error("NO ORIGIN",t),this.lastDoxyComment=[],this.mainDoxyComment=void 0,this.parentDoxy=void 0,this.lastStatement=void 0,this.lastStatementEndline=-1,this.stream&&(this.stream.data=this.data),this.stamp=Date.now(),s&&s.noparse||(this.next(),this.script=this.pSCRIPT(),this.script.base=this,this.script.name=e.name,e.id&&(this.script.id=e.id),this.script.setSource(0,t.length,t),this.script.setDoxyComment(this.doxyFromOrigin()),this.options&&this.options.noindex?0==this.script.id&&this.script.buildID():this.script.addIndex(),0==this.errors.length?this.errors=this.script.errors:this.errors.push.apply(this.errors,this.script.errors))}const r=t("@construit/lexer"),n=t("@construit/ast");i.prototype.doxyFromOrigin=function(){var t=this.origin.name;if(this.origin.title&&(t+="\n * @title "+this.origin.title),this.origin.author&&(t+="\n * @author "+this.origin.author),this.origin.id&&(t+="\n * @id "+this.origin.id),this.origin.saveID&&(t+="\n * @version "+this.origin.vid),this.origin.tags&&this.origin.tags.length>0){t+="\n *";for(var e=0;e<this.origin.tags.length;e++)t+=" #"+this.origin.tags[e]}return new n.DoxyComment(t)},i.prototype.next=function(){this.previous=this.token,this.lastposition=this.stream.position,this.lastline=this.stream.line,this.token=this.stream.readToken();for(var t=this.stream.prevline;;)if("/*"==this.token){var e=1,s=!1,r=this.stream.position-2,o=this.stream.line;for(42==this.stream.peek()&&(s=!0);this.stream.valid()&&("*/"!=this.token||e>0);)this.token=this.stream.readToken(),"/*"==this.token?e++:"*/"==this.token&&e--;if("*/"!=this.token){var a=new i.SyntaxError(this,i.SyntaxError.BLOCKCOMMENT);a.line=o,this.errors.push(a)}if(s){var h=new n.DoxyComment(this.stream.code.substring(r+3,this.stream.position-2).trim(),o,this.stream.line);this.lastDoxyComment.push(h),h.parent=this.parentDoxy,h.content.endsWith("@{")?this.parentDoxy=h:h.content.startsWith("@}")&&this.parentDoxy&&(this.parentDoxy=this.parentDoxy.parent)}this.token=this.stream.readToken()}else{if("${{"!=this.token)break;var r=this.stream.position,o=this.stream.line;for(this.data.line=o;this.stream.valid()&&"}}$"!=this.token;)this.token=this.stream.readToken();this.data.value=this.stream.code.substring(r,this.stream.position-3),this.token="JAVASCRIPT",this.stream.prevposition=r-3}this.stream.prevline=t},i.prototype.peekNext=function(t){var e,s={value:""};for(this.stream.data=s,this.stream.pushPosition();t>0;)e=this.stream.readToken(),t--;return this.stream.popPosition(),this.stream.data=this.data,e},i.SyntaxError=t("./syntaxerrors.js"),i.SyntaxWarning=t("./syntaxwarnings.js"),e.exports=i},{"./syntaxerrors.js":181,"./syntaxwarnings.js":182,"@construit/ast":137,"@construit/lexer":156}],171:[function(t,e,s){const i=t("./parser.js"),r=t("@construit/ast");i.prototype.pPRIMARY=function(){if("`"==this.token)return this.next(),(n=this.pEXPRESSION()).errors.length>0?((t=new r.Primary).setBackticks(n),t):"`"!=this.token?((t=new r.Primary).error(new i.SyntaxError(this,i.SyntaxError.BACKTICK)),t):(this.next(),(t=new r.Primary).setBackticks(n),t.setObservable("__BACKTICKS__"),t);if("OBSERVABLE"==this.token){var t,e=this.data.value;if(this.next(),"{"==this.token){for(var s=new r.Literal("STRING",e);"{"==this.token;){this.next();var n=this.pEXPRESSION();if(n.errors.length>0)return(t=new r.Primary).setBackticks(n),t;if("}"!=this.token)return(t=new r.Primary).error(new i.SyntaxError(this,i.SyntaxError.BACKTICK)),t;this.next();var o=new r.BinaryOp("//");o.left(s),o.setRight(n),s=o,"OBSERVABLE"==this.token&&((o=new r.BinaryOp("//")).left(s),o.setRight(new r.Literal("STRING",this.data.value)),s=o,this.next())}(t=new r.Primary).setBackticks(s),t.setObservable("__BACKTICKS__")}else(t=new r.Primary).setObservable(e);return t}return(t=new r.Primary).error(new i.SyntaxError(this,i.SyntaxError.BADFACTOR)),t}},{"./parser.js":170,"@construit/ast":137}],172:[function(t,e,s){const i=t("./parser.js"),r=t("@construit/ast");i.prototype.pPROCEDURE=function(){var t,e=new r.Procedure;if("OBSERVABLE"!=this.token)return e.errors.push(new i.SyntaxError(this,i.SyntaxError.ACTIONNAME)),e;if(t=this.data.value,this.next(),"{"!=this.token)return e.errors.push(new i.SyntaxError(this,i.SyntaxError.ACTIONOPEN)),e;this.next();var s=this.pSCRIPT();return e.name=t,e.setBlock(s),e.errors.length>0?e:"}"!=this.token?(e.errors.push(new i.SyntaxError(this,i.SyntaxError.ACTIONCLOSE)),e):(this.next(),e)}},{"./parser.js":170,"@construit/ast":137}],173:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pQUERY=function(){var t=new r.Query,e=[];if("("!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.QUERYOPEN)),t;if(this.next(),t.setSelector(this.pCODESELECTOR()),")"!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.QUERYCLOSE)),t;if(this.next(),"["!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.QUERYSELECTOPEN)),t;for(this.next();this.stream.valid()&&"]"!=this.token&&(e.push(this.data.value),this.next(),"]"!=this.token);){if(","!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.QUERYSELECTCOMMA)),t;this.next()}if("]"!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.QUERYSELECTCLOSE)),t;if(this.next(),"="==this.token||"+="==this.token||"//="==this.token){var s=this.token;this.next();var n=this.pEXPRESSION();t.setModify(n,s)}return 0==e.length&&e.push("id"),t.setResultTypes(e),t}},{"../js/parser.js":170,"@construit/ast":137}],174:[function(t,e,s){arguments[4][74][0].apply(s,arguments)},{"./parser.js":170,"@construit/ast":137,dup:74}],175:[function(t,e,s){arguments[4][75][0].apply(s,arguments)},{"./parser.js":170,"@construit/ast":137,dup:75}],176:[function(t,e,s){arguments[4][76][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,dup:76}],177:[function(t,e,s){arguments[4][77][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,"@construit/language":155,dup:77}],178:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pSTATEMENT_PP=function(t){if("is"==this.token){this.next();var e=new r.Definition,s=this.parent;this.parent=e;var n=this.pEXPRESSION();return e.setExpression(n),this.parent=s,e}if("in"==this.token){if(this.next(),!t)return(o=new r.Range).error(new i.SyntaxError(this,i.SyntaxError.RANGEBANNED)),o;var o=new r.Range(this.pEXPRESSION());return".."==this.token&&(this.next(),o.setSecond(this.pEXPRESSION())),o}if("="==this.token){this.next();var a=new r.Assignment;return a.setExpression(this.pEXPRESSION()),a}if("+="==this.token)return this.next(),new r.Modify("+=",this.pEXPRESSION());if("-="==this.token)return this.next(),new r.Modify("-=",this.pEXPRESSION());if("/="==this.token)return this.next(),new r.Modify("/=",this.pEXPRESSION());if("*="==this.token)return this.next(),new r.Modify("*=",this.pEXPRESSION());if("++"==this.token)return this.next(),new r.Modify("++",void 0);if("--"==this.token)return this.next(),new r.Modify("--",void 0);if("with"==this.token)return this.next(),this.pPROCSCOPE();if("("==this.token){this.next();var h=this.pPROCSCOPE();return")"!=this.token?(h.error(new i.SyntaxError(this,i.SyntaxError.SCOPECLOSE)),h):(this.next(),h)}var p=[];p.push(new i.SyntaxError(this,i.SyntaxError.DEFINITION));var c=new r.Assignment(void 0);return c.error(p[0]),c},i.prototype.pSTATEMENT_P=function(t){var e=this.pLVALUE();if(e.errors.length>0)return e;var s=this.pSTATEMENT_PP(t);return s.left(e),s.errors.length,s},i.prototype.pSTATEMENT=function(t){var e=this.stream.prevposition,s=this.stream.line-1,n=-1,o=void 0,a=-1,h=this.lastDoxyComment.length>0?this.lastDoxyComment.pop():void 0;if(0==this.lastDoxyComment.length&&this.parentDoxy&&this.lastDoxyComment.push(this.parentDoxy),t)switch(this.token){case"procedure":case"function":case"when":case"wait":case"do":case"import":case"delete":case"action":return(o=new r.DummyStatement).error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),o}switch(this.token){case"action":case"procedure":this.next(),o=this.pPROCEDURE();break;case"function":this.next(),o=this.pNAMEDFUNCTION();break;case"when":this.next(),o=this.pWHEN();break;case"for":this.next(),o=this.pFOR();break;case"while":this.next(),o=this.pWHILE();break;case"do":this.next(),o=this.pDO();break;case"wait":this.next(),o=this.pWAIT();break;case"switch":this.next(),o=this.pSWITCH();break;case"case":this.next(),o=this.pCASE();break;case"delete":this.next(),o=this.pDELETE();break;case"import":this.next(),o=this.pIMPORT();break;case"para":case"oracle":o=this.pPARAMS();break;case"local":case"var":case"auto":o=this.pLOCALS();break;case"default":this.next();var p=new r.Default;":"!=this.token?p.error(new i.SyntaxError(this,i.SyntaxError.DEFAULTCOLON)):this.next(),o=p;break;case"if":this.next(),o=this.pIF();break;case"#":var c=this.stream.position+1,l=this.stream.line,u=33==this.stream.peek();do{if(this.stream.skipLine(),!this.stream.valid())return(o=new r.DummyStatement).error(new i.SyntaxError(this,i.SyntaxError.NEWLINE)),o;this.stream.skip(),this.stream.line++}while(35==this.stream.peek()&&35!=this.stream.peek2());if(u){var d=new r.DoxyComment(this.stream.code.substring(c,this.stream.position-1).trim(),l,this.stream.line);d.parent=this.parentDoxy,d.content.endsWith("@{")?this.parentDoxy=d:d.content.startsWith("@}")&&this.parentDoxy&&(this.parentDoxy=this.parentDoxy.parent),!this.lastStatement||void 0!==this.lastStatement.doxyComment||this.lastStatEndline!=l-1&&this.lastStatEndline!=l?this.lastDoxyComment.push(d):this.lastStatement.setDoxyComment(d)}this.next(),o=new r.DummyStatement;break;case"##":o=this.pSECTION(),this.lastDoxyComment.length>0&&this.lastline==this.lastDoxyComment[0].startline-1&&o.setDoxyComment(this.lastDoxyComment.shift());break;case"return":this.next();var m=new r.Return;if(";"==this.token){this.next(),o=m;break}if(m.setExpression(this.pEXPRESSION()),m.errors.length>0){o=m;break}";"!=this.token?m.errors.push(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)):this.next(),o=m;break;case"continue":this.next();var f=new r.Continue;if(this.allowBreak||f.error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),f.errors.length>0){o=f;break}";"!=this.token?f.error(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)):this.next(),o=f;break;case"break":this.next();var x=new r.Break;if(this.allowBreak||x.error(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),x.errors.length>0){o=x;break}";"!=this.token?x.error(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)):this.next(),o=x;break;case"{":this.next();var g=this.pSCRIPT();if("}"!=this.token){g.error(new i.SyntaxError(this,i.SyntaxError.ACTIONCLOSE)),o=g;break}this.next(),o=g;break;case"JAVASCRIPT":s=this.data.line-1;var y=this.data.value;this.next(),o=new r.Literal("JAVASCRIPT",y);break;case"?":this.next(),o=this.pQUERY(),";"!=this.token?o.error(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)):this.next();break;case"`":case"*":case"OBSERVABLE":var E=this.pLVALUE();if(E.errors.length>0){(o=new r.DummyStatement).lvalue=E,o.errors=E.errors;break}var v=this.pSTATEMENT_PP();if(v.left(E),v.errors.length>0){o=v;break}";"!=this.token?v.error(new i.SyntaxError(this,i.SyntaxError.SEMICOLON)):this.next(),void 0===this.definitions[E.name]&&(this.definitions[E.name]=[]),this.definitions[E.name].push(v),o=v;break;default:return}return a=this.lastposition,n=this.lastline,o.parent=this.parent,null===o.doxyComment&&o.setDoxyComment(h),o.stamp=this.stamp,o.numlines=n-s-1,o.setSource(e,a,this.stream.code.substring(e,a)),"dummy"!=o.type&&(this.lastStatement=o,this.lastStatEndline=n),o}},{"../js/parser.js":170,"@construit/ast":137}],179:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pSTRUCTURE=function(){var t=new r.Structure;if("*"==this.token)return this.next(),t;for(;"EOF"!=this.token;){if("OBSERVABLE"!=this.token&&"NUMBER"!=this.token&&"STRING"!=this.token)return t.errors.push(new i.SyntaxError(this,i.SyntaxError.UNKNOWN)),t;var e=this.data.value;if(this.next(),":"!=this.token){var s=new r.Primary;s.setObservable(e),t.addElement(e,s)}else{this.next();var n=this.pEXPRESSION();t.addElement(e,n)}if(","!=this.token)break;this.next()}return t}},{"../js/parser.js":170,"@construit/ast":137}],180:[function(t,e,s){arguments[4][80][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,dup:80}],181:[function(t,e,s){arguments[4][81][0].apply(s,arguments)},{"@construit/language":155,"@construit/lexer":156,dup:81}],182:[function(t,e,s){arguments[4][82][0].apply(s,arguments)},{dup:82}],183:[function(t,e,s){arguments[4][83][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,dup:83}],184:[function(t,e,s){arguments[4][85][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,dup:85}],185:[function(t,e,s){const i=t("../js/parser.js"),r=t("@construit/ast");i.prototype.pWHEN=function(){var t=new r.When,e=this.parent;return this.parent=t,"("!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHENOPEN)),this.parent=e,t):(this.next(),t.setExpression(this.pEXPRESSION()),t.errors.length>0?(this.parent=e,t):")"!=this.token?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHENCLOSE)),this.parent=e,t):(this.next(),t.setStatement(this.pSTATEMENT()),t.errors.length>0?(this.parent=e,t):void 0===t.statement?(t.errors.push(new i.SyntaxError(this,i.SyntaxError.WHENNOSTATEMENT)),t.active=!0,this.parent=e,t):(this.whens.push(t),this.parent=e,t)))}},{"../js/parser.js":170,"@construit/ast":137}],186:[function(t,e,s){arguments[4][87][0].apply(s,arguments)},{"../js/parser.js":170,"@construit/ast":137,dup:87}]},{},[1]);