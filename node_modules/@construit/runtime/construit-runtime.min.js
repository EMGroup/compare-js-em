!function t(e,n,i){function r(o,a){if(!n[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[o]={exports:{}};e[o][0].call(u.exports,function(t){var n=e[o][1][t];return r(n||t)},u,u.exports,t,e,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,n){"undefined"==typeof Construit&&(Construit={}),Construit.runtime=t("./")},{"./":3}],2:[function(t,e,n){function i(t,e,n,i){return void 0!==e.name&&(i?(i[t]||(i[t]={}),i[t][e.name]={target:e,handler:n}):(this.hasOwnProperty("__listeners__")||(this.__listeners__={}),this.__listeners__[t]||(this.__listeners__[t]={}),this.__listeners__[t][e.name]={target:e,handler:n}),this)}function r(t,e,n){try{return e.apply(t,n)}catch(e){var i=new RuntimeError(void 0,RuntimeError.JSOBSERVER,void 0,"JavaScript observer '"+jsObserverName+"' failed: "+e);return t.emit("error",[t,i]),!1}}function s(t,e,n){n||this.hasOwnProperty("__listeners__")||(this.__listeners__={});var i=n?n[t]:this.__listeners__[t];if(i){for(var s in i)if(r(i[s].target,i[s].handler,e))return!0;return!1}}function o(t){if(t)return this.__listeners__[e]&&this.__listeners__[e].length>0;for(var e in this.__listeners__)if(this.__listeners__[e]&&this.__listeners__[e].length>0)return!0;return!1}function a(t){t.prototype.emit=s,t.prototype.on=i,t.prototype.hasListeners=o}a.on=i,a.emit=s,e.exports=a},{}],3:[function(t,e,n){function r(t){var e=0;if(0==t.length)return e;for(i=0;i<t.length;i++)char=t.charCodeAt(i),e=(e<<5)-e+char,e&=e;return e}function s(t){var e=t.sort();return Math.abs(r(e.join("$")))}function o(t,e,n){this.type=t,this.name=e,this.outputs={},this.inputs=n,this.invalid=!0}function a(){this.l=t("./rtlib.js"),this.state={},this.funcs={},this.scopes={},this.needsFlush=!1,this.needsRebuild=!1,this.changed={},this.maintainer_cache={},this.i_cache={},this.dep_cache={},this.def_cache={},this.ast_cache={},this.to_force={},this.obs_listeners={},this.__listeners__={}}function h(t,e){try{e.call(t)}catch(e){console.error(e),t.emit("error",[new c(t,c.UNKNOWN,void 0,e)])}}const c=t("./runtimeerrors.js"),u=t("./events.js");u(a),a.prototype.makeMaintainerList=function(t){function e(t){for(var e={},i=0;i<t.length;i++)if(h=n.i_cache[t[i]])for(var r=0;r<h.length;r++)e[h[r]]=!0;for(var s in e){var o=n.maintainer_cache[s];for(var a in o.outputs){var h=n.i_cache[a];h&&delete e[h]}}return Object.keys(e)}for(var n=this,i=[],r=e(t);r.length>0;){i.push.apply(i,r);for(var s={},o=0;o<r.length;o++){var a=n.maintainer_cache[r[o]];Object.assign(s,a.outputs)}var h=Object.keys(s);h&&h.length>0&&(r=e(h))}return i},a.prototype.buildSetter=function(t){for(var e="",n=0;n<t.length;n++){var i=t[n],r=this.maintainer_cache[i];if(r.mono){e+="this.state."+Object.keys(r.outputs)[0]+" = this.funcs.f"+i+"(";for(s=0;s<r.inputs.length;s++)e+="this.state."+r.inputs[s],s<r.inputs.length-1&&(e+=",");e+=");\n"}else{e+="[this.state."+Object.keys(r.outputs).join(",this.state.")+"] = this.funcs.f"+i+"(";for(var s=0;s<r.inputs.length;s++)e+="this.state."+r.inputs[s],s<r.inputs.length-1&&(e+=",");e+=");\n"}}return console.log("Building setter:",e),Function(e)},a.prototype.generateDependencies=function(t,e){function n(t){for(var a=0;a<t.length;a++)if(!r[t[a]]){o++,r[t[a]]=!0;var h=s.dep_cache[t[a]];h&&h.length>0&&n(h),s.def_cache[t[a]]?i+="const "+t[a]+" = "+s.def_cache[t[a]]+";\n":-1==e.indexOf(t[a])&&(i+="const "+t[a]+" = state."+t[a]+";\n")}}var i="",r={},s=this,o=0;return console.log("Generate Dependencies"),n(t),i},a.prototype.buildScope=function(t,e,n){var i="const state = this.state;\nconst funcs = this.funcs;\n";return i+=this.generateDependencies(n,e),i+="return "+t+";",console.log("Deps:",i),Function(e,i).bind(this)},a.prototype.get=function(t){return this.needsFlush&&this.flush(),this.state[t]},a.prototype.set=function(t,e,n){this.state[t]=e,this.changed[t]=!0,this.needsFlush=!0},a.prototype.define=function(t,e,n,i){var r=s(n);this.maintainer_cache.hasOwnProperty(r)||(this.maintainer_cache[r]=new o("definition",r,n));var a=this.maintainer_cache[r];a.outputs[t]=!0,a.invalid=!0,this.to_force[r]=!0,this.def_cache[t]=e,this.dep_cache[t]=n,this.ast_cache[t]=i,this.needsFlush=!0,this.needsRebuild=!0},a.prototype.scope=function(t,e,n,i){if(!this.maintainer_cache.hasOwnProperty(t)){this.maintainer_cache[t]=new o("scope",t,n);var r=this.maintainer_cache[t];this.dep_cache[t]=i,this.def_cache[t]=e,r.invalid=!0,this.needsFlush=!0,this.needsRebuild=!0}},a.prototype.hasScope=function(t){return this.maintainer_cache.hasOwnProperty(t)},a.prototype.rebuild=function(){this.needsRebuild=!1,this.i_cache={};for(var t in this.maintainer_cache)if(this.maintainer_cache[t].invalid)if("definition"==this.maintainer_cache[t].type){for(var e=Object.keys(this.maintainer_cache[t].outputs),n=this.maintainer_cache[t].inputs,i=0;i<n.length;i++)void 0===this.i_cache[n[i]]&&(this.i_cache[n[i]]=[]),this.i_cache[n[i]].push(t);var r=1==e.length;this.maintainer_cache[t].mono=r;for(var s=r?"return ":"return [",i=0;i<e.length;i++)s+=this.def_cache[e[i]],!r&&i<e.length-1&&(s+=",");s="const funcs = this.funcs;\n"+(s+=r?";":"];"),this.maintainer_cache[t].f=Function(n,s).bind(this),this.funcs["f"+t]=this.maintainer_cache[t].f}else{var n=this.maintainer_cache[t].inputs,o=this.maintainer_cache[t];o.invalid=!1,o.f=this.buildScope(this.def_cache[t],o.inputs,this.dep_cache[t]),this.funcs["s"+t]=o.f}},a.prototype.flush=function(){this.needsRebuild&&this.rebuild();var t=Object.keys(this.changed),e=Object.keys(this.to_force).concat(this.makeMaintainerList(t));this.changed={},this.to_force={},this.needsFlush=!1,h(this,this.buildSetter(e));for(var n=[].concat(t),i=0;i<e.length;i++)n.push.apply(n,Object.keys(this.maintainer_cache[e[i]].outputs));var r=this;this.emit("change",[n]),n.forEach(function(t){var e=r.obs_listeners[t];e&&r.emit("change",[t],e)})},a.prototype.getObservables=function(){return Object.keys(this.state)},a.prototype.getSource=function(t){return this.ast_cache[t]?this.ast_cache[t].getSource():null},a.prototype.reset=function(){var t=Object.keys(this.state);this.state={},this.funcs={},this.dep_cache={},this.def_cache={},this.ast_cache={},this.maintainer_cache={},this.needsRebuild=!1,this.needsFlush=!1;var e=this;this.emit("change",[t]),this.emit("delete",[t]),t.forEach(function(t){var n=e.obs_listeners[t];n&&(e.emit("change",[t],n),e.emit("delete",[t],n))}),this.emit("reset",[this])},a.prototype.error=function(t,e){this.emit("error",[Symbol.jsAgent,new c(void 0,0,void 0,t)])},a.prototype.on=function(t){3==arguments.length?u.on.call(this,t,arguments[1],arguments[2]):4==arguments.length&&(this.obs_listeners.hasOwnProperty(arguments[1])||(this.obs_listeners[arguments[1]]={}),u.on.call(this,t,arguments[2],arguments[3],this.obs_listeners[arguments[1]]))},n.RunTime=a},{"./events.js":2,"./rtlib.js":4,"./runtimeerrors.js":5}],4:[function(t,e,n){Point=function(t,e){this.x=t,this.y=e},Point.prototype.toString=function(t){return"Point("+Eden.edenCodeForValue(this.x,void 0,t)+", "+Eden.edenCodeForValue(this.y,void 0,t)+")"},Point.prototype.getEdenCode=Point.prototype.toString;var i={copy:function(t){var e,n;if(t instanceof Array){for(n=t.slice(),e=0;e<t.length;++e)n[e]=copy(n[e]);return n}return t},index:function(t){return"number"==typeof t?t-1:t},length:function(t){if(null!==t&&void 0!==t)return t instanceof BoundValue?t.value.length:t.length},equal:function(t,e){var n;if(t===e)return!0;if(t instanceof Array&&e instanceof Array){if(t.length!==e.length)return!1;for(n=0;n<t.length;++n)if(!i.equal(t[n],e[n]))return!1;return!0}return!1},add:function(t,e){return void 0===t||void 0===e?void 0:t instanceof Point?new Point(t.x+e.x,t.y+e.y):t+e},subtract:function(t,e){return void 0===t||void 0===e?void 0:t instanceof Point?new Point(t.x-e.x,t.y-e.y):t-e},multiply:function(t,e){if(void 0!==t&&void 0!==e)return t*e},divide:function(t,e){if(void 0!==t&&void 0!==e)return t/e},mod:function(t,e){if(void 0!==t&&void 0!==e)return t%e},pow:function(t,e){if(void 0!==t&&void 0!==e)return Math.pow(t,e)},concat:function(t,e){if(void 0!==t&&void 0!==e){if(Array.isArray(t)){if(Array.isArray(e))return t.concat(e);throw new Error(Eden.RuntimeError.LEFTCONCAT)}if(Array.isArray(e))throw new Error(Eden.RuntimeError.RIGHTCONCAT);return String(t)+e}},regExpMatch:function(t,e){return void 0===t||void 0===e?void 0:e instanceof RegExp?e.test(t):new RegExp(e).test(t)},regExpNotMatch:function(t,e){return void 0===t||void 0===e?void 0:e instanceof RegExp?!e.test(t):!new RegExp(e).test(t)}};e.exports=i},{}],5:[function(t,e,n){RuntimeError=function(t,e,n,i){this.type="runtime",this.line=-1,this.statement=n,this.extra=i,this.errno=e,this.context=t},RuntimeError.UNKNOWN=0,RuntimeError.ASSIGNEXEC=1,RuntimeError.FUNCCALL=2,RuntimeError.ACTIONNAME=3,RuntimeError.NOAGENT=4,RuntimeError.NOTSUPPORTED=5,RuntimeError.ASSIGNTODEFINED=6,RuntimeError.ASSIGNDIMENSION=7,RuntimeError.EXTENDSTATIC=8,RuntimeError.INFINITERANGE=9,RuntimeError.NOLISTRANGE=10,RuntimeError.LEFTCONCAT=11,RuntimeError.RIGHTCONCAT=12,RuntimeError.AGENTSOURCE=13,RuntimeError.JSOBSERVER=14,RuntimeError.PROCAGENT=15,RuntimeError.ARGUMENTS=16,RuntimeError.NOTCHILD=17,RuntimeError.prototype.messageText=function(){var t=!this.statement||"functioncall"!=this.statement.type&&"definition"!=this.statement.type&&"assignment"!=this.statement.type?"":"'"+this.statement.lvalue.name+"': ";switch(this.errno){case RuntimeError.ACTIONNAME:case RuntimeError.NOAGENT:case RuntimeError.NOTSUPPORTED:case RuntimeError.AGENTSOURCE:case RuntimeError.JSOBSERVER:case RuntimeError.PROCAGENT:case RuntimeError.ARGUMENTS:case RuntimeError.EXTENDSTATIC:return t+this.extra;case RuntimeError.ASSIGNTODEFINED:return t+"cannot assign to a defined list, use 'is'";case RuntimeError.ASSIGNDIMENSION:return t+"list does not have this many dimensions";case RuntimeError.RIGHTCONCAT:return t+"Concatenation: When the right hand side is a list then the left hand side must also be a list";case RuntimeError.LEFTCONCAT:return t+"Concatenation: When the left hand side is a list then the right hand side must also be a list";case RuntimeError.INFINITERANGE:return t+"range scope is infinite";case RuntimeError.NOLISTRANGE:return t+"range 'in' is not a list"}return String(this.extra).search("is not a function")>=0?t+"function used does not exist":this.errno==RuntimeError.FUNCCALL&&String(this.extra).search("Cannot read property 'call'")>=0?t+"procedure does not exist":String(this.extra).match(/Cannot read property .* of undefined/)?t+"uses an undefined list":this.extra},RuntimeError.prototype.edenSource=function(){if(this.statement)if("definition"==this.statement.type){var t=eden.root.symbols[this.statement.lvalue.name];if(t&&t.definition)return t.getSource()}else if(this.context)return this.context.getSource(this.statement)},RuntimeError.prototype.javascriptSource=function(){return this.statement.generate({scopes:[],dependencies:{}},"scope")},RuntimeError.prototype.details=function(){var t="";return"definition"!=this.statement.type&&"assignment"!=this.statement.type||(t+="Symbol: "+this.statement.lvalue.name+"\n"),String(this.extra).search("SyntaxError")>=0?t+="JavaScript: "+this.javascriptSource()+"\n":t+="Source: "+this.edenSource()+"\n",this.extra.message&&(t+="Original: "+this.extra.message+"\n"),t},RuntimeError.prototype.prettyPrint=function(){return this.extra&&this.extra.stack?"Run-time Error:\n"+this.extra.stack:"Run-time Error:\n"},e.exports=RuntimeError},{}]},{},[1]);